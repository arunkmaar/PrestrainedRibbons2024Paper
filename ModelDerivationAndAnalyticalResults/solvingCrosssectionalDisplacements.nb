(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    275385,       6988]
NotebookOptionsPosition[    264128,       6828]
NotebookOutlinePosition[    264523,       6844]
CellTagsIndexPosition[    264480,       6841]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["(* JB *)", "Text"]], "Title",
 CellChangeTimes->{
  3.924942148988083*^9, {3.924942809434278*^9, 
   3.924942817527041*^9}},ExpressionUUID->"d4973709-2b46-4085-a0fb-\
67d4520ec0a7"],

Cell["Solving cross-sectional displacements", "Title",
 CellChangeTimes->{
  3.924942148988083*^9},ExpressionUUID->"582dd357-c636-4605-a0ae-\
d464e7383ffd"],

Cell[TextData[StyleBox["Supplementary material for \
\[OpenCurlyDoubleQuote]Wavelength selection in the twist buckling of \
pre-strained elastic ribbons;  Arun Kumar and  Basile  Audoly\
\[CloseCurlyDoubleQuote]", "Subtitle"]], "Author",
 CellChangeTimes->{{3.9249271360619383`*^9, 3.924927144589328*^9}, {
   3.9249272160409327`*^9, 3.924927231183419*^9}, 3.924941923831993*^9, {
   3.9249420166773033`*^9, 3.924942016680706*^9}, 3.9249420899894447`*^9, {
   3.92494213429069*^9, 3.924942169028623*^9}, {3.9249423771709547`*^9, 
   3.9249424529054937`*^9}, {3.92494258827634*^9, 3.9249426157078648`*^9}, {
   3.924942698393243*^9, 3.924942722729045*^9}, {3.926992478771639*^9, 
   3.926992479600868*^9}, {3.9441355618537893`*^9, 
   3.944135582047543*^9}},ExpressionUUID->"aaace130-c4b3-4301-8bd2-\
c70bddfcfca9"],

Cell[TextData[{
 "This file presents the calculation of cross-sectional displacements in \
terms of twist and twist gradients. We assume a slow variation of \
cross-sectional displacements and twist, and solve for the cross-sectional \
displacements asymptotically by minimizing the strain energy. Specifically, \
we assume that the cross-sectional displacements are of the form:\nu= \
uLeadOrd + ",
 Cell[BoxData[
 "\[Gamma]"], "Input",ExpressionUUID->
  "c4c31b8f-25e6-4962-932e-a2b21cac7b9e"],
 " uFirstOrd + ",
 Cell[BoxData[
  SuperscriptBox["\[Gamma]", "2"]], "Input",ExpressionUUID->
  "0babedd4-320a-4d70-b380-5a148eae945d"],
 " ..\nv= vLeadOrd + ",
 Cell[BoxData[
 "\[Gamma]"], "Input",ExpressionUUID->
  "4c0b2fa9-e16b-485a-9fc5-6adf445d5492"],
 " vFirstOrd + ",
 Cell[BoxData[
  SuperscriptBox["\[Gamma]", "2"]], "Input",ExpressionUUID->
  "fd3449b7-a690-4853-b4ff-6b17e8805682"],
 " ..\nw= wLeadOrd + ",
 Cell[BoxData[
 "\[Gamma]"], "Input",ExpressionUUID->
  "b6bc31ef-6418-49a7-b7d2-9a88930e13dc"],
 " wFirstOrd + ",
 Cell[BoxData[
  SuperscriptBox["\[Gamma]", "2"]], "Input",ExpressionUUID->
  "eb1104b5-95c8-4797-8bb0-f33b8a485d37"],
 " ..\n where \[Gamma] is a small parameter and solve for the leading order \
displacements (uLeadOrd, vLeadOrd, wLeadOrd) by minimizing the strain energy \
at order ",
 Cell[BoxData[
  SuperscriptBox["\[Gamma]", "0"]], "Input",ExpressionUUID->
  "84c6f953-c2ec-4319-a656-a34c9fa6c013"],
 " and the first order displacements (uFirstOrd, vFirstOrd, wFirstOrd) by \
minimizing the energy at second order ",
 Cell[BoxData[
  SuperscriptBox["\[Gamma]", "2"]], "Input",ExpressionUUID->
  "35c287ca-f9c7-4278-90b6-568eb9c6938d"],
 "."
}], "Abstract",
 CellChangeTimes->{{3.9249271360619383`*^9, 3.924927144589328*^9}, {
   3.9249272160409327`*^9, 3.924927231183419*^9}, {3.92494192706851*^9, 
   3.92494194102006*^9}, {3.924942464944512*^9, 3.924942480928936*^9}, {
   3.924942553362365*^9, 3.92494258393358*^9}, 3.9249888442162027`*^9, {
   3.9250224452727623`*^9, 3.9250224859661016`*^9}, 3.925022686630951*^9, 
   3.925022740302286*^9, {3.9250227717268343`*^9, 3.925022925336136*^9}, {
   3.925029857550248*^9, 3.925029870581917*^9}, 3.925031964429715*^9, {
   3.9254377677797823`*^9, 3.9254377778056793`*^9}, {3.9269932686401978`*^9, 
   3.926993269696814*^9}},ExpressionUUID->"8b8fbf1b-1de5-4340-b49d-\
ac71a170fe5c"],

Cell[CellGroupData[{

Cell["Preliminaries", "Section",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, 
   3.925020128324216*^9, {3.9250201658824263`*^9, 
   3.9250202052276697`*^9}},ExpressionUUID->"369e299b-bd1a-4a01-b367-\
41bfe42a7e9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Clean", " ", "old", " ", "variables", " ", "and", " ", "outputs"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", "ClearAll",
    "\n", 
   RowBox[{"FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}],
    "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Delete", " ", "empty", " ", "cells"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookDelete", "/@", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Cells", "[", 
        RowBox[{"GeneratedCell", "->", "False"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"StringMatchQ", "[", 
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"FrontEndExecute", "[", 
            RowBox[{"FrontEnd`ExportPacket", "[", 
             RowBox[{
              RowBox[{"NotebookRead", "@", "#"}], ",", "\"\<InputText\>\""}], 
             "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "\"\< \>\"", "|", "\"\<\\t\>\"", "|", "\"\<\\r\>\"", "|", 
             "\"\<\\n\>\"", "|", "\"\<\[IndentingNewLine]\>\""}], ")"}], 
           "..."}]}], "]"}], "&"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Want", " ", "to", " ", "do", " ", 
     RowBox[{"sanity", "/", "consistency"}], " ", 
     RowBox[{"checks", "?"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"doSanityCheck", " ", "=", " ", "True"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Set", " ", "doSanityCheck", " ", "to", " ", 
     RowBox[{"True", "/", "False"}], " ", "if", " ", "you", " ", 
     RowBox[{"want", "/", "do"}], " ", "not", " ", "want", " ", "to", " ", 
     "perform", " ", "the", " ", "consistency", " ", "checks"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"On", "[", "Assert", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "A", " ", "function", " ", "to", " ", "do", " ", "consistency", " ", 
     "checks"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CheckSanity", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Check", "[", 
        RowBox[{
         RowBox[{"Assert", "[", "#", "]"}], ",", " ", 
         RowBox[{"Abort", "[", "]"}]}], "]"}], "&"}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"variables", " ", "in", " ", "the", " ", "expression"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"varInExpression", "[", "x_", "]"}], ":=", 
     RowBox[{"Integrate`getAllVariables", "[", 
      RowBox[{"x", ",", 
       RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"check", " ", "assumptions"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CurlyEpsilon]", ",", 
         RowBox[{"\[Tau]", "[", "S", "]"}], ",", 
         RowBox[{
          RowBox[{"\[Tau]", "'"}], "[", "S", "]"}], ",", 
         RowBox[{
          RowBox[{"\[Tau]", "''"}], "[", "S", "]"}], ",", "a", " ", ",", 
         "T"}], "}"}], "\[Element]", "Reals"}], " ", "&&", " ", 
      RowBox[{"a", ">", "0"}], "&&", " ", 
      RowBox[{"k", ">", "0"}], " ", "&&", " ", 
      RowBox[{"t", ">", "0"}], "&&", " ", 
      RowBox[{"0", "<", "\[Nu]", "<", 
       FractionBox["1", "2"]}], " ", "&&", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Nu]", "2"]}], "<", "0"}], " ", "&&", " ", 
      RowBox[{"0", "<", "r", "<", "1"}], " ", "&&", " ", 
      RowBox[{"p", ">", "0"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, 
   3.925020128324216*^9, {3.9250201658824263`*^9, 3.925020363512302*^9}, {
   3.925162395332439*^9, 3.925162432470111*^9}, {3.926993270891021*^9, 
   3.9269932718857183`*^9}},ExpressionUUID->"942f32d7-1abf-489c-bb6e-\
54d9d4a48f29"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Shell strains and energy", "Section",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942510532983*^9, 3.9249425192159643`*^9}, 3.925020273883028*^9, {
   3.925029896851782*^9, 
   3.92502990204088*^9}},ExpressionUUID->"d25e40ce-ace5-4156-a106-\
7401037ed908"],

Cell[CellGroupData[{

Cell["Dimensional strains and energy", "Subsection",
 CellChangeTimes->{{3.9250306124491*^9, 3.9250306171255617`*^9}, {
  3.9250306836718597`*^9, 
  3.925030686065999*^9}},ExpressionUUID->"8824d6ec-741f-47ac-9f17-\
6edf6a59a03c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Membrane", " ", "strains"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ESSb", "[", 
      RowBox[{"Sb_", ",", "Tb_"}], "]"}], "=", 
     RowBox[{"\[CurlyEpsilon]b", "+", 
      RowBox[{"\[CurlyEpsilon]pb", "[", "Tb", "]"}], "+", 
      RowBox[{
       SuperscriptBox["vb", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"Sb", ",", "Tb"}], "]"}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Tb"}], " ", 
           RowBox[{"\[Tau]b", "[", "Sb", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["wb", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"Sb", ",", "Tb"}], "]"}]}], ")"}], "2"]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ETTb", "[", 
      RowBox[{"Sb_", ",", "Tb_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Nu]"}], 
       RowBox[{"(", 
        RowBox[{"\[CurlyEpsilon]b", "+", 
         RowBox[{"\[CurlyEpsilon]pb", "[", "Tb", "]"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["ub", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"Sb", ",", "Tb"}], "]"}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["wb", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"Sb", ",", "Tb"}], "]"}], "2"]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ESTb", "[", 
      RowBox[{"Sb_", ",", "Tb_"}], "]"}], "=", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["vb", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"Sb", ",", "Tb"}], "]"}], "+", 
        RowBox[{
         RowBox[{"\[Tau]b", "[", "Sb", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"wb", "[", 
            RowBox[{"Sb", ",", "Tb"}], "]"}], "-", 
           RowBox[{"Tb", " ", 
            RowBox[{
             SuperscriptBox["wb", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"Sb", ",", "Tb"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["ub", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"Sb", ",", "Tb"}], "]"}], "+", 
        RowBox[{
         RowBox[{
          SuperscriptBox["wb", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"Sb", ",", "Tb"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["wb", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"Sb", ",", "Tb"}], "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Bending", " ", "strains"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSSb", "[", 
      RowBox[{"Sb_", ",", "Tb_"}], "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Tb"}], " ", 
        RowBox[{
         SuperscriptBox["\[Tau]b", "\[Prime]",
          MultilineFunction->None], "[", "Sb", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["wb", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"Sb", ",", "Tb"}], "]"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BTTb", "[", 
      RowBox[{"Sb_", ",", "Tb_"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox["wb", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"Sb", ",", "Tb"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSTb", "[", 
      RowBox[{"Sb_", ",", "Tb_"}], "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Tau]b", "[", "Sb", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["wb", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"Sb", ",", "Tb"}], "]"}]}], ")"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942510532983*^9, 3.9249425192159643`*^9}, 3.925020273883028*^9, {
   3.925029896851782*^9, 3.925029991788578*^9}, {3.925030596976324*^9, 
   3.925030604670677*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"16c1906a-9ae7-4c14-b604-7222a7e1ed13"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Stiffnesses", "'"}], " ", "expressions"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"KmExp", " ", "=", 
     FractionBox[
      RowBox[{"Y", " ", "t"}], 
      RowBox[{"1", "-", 
       SuperscriptBox["\[Nu]", "2"]}]]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DbExp", " ", "=", 
     FractionBox[
      RowBox[{"Y", " ", 
       SuperscriptBox["t", "3"]}], 
      RowBox[{"12", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[Nu]", "2"]}], ")"}]}]]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Strain", " ", "tensor", " ", "components", " ", "in", " ", "cartesian", 
     " ", "basis", " ", 
     SubscriptBox["E", "3"], " ", "and", " ", 
     SubscriptBox["E", "2"]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942510532983*^9, 3.9249425192159643`*^9}, 3.925020273883028*^9, {
   3.925029896851782*^9, 3.925030012227747*^9}, {3.925030492936366*^9, 
   3.925030518705508*^9}, {3.925030565410849*^9, 3.925030571537146*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"eccdd160-59e7-4b85-b2f1-0e1ed716586d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Eb", "[", 
    RowBox[{"Sb_", ",", "Tb_"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ESSb", "[", 
        RowBox[{"Sb", ",", "Tb"}], "]"}], ",", 
       RowBox[{"ESTb", "[", 
        RowBox[{"Sb", ",", "Tb"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ESTb", "[", 
        RowBox[{"Sb", ",", "Tb"}], "]"}], ",", 
       RowBox[{"ETTb", "[", 
        RowBox[{"Sb", ",", "Tb"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Bb", "[", 
     RowBox[{"Sb_", ",", "Tb_"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"BSSb", "[", 
         RowBox[{"Sb", ",", "Tb"}], "]"}], ",", 
        RowBox[{"BSTb", "[", 
         RowBox[{"Sb", ",", "Tb"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"BSTb", "[", 
         RowBox[{"Sb", ",", "Tb"}], "]"}], ",", 
        RowBox[{"BTTb", "[", 
         RowBox[{"Sb", ",", "Tb"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Strain", " ", "energy", " ", "density"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strDenb", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"KmExp", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Nu]", " ", 
          SuperscriptBox[
           RowBox[{"Tr", "[", 
            RowBox[{"Eb", "[", 
             RowBox[{"Sb", ",", "Tb"}], "]"}], "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Nu]"}], ")"}], 
          RowBox[{"TensorContract", "[", 
           RowBox[{
            RowBox[{"TensorProduct", "[", 
             RowBox[{
              RowBox[{"Eb", "[", 
               RowBox[{"Sb", ",", "Tb"}], "]"}], ",", 
              RowBox[{"Eb", "[", 
               RowBox[{"Sb", ",", "Tb"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]}]}], ")"}]}], 
      "+", "\[IndentingNewLine]", " ", 
      RowBox[{"DbExp", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Nu]", " ", 
          SuperscriptBox[
           RowBox[{"Tr", "[", 
            RowBox[{"Bb", "[", 
             RowBox[{"Sb", ",", "Tb"}], "]"}], "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Nu]"}], ")"}], 
          RowBox[{"TensorContract", "[", 
           RowBox[{
            RowBox[{"TensorProduct", "[", 
             RowBox[{
              RowBox[{"Bb", "[", 
               RowBox[{"Sb", ",", "Tb"}], "]"}], ",", 
              RowBox[{"Bb", "[", 
               RowBox[{"Sb", ",", "Tb"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]}]}], 
        ")"}]}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942510532983*^9, 3.9249425192159643`*^9}, 3.925020273883028*^9, {
   3.925029896851782*^9, 3.925030012227747*^9}, 3.925030626874758*^9, {
   3.9250306950745277`*^9, 3.925030714988037*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"2fdd5fa9-7810-46cf-9af7-908b087f5426"]
}, Closed]],

Cell[CellGroupData[{

Cell["Nondimensionalization", "Subsection",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942510532983*^9, 3.9249425192159643`*^9}, 3.925020273883028*^9, {
   3.925029896851782*^9, 3.925030012227747*^9}, {3.925030626874758*^9, 
   3.925030670738564*^9}},ExpressionUUID->"b5cbf3e5-be06-44e1-8133-\
6217bc086cc3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NondimensionalizationReplacementRules", " ", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"u", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"a", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"a", " ", "k"}], ")"}], "2"]}]], 
         RowBox[{"ub", "[", 
          RowBox[{
           RowBox[{"#1", " ", "a"}], ",", 
           RowBox[{"#2", " ", "a"}]}], "]"}]}], "&"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"v", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"a", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"a", " ", "k"}], ")"}], "2"]}]], 
         RowBox[{"vb", "[", 
          RowBox[{
           RowBox[{"#1", " ", "a"}], ",", 
           RowBox[{"#2", " ", "a"}]}], "]"}]}], "&"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"w", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", "k"}]], 
         RowBox[{"wb", "[", 
          RowBox[{
           RowBox[{"#1", " ", "a"}], ",", 
           RowBox[{"#2", " ", "a"}]}], "]"}]}], "&"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Tau]", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "k"], 
         RowBox[{"\[Tau]b", "[", 
          RowBox[{"#", " ", "a"}], "]"}]}], "&"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CurlyEpsilon]", "->", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", " ", "k"}], ")"}], "2"]], "\[CurlyEpsilon]b"}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[CurlyEpsilon]p", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"a", " ", "k"}], ")"}], "2"]], 
         RowBox[{"\[CurlyEpsilon]pb", "[", 
          RowBox[{"#", " ", "a"}], "]"}]}], "&"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"S", "->", " ", 
      FractionBox["Sb", "a"]}], ",", 
     RowBox[{"T", "->", " ", 
      FractionBox["Tb", "a"]}], ",", 
     RowBox[{"k", "->", " ", 
      FractionBox["t", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"12", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Nu]", "2"]}], ")"}]}], ")"}], 
         FractionBox["1", "2"]]}]]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.924503832085597*^9, 3.924503861350699*^9}, {
   3.9245038922258673`*^9, 3.924503966268798*^9}, {3.924505298880806*^9, 
   3.9245053195467052`*^9}, {3.9245735763237543`*^9, 3.924573596433878*^9}, {
   3.9245742663659678`*^9, 3.924574343952016*^9}, {3.924574464227201*^9, 
   3.924574535947803*^9}, {3.924574616472932*^9, 3.9245747860526342`*^9}, {
   3.924575124672926*^9, 3.924575155907566*^9}, 3.924575259926543*^9, 
   3.924575772339096*^9, {3.924575818777917*^9, 3.924575849578094*^9}, {
   3.924728843948003*^9, 3.924728878575583*^9}, {3.9247293307406282`*^9, 
   3.924729427019897*^9}, {3.924742403343163*^9, 3.924742404515491*^9}, {
   3.924753808897791*^9, 3.9247538279732733`*^9}, {3.9247538626663*^9, 
   3.924753935447805*^9}, {3.9247564574299107`*^9, 3.924756464113422*^9}, 
   3.924767062293285*^9, {3.9250307838498783`*^9, 3.925030812386155*^9}, 
   3.925030842991642*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"7cbf8b3d-c300-4707-b707-e21a1aafa017"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Prestrain", " ", "function"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"unitShiftFn", "[", 
      RowBox[{"T_", ",", "r_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"UnitStep", "[", 
       RowBox[{"T", "+", " ", 
        RowBox[{"r", "/", "2"}]}], "]"}], " ", "-", " ", 
      RowBox[{"UnitStep", "[", 
       RowBox[{"T", "-", " ", 
        RowBox[{"r", " ", "/", "2"}]}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CurlyEpsilon]pfnExp", "[", "T_", "]"}], "=", 
     RowBox[{"p", " ", 
      RowBox[{"unitShiftFn", "[", 
       RowBox[{"T", ",", "r"}], "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.924503832085597*^9, 3.924503861350699*^9}, {
   3.9245038922258673`*^9, 3.924503966268798*^9}, {3.924505298880806*^9, 
   3.9245053195467052`*^9}, {3.9245735763237543`*^9, 3.924573596433878*^9}, {
   3.9245742663659678`*^9, 3.924574343952016*^9}, {3.924574464227201*^9, 
   3.924574535947803*^9}, {3.924574616472932*^9, 3.9245747860526342`*^9}, {
   3.924575124672926*^9, 3.924575155907566*^9}, 3.924575259926543*^9, 
   3.924575772339096*^9, {3.924575818777917*^9, 3.924575849578094*^9}, {
   3.924728843948003*^9, 3.924728878575583*^9}, {3.9247293307406282`*^9, 
   3.924729427019897*^9}, {3.924742403343163*^9, 3.924742404515491*^9}, {
   3.924753808897791*^9, 3.9247538279732733`*^9}, {3.9247538626663*^9, 
   3.924753935447805*^9}, {3.9247564574299107`*^9, 3.924756464113422*^9}, 
   3.924767062293285*^9, {3.9250307838498783`*^9, 3.925030812386155*^9}, {
   3.925030842991642*^9, 3.925030877611484*^9}, {3.925032114407552*^9, 
   3.9250321317550583`*^9}, 
   3.926993273288075*^9},ExpressionUUID->"a82dc203-2b0c-4e4a-9209-\
e8ba58463c49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Nondimensional", " ", "strains"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ESS", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", 
     RowBox[{"\[CurlyEpsilon]", "+", 
      RowBox[{"\[CurlyEpsilon]p", "[", "T", "]"}], "+", 
      RowBox[{
       SuperscriptBox["v", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"S", ",", "T"}], "]"}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "T"}], " ", 
           RowBox[{"\[Tau]", "[", "S", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["w", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"S", ",", "T"}], "]"}]}], ")"}], "2"]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ETT", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Nu]"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[CurlyEpsilon]", "+", 
         RowBox[{"\[CurlyEpsilon]p", "[", "T", "]"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["u", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"S", ",", "T"}], "]"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["w", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"S", ",", "T"}], "]"}], "2"]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EST", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["v", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"S", ",", "T"}], "]"}], "+", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "S", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"w", "[", 
            RowBox[{"S", ",", "T"}], "]"}], "-", 
           RowBox[{"T", " ", 
            RowBox[{
             SuperscriptBox["w", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"S", ",", "T"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["u", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"S", ",", "T"}], "]"}], "+", 
        RowBox[{
         RowBox[{
          SuperscriptBox["w", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"S", ",", "T"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["w", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"S", ",", "T"}], "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSS", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "T"}], " ", 
        RowBox[{
         SuperscriptBox["\[Tau]", "\[Prime]",
          MultilineFunction->None], "[", "S", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["w", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"S", ",", "T"}], "]"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BTT", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox["w", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"S", ",", "T"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BST", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Tau]", "[", "S", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["w", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"S", ",", "T"}], "]"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Emat", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ESS", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", 
         RowBox[{"EST", "[", 
          RowBox[{"S", ",", "T"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EST", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", 
         RowBox[{"ETT", "[", 
          RowBox[{"S", ",", "T"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Bmat", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"BSS", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", 
         RowBox[{"BST", "[", 
          RowBox[{"S", ",", "T"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"BST", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", 
         RowBox[{"BTT", "[", 
          RowBox[{"S", ",", "T"}], "]"}]}], "}"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.924503832085597*^9, 3.924503861350699*^9}, {
   3.9245038922258673`*^9, 3.924503966268798*^9}, {3.924505298880806*^9, 
   3.9245053195467052`*^9}, {3.9245735763237543`*^9, 3.924573596433878*^9}, {
   3.9245742663659678`*^9, 3.924574343952016*^9}, {3.924574464227201*^9, 
   3.924574535947803*^9}, {3.924574616472932*^9, 3.9245747860526342`*^9}, {
   3.924575124672926*^9, 3.924575155907566*^9}, 3.924575259926543*^9, 
   3.924575772339096*^9, {3.924575818777917*^9, 3.924575849578094*^9}, {
   3.924728843948003*^9, 3.924728878575583*^9}, {3.9247293307406282`*^9, 
   3.924729427019897*^9}, {3.924742403343163*^9, 3.924742404515491*^9}, {
   3.924753808897791*^9, 3.9247538279732733`*^9}, {3.9247538626663*^9, 
   3.924753935447805*^9}, {3.9247564574299107`*^9, 3.924756464113422*^9}, 
   3.924767062293285*^9, {3.9250307838498783`*^9, 3.925030812386155*^9}, {
   3.925030842991642*^9, 3.9250308875232162`*^9}, {3.925030995979603*^9, 
   3.925031001705958*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"ba0e2a33-0df6-4054-adc6-4dc6d4e698cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Nondimensional", " ", "strain", " ", "energy", " ", "density"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"strDen", "=", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Nu]", "2"]}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Nu]", " ", 
           SuperscriptBox[
            RowBox[{"Tr", "[", 
             RowBox[{"Emat", "[", 
              RowBox[{"S", ",", "T"}], "]"}], "]"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Nu]"}], ")"}], 
           RowBox[{"TensorContract", "[", 
            RowBox[{
             RowBox[{"TensorProduct", "[", 
              RowBox[{
               RowBox[{"Emat", "[", 
                RowBox[{"S", ",", "T"}], "]"}], ",", 
               RowBox[{"Emat", "[", 
                RowBox[{"S", ",", "T"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]}]}], ")"}]}],
        "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Nu]", " ", 
          SuperscriptBox[
           RowBox[{"Tr", "[", 
            RowBox[{"Bmat", "[", 
             RowBox[{"S", ",", "T"}], "]"}], "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Nu]"}], ")"}], 
          RowBox[{"TensorContract", "[", 
           RowBox[{
            RowBox[{"TensorProduct", "[", 
             RowBox[{
              RowBox[{"Bmat", "[", 
               RowBox[{"S", ",", "T"}], "]"}], ",", 
              RowBox[{"Bmat", "[", 
               RowBox[{"S", ",", "T"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]}]}], ")"}]}], 
      ")"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.924503832085597*^9, 3.924503861350699*^9}, {
   3.9245038922258673`*^9, 3.924503966268798*^9}, {3.924505298880806*^9, 
   3.9245053195467052`*^9}, {3.9245735763237543`*^9, 3.924573596433878*^9}, {
   3.9245742663659678`*^9, 3.924574343952016*^9}, {3.924574464227201*^9, 
   3.924574535947803*^9}, {3.924574616472932*^9, 3.9245747860526342`*^9}, {
   3.924575124672926*^9, 3.924575155907566*^9}, 3.924575259926543*^9, 
   3.924575772339096*^9, {3.924575818777917*^9, 3.924575849578094*^9}, {
   3.924728843948003*^9, 3.924728878575583*^9}, {3.9247293307406282`*^9, 
   3.924729427019897*^9}, {3.924742403343163*^9, 3.924742404515491*^9}, {
   3.924753808897791*^9, 3.9247538279732733`*^9}, {3.9247538626663*^9, 
   3.924753935447805*^9}, {3.9247564574299107`*^9, 3.924756464113422*^9}, 
   3.924767062293285*^9, {3.9250307838498783`*^9, 3.925030812386155*^9}, {
   3.925030842991642*^9, 3.9250308875232162`*^9}, {3.925030995979603*^9, 
   3.925031018114512*^9}, {3.925031126317107*^9, 3.9250311521763983`*^9}, 
   3.925066636286385*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"8ee74b46-eb91-4a67-b305-409bc4e777a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "nondimensionalization"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{"doSanityCheck", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ESS", "[", 
               RowBox[{"S", ",", "T"}], "]"}], ",", 
              RowBox[{"ETT", "[", 
               RowBox[{"S", ",", "T"}], "]"}], ",", 
              RowBox[{"EST", "[", 
               RowBox[{"S", ",", "T"}], "]"}]}], "}"}], "-", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"a", " ", "k"}], ")"}], "2"]], 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ESSb", "[", 
                RowBox[{"Sb", ",", "Tb"}], "]"}], ",", 
               RowBox[{"ETTb", "[", 
                RowBox[{"Sb", ",", "Tb"}], "]"}], ",", 
               RowBox[{"ESTb", "[", 
                RowBox[{"Sb", ",", "Tb"}], "]"}]}], "}"}]}]}], "]"}], "/.", 
          "NondimensionalizationReplacementRules"}], "/.", 
         "NondimensionalizationReplacementRules"}], "]"}], "==", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"BSS", "[", 
               RowBox[{"S", ",", "T"}], "]"}], ",", 
              RowBox[{"BTT", "[", 
               RowBox[{"S", ",", "T"}], "]"}], ",", 
              RowBox[{"BST", "[", 
               RowBox[{"S", ",", "T"}], "]"}]}], "}"}], "-", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"k", " "}]], 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"BSSb", "[", 
                RowBox[{"Sb", ",", "Tb"}], "]"}], ",", 
               RowBox[{"BTTb", "[", 
                RowBox[{"Sb", ",", "Tb"}], "]"}], ",", 
               RowBox[{"BSTb", "[", 
                RowBox[{"Sb", ",", "Tb"}], "]"}]}], "}"}]}]}], "]"}], "/.", 
          "NondimensionalizationReplacementRules"}], "/.", 
         "NondimensionalizationReplacementRules"}], "]"}], "==", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"strDen", "-", 
            RowBox[{
             FractionBox["1", 
              RowBox[{
               FractionBox[
                RowBox[{
                 SuperscriptBox["t", "5"], " ", "Y"}], 
                RowBox[{"144", " ", 
                 SuperscriptBox["a", "4"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["\[Nu]", "2"]}], ")"}], "2"]}]], " "}]], 
             "strDenb"}]}], "]"}], "/.", 
          "NondimensionalizationReplacementRules"}], "/.", 
         "NondimensionalizationReplacementRules"}], "]"}], "==", "0"}], "]"}],
      ";"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.924503832085597*^9, 3.924503861350699*^9}, {
   3.9245038922258673`*^9, 3.924503966268798*^9}, {3.924505298880806*^9, 
   3.9245053195467052`*^9}, {3.9245735763237543`*^9, 3.924573596433878*^9}, {
   3.9245742663659678`*^9, 3.924574343952016*^9}, {3.924574464227201*^9, 
   3.924574535947803*^9}, {3.924574616472932*^9, 3.9245747860526342`*^9}, {
   3.924575124672926*^9, 3.924575155907566*^9}, 3.924575259926543*^9, 
   3.924575772339096*^9, {3.924575818777917*^9, 3.924575849578094*^9}, {
   3.924728843948003*^9, 3.924728878575583*^9}, {3.9247293307406282`*^9, 
   3.924729427019897*^9}, {3.924742403343163*^9, 3.924742404515491*^9}, {
   3.924753808897791*^9, 3.9247538279732733`*^9}, {3.9247538626663*^9, 
   3.924753935447805*^9}, {3.9247564574299107`*^9, 3.924756464113422*^9}, 
   3.924767062293285*^9, {3.9250307838498783`*^9, 3.925030812386155*^9}, {
   3.925030842991642*^9, 3.9250308875232162`*^9}, {3.925030995979603*^9, 
   3.925031018114512*^9}, {3.925031126317107*^9, 3.925031339736834*^9}, {
   3.925031403663088*^9, 3.925031488919463*^9}, {3.925031570797865*^9, 
   3.9250316010278053`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"2e852bbe-3c8f-4f6e-8a10-d151e0373afc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Assuming slow variation of cross-sectional displacements and twist\
\>", "Section",
 CellChangeTimes->{{3.925032182738367*^9, 3.92503223483037*^9}, 
   3.925032280639082*^9},ExpressionUUID->"2dcd8f12-cd46-4cfa-ab10-\
6683e0485d67"],

Cell[TextData[{
 "Strain energy density assuming slow variation of twist and cross-sectional \
displacements along length:",
 Cell[BoxData[
  StyleBox[
   RowBox[{" ", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "n"], 
        RowBox[{"\[Tau]", "[", "S", "]"}]}], 
       SuperscriptBox["dS", "n"]], " ", "=", " ", 
      RowBox[{"\[ScriptCapitalO]", "[", 
       SuperscriptBox["\[Gamma]", "n"], "]"}]}], ",", " ", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["\[PartialD]", "n"], 
        RowBox[{"u", "[", 
         RowBox[{"S", ",", "T"}], "]"}], " "}], 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["S", "n"]}]], " ", "=", " ", 
      RowBox[{"\[ScriptCapitalO]", "[", 
       SuperscriptBox["\[Gamma]", "n"], "]"}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["\[PartialD]", "n"], 
        RowBox[{"v", "[", 
         RowBox[{"S", ",", "T"}], "]"}], " "}], 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["S", "n"]}]], " ", "=", " ", 
      RowBox[{"\[ScriptCapitalO]", "[", 
       SuperscriptBox["\[Gamma]", "n"], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"and", " ", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[PartialD]", "n"], 
         RowBox[{"w", "[", 
          RowBox[{"S", ",", "T"}], "]"}], " "}], 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["S", "n"]}]]}], " ", "=", " ", 
      RowBox[{"\[ScriptCapitalO]", "[", 
       SuperscriptBox["\[Gamma]", "n"], "]"}], " "}]}]}], "Text"]], "Text",
  ExpressionUUID->"57f5d3c3-80dc-4003-a0c1-4dffb4fb399f"],
 " "
}], "Text",
 CellChangeTimes->{
  3.925032316110276*^9, {3.925032349661257*^9, 3.92503241375953*^9}, {
   3.925032445939563*^9, 3.925032591780732*^9}, {3.925032660294236*^9, 
   3.925032740700531*^9}, {3.9250327716595182`*^9, 3.925032785523595*^9}, {
   3.925032859861012*^9, 3.92503289230154*^9}, 3.925032922748704*^9, {
   3.925032993569891*^9, 3.925033015324204*^9}, {3.926993274862686*^9, 
   3.926993274862844*^9}},ExpressionUUID->"268210e7-e673-47b8-b2ab-\
da664a0e4187"],

Cell[BoxData[
 RowBox[{
  RowBox[{"strDenSlowVariation", "=", 
   RowBox[{"strDen", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"w", "->", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"wLeadOrd", "[", 
            RowBox[{
             RowBox[{"\[Gamma]", " ", "#1"}], ",", "#2"}], "]"}], "+", 
           RowBox[{"\[Gamma]", " ", 
            RowBox[{"wFirstOrd", "[", 
             RowBox[{
              RowBox[{"\[Gamma]", " ", "#1"}], ",", "#2"}], "]"}]}], " ", "+", 
           RowBox[{
            SuperscriptBox["\[Gamma]", "2"], " ", 
            RowBox[{"wSecondOrd", "[", 
             RowBox[{
              RowBox[{"\[Gamma]", " ", "#1"}], ",", "#2"}], "]"}]}]}], ")"}], 
         "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"u", "->", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"uLeadOrd", "[", 
            RowBox[{
             RowBox[{"\[Gamma]", " ", "#1"}], ",", "#2"}], "]"}], "+", 
           RowBox[{"\[Gamma]", " ", 
            RowBox[{"uFirstOrd", "[", 
             RowBox[{
              RowBox[{"\[Gamma]", " ", "#1"}], ",", "#2"}], "]"}]}], " ", "+", 
           RowBox[{
            SuperscriptBox["\[Gamma]", "2"], " ", 
            RowBox[{"uSecondOrd", "[", 
             RowBox[{
              RowBox[{"\[Gamma]", " ", "#1"}], ",", "#2"}], "]"}]}]}], ")"}], 
         "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"v", "->", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"vLeadOrd", "[", 
            RowBox[{
             RowBox[{"\[Gamma]", " ", "#1"}], ",", "#2"}], "]"}], "+", 
           RowBox[{"\[Gamma]", " ", 
            RowBox[{"vFirstOrd", "[", 
             RowBox[{
              RowBox[{"\[Gamma]", " ", "#1"}], ",", "#2"}], "]"}]}], " ", "+", 
           RowBox[{
            SuperscriptBox["\[Gamma]", "2"], " ", 
            RowBox[{"vSecondOrd", "[", 
             RowBox[{
              RowBox[{"\[Gamma]", " ", "#1"}], ",", "#2"}], "]"}]}]}], ")"}], 
         "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]", "->", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Tau]", "[", 
          RowBox[{"\[Gamma]", " ", "#"}], "]"}], "&"}], ")"}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.925032316110276*^9, {3.925032349661257*^9, 3.92503241375953*^9}, {
   3.925032445939563*^9, 3.925032591780732*^9}, {3.925032660294236*^9, 
   3.925032740700531*^9}, {3.9250327716595182`*^9, 3.925032785523595*^9}, 
   3.925032859861012*^9, 3.92503311623132*^9, {3.925113501711994*^9, 
   3.925113570406852*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"ef585acd-6946-4c5f-bbaa-b309b222f63f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Strain", " ", "energy", " ", "density", " ", "at", " ", "various", " ", 
    "orders"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"strDenSlowVariationCoeffList", "=", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"CoefficientList", "[", 
       RowBox[{"strDenSlowVariation", ",", " ", "\[Gamma]"}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Gamma]", "->", " ", "1"}], "}"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.925032316110276*^9, {3.925032349661257*^9, 3.92503241375953*^9}, {
   3.925032445939563*^9, 3.925032591780732*^9}, {3.925032660294236*^9, 
   3.925032740700531*^9}, {3.9250327716595182`*^9, 3.925032785523595*^9}, 
   3.925032859861012*^9, {3.92503311623132*^9, 3.925033178869926*^9}, {
   3.9250663078170557`*^9, 3.9250663132172947`*^9}, {3.925113600005612*^9, 
   3.925113616365007*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"58d47743-d464-4ca8-a484-6055d7954106"],

Cell[TextData[{
 StyleBox["We want to minimize this energy in a cross-section at S subjected \
to constraints: ",
  FontColor->RGBColor[1., 0., 0.]],
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Integral]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]], 
     RowBox[{"1", "/", "2"}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"S", ",", "T"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"S", ",", "T"}], "]"}], ",", 
       RowBox[{"w", "[", 
        RowBox[{"S", ",", "T"}], "]"}], ",", 
       RowBox[{"T", " ", 
        RowBox[{"w", "[", 
         RowBox[{"S", ",", "T"}], "]"}]}]}], ")"}], 
     RowBox[{"\[DifferentialD]", "T"}]}]}], "=", 
   RowBox[{"(", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], ")"}]}]],
  FontColor->RGBColor[1., 0., 0.],ExpressionUUID->
  "4c4cea3d-c582-4101-8f8b-6b7fbd6f4b7d"],
 StyleBox[". Let fT, fS, fN, and gN be the Lagrange multipliers that impose \
these constraints. Similar to cross-sectional displacements we assume the \
expansions for Lagrange multipliers as: ",
  FontColor->RGBColor[1., 0., 0.]],
 "\nfS[S]= fSLeadOrd]S] + ",
 Cell[BoxData[
 "\[Gamma]"], "Input",ExpressionUUID->
  "d27f8ac0-62c2-42d6-9ea9-a02c53a9b75f"],
 " fSFirstOrd[S] + ",
 Cell[BoxData[
  SuperscriptBox["\[Gamma]", "2"]], "Input",ExpressionUUID->
  "926f6bf1-48c2-49e5-b2b9-524d59f58983"],
 " fSSecondOrd[S] ..\nfT[S]= fTLeadOrd]S] + ",
 Cell[BoxData[
 "\[Gamma]"], "Input",ExpressionUUID->
  "31475f1c-2d4e-4de8-bd84-a155b1eaa9cb"],
 " fTFirstOrd[S] + ",
 Cell[BoxData[
  SuperscriptBox["\[Gamma]", "2"]], "Input",ExpressionUUID->
  "d1e995e9-6e9f-48ce-a4ff-0b049c5332e2"],
 " fTSecondOrd[S] ..\nfN[S]= fNLeadOrd]S] + ",
 Cell[BoxData[
 "\[Gamma]"], "Input",ExpressionUUID->
  "895e2259-0b3d-4d40-a2d1-ec575f5c086e"],
 " fNFirstOrd[S] + ",
 Cell[BoxData[
  SuperscriptBox["\[Gamma]", "2"]], "Input",ExpressionUUID->
  "ebcc1852-6536-43f1-8764-d43ee59750ab"],
 " fNSecondOrd[S] ..\ngN[S]= gNLeadOrd]S] + ",
 Cell[BoxData[
 "\[Gamma]"], "Input",ExpressionUUID->
  "1618f34a-3e87-4fac-b4bd-6fe2514bcca1"],
 " gNFirstOrd[S] + ",
 Cell[BoxData[
  SuperscriptBox["\[Gamma]", "2"]], "Input",ExpressionUUID->
  "a8888ffe-e28a-4be6-bd01-5822371bebb6"],
 " gNSecondOrd[S] ..\n"
}], "Text",
 CellChangeTimes->{{3.924503832085597*^9, 3.924503861350699*^9}, {
   3.9245038922258673`*^9, 3.924503966268798*^9}, {3.924505298880806*^9, 
   3.9245053195467052`*^9}, {3.9245735763237543`*^9, 3.924573596433878*^9}, {
   3.9245742663659678`*^9, 3.924574343952016*^9}, {3.924574464227201*^9, 
   3.924574535947803*^9}, {3.924574616472932*^9, 3.9245747860526342`*^9}, {
   3.924575124672926*^9, 3.924575155907566*^9}, 3.924575259926543*^9, 
   3.924575772339096*^9, {3.924575818777917*^9, 3.924575849578094*^9}, {
   3.924728843948003*^9, 3.924728878575583*^9}, {3.9247293307406282`*^9, 
   3.924729427019897*^9}, {3.924742403343163*^9, 3.924742404515491*^9}, {
   3.924753808897791*^9, 3.9247538279732733`*^9}, {3.9247538626663*^9, 
   3.924753935447805*^9}, {3.9247564574299107`*^9, 3.924756464113422*^9}, 
   3.924767062293285*^9, {3.9250307838498783`*^9, 3.925030812386155*^9}, {
   3.925030842991642*^9, 3.9250308875232162`*^9}, {3.925030995979603*^9, 
   3.925031018114512*^9}, {3.925031126317107*^9, 3.9250311521763983`*^9}, {
   3.925066636286385*^9, 3.925066640211484*^9}, {3.9250943896047*^9, 
   3.9250943916150618`*^9}, {3.925113305708262*^9, 3.925113323708929*^9}, {
   3.925113725962062*^9, 3.925114010605823*^9}, {3.925114101882195*^9, 
   3.925114131061673*^9}, {3.92516768940406*^9, 3.925167703612492*^9}, {
   3.925631673278043*^9, 3.925631692396285*^9}, {3.925631723646195*^9, 
   3.92563176868396*^9}, {3.926993276060627*^9, 3.926993278323847*^9}, {
   3.9324325575726357`*^9, 
   3.932432557727832*^9}},ExpressionUUID->"3936feb0-8c65-497e-bdc0-\
7c0a14127dcf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving for leading order displacements", "Section",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, 3.924942594496606*^9, {
   3.925113438392497*^9, 3.9251134433415613`*^9}, 
   3.925113473426338*^9},ExpressionUUID->"1b38ee61-3587-47ee-8c7f-\
c033e805e38f"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"leadingOrdPotToMinimize", " ", "=", " ", 
    RowBox[{
     RowBox[{"strDenSlowVariationCoeffList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"fSLeadOrd", "[", "S", "]"}], " ", 
        RowBox[{"vLeadOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"fTLeadOrd", "[", "S", "]"}], " ", 
        RowBox[{"uLeadOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"fNLeadOrd", "[", "S", "]"}], 
        RowBox[{"wLeadOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"gNLeadOrd", "[", "S", "]"}], " ", "T", " ", 
        RowBox[{"wLeadOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}]}]}], ")"}]}]}], ";"}], 
  "Input"]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, 3.924942594496606*^9, {
   3.925113438392497*^9, 3.9251134433415613`*^9}, {3.9251134757618513`*^9, 
   3.925113496106576*^9}, {3.925113639623909*^9, 3.9251136875707273`*^9}, 
   3.925162023593422*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"45db21c7-417b-475b-a28a-7f7e866c49ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Replace", " ", "rules", " ", "to", " ", "calculate", " ", "first", " ", 
    "variation", " ", "of", " ", "leading", " ", "order", " ", "potential"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"repRulesLeadOrdDisPerturb", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"wLeadOrd", "->", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"wLeadOrd", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "+", " ", 
           RowBox[{"\[Eta]", " ", 
            RowBox[{"\[Delta]wLeadOrd", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}]}]}], ")"}], " ", "&"}], ")"}]}],
       ",", 
      RowBox[{"uLeadOrd", "->", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"uLeadOrd", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "+", " ", 
           RowBox[{"\[Eta]", " ", 
            RowBox[{"\[Delta]uLeadOrd", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}]}]}], ")"}], " ", "&"}], ")"}]}],
       ",", " ", 
      RowBox[{"vLeadOrd", "->", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"vLeadOrd", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "+", " ", 
           RowBox[{"\[Eta]", " ", 
            RowBox[{"\[Delta]vLeadOrd", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}]}]}], ")"}], " ", "&"}], 
        ")"}]}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.925115803352379*^9, 3.925115832153219*^9}, {
  3.925115863758451*^9, 3.9251158665175037`*^9}, {3.925115901628294*^9, 
  3.925115943071931*^9}, {3.925162311014316*^9, 3.92516233643014*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"e60a032a-d5eb-4f48-8cab-7f4a2df30a24"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"first", " ", "variation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"eqToSolveForLeadOrdDis", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"leadingOrdPotToMinimize", "/.", "repRulesLeadOrdDisPerturb"}], 
      ",", "\[Eta]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"\[Eta]", "->", " ", "0"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.925115803352379*^9, 3.925115832153219*^9}, {
   3.925115863758451*^9, 3.9251158665175037`*^9}, {3.925115901628294*^9, 
   3.925115943071931*^9}, {3.925162311014316*^9, 3.925162355886825*^9}, 
   3.925162448840858*^9, 3.925167236585182*^9, {3.9251673684788*^9, 
   3.9251673694075737`*^9}, {3.925383550019884*^9, 3.9253835566528807`*^9}, 
   3.9253836379989853`*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"6a3d3a98-eca6-4a7f-9ad7-5b916eed1ea5"],

Cell[CellGroupData[{

Cell["Terms with \[Delta]vLeadOrd and its derivatives in T", "Subsection",
 CellChangeTimes->{{3.8770056461077957`*^9, 3.877005667192342*^9}, {
   3.877005705558473*^9, 3.877005806394244*^9}, {3.877006190355116*^9, 
   3.8770061918453827`*^9}, {3.877022485481937*^9, 3.877022500781509*^9}, {
   3.8770532577413177`*^9, 3.877053272967491*^9}, {3.877061650480495*^9, 
   3.87706166296099*^9}, {3.877078498203377*^9, 3.877078512635633*^9}, {
   3.877139919058017*^9, 3.877139920464994*^9}, 3.877145268202771*^9, {
   3.877151655864447*^9, 3.877151656206232*^9}, 3.877151729471819*^9, 
   3.877231219341444*^9, {3.877330922992877*^9, 3.877330956737487*^9}, 
   3.877331071504815*^9, {3.877351450387567*^9, 3.8773514697053537`*^9}, {
   3.87735151537541*^9, 3.877351537955406*^9}, {3.877352539239214*^9, 
   3.877352539961315*^9}, 3.877352664930305*^9, {3.8773707758603354`*^9, 
   3.877370786552219*^9}, {3.877530489755978*^9, 3.877530502666512*^9}, {
   3.8776134553035173`*^9, 3.877613459394692*^9}, {3.877613503035859*^9, 
   3.8776135063571253`*^9}, {3.877614092940978*^9, 3.877614093844037*^9}, {
   3.9247624544946537`*^9, 3.924762456410796*^9}, {3.924767146844849*^9, 
   3.924767149034286*^9}, {3.92482326459624*^9, 3.924823266047306*^9}, {
   3.925167334613155*^9, 3.9251673467020693`*^9}, 
   3.9251674365380583`*^9},ExpressionUUID->"66a82287-17a1-4d75-8785-\
0a55b8abf728"],

Cell["\<\
Collect coefficient of \[Delta]vLeadOrd and its derivatives in T in the first \
variation\
\>", "Text",
 CellChangeTimes->{{3.8770056461077957`*^9, 3.877005667192342*^9}, {
   3.877005705558473*^9, 3.877005806394244*^9}, {3.877006190355116*^9, 
   3.8770061918453827`*^9}, {3.877022485481937*^9, 3.877022500781509*^9}, {
   3.8770532577413177`*^9, 3.877053272967491*^9}, {3.877061650480495*^9, 
   3.87706166296099*^9}, {3.877078498203377*^9, 3.877078512635633*^9}, {
   3.877139919058017*^9, 3.877139920464994*^9}, 3.877145268202771*^9, {
   3.877151655864447*^9, 3.877151656206232*^9}, 3.877151729471819*^9, 
   3.877231219341444*^9, {3.877330922992877*^9, 3.877330956737487*^9}, 
   3.877331071504815*^9, {3.877351450387567*^9, 3.8773514697053537`*^9}, {
   3.87735151537541*^9, 3.877351537955406*^9}, {3.877352539239214*^9, 
   3.877352539961315*^9}, 3.877352664930305*^9, {3.8773707758603354`*^9, 
   3.877370786552219*^9}, {3.877530489755978*^9, 3.877530502666512*^9}, {
   3.8776134553035173`*^9, 3.877613459394692*^9}, {3.877613503035859*^9, 
   3.8776135063571253`*^9}, {3.877614092940978*^9, 3.877614093844037*^9}, {
   3.9247624544946537`*^9, 3.924762456410796*^9}, {3.924767146844849*^9, 
   3.924767149034286*^9}, {3.92482326459624*^9, 3.924823266047306*^9}, {
   3.925167334613155*^9, 3.9251673467020693`*^9}, {3.925167439105173*^9, 
   3.925167444695472*^9}},ExpressionUUID->"7913e807-529d-446e-bd5e-\
8215ba6f3b53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqvLeadOrd", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"eqToSolveForLeadOrdDis", " ", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]wLeadOrd", "->", " ", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}], ",", 
         RowBox[{"\[Delta]uLeadOrd", "->", " ", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Delta]vLeadOrd", "[", 
        RowBox[{"S", ",", "T"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Delta]vLeadOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}]}], "}"}], ",", 
     "FullSimplify"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8770056461077957`*^9, 3.877005667192342*^9}, {
   3.877005705558473*^9, 3.877005806394244*^9}, {3.877006190355116*^9, 
   3.8770061918453827`*^9}, {3.877022485481937*^9, 3.877022500781509*^9}, {
   3.8770532577413177`*^9, 3.877053272967491*^9}, {3.877061650480495*^9, 
   3.87706166296099*^9}, {3.877078498203377*^9, 3.877078512635633*^9}, {
   3.877139919058017*^9, 3.877139920464994*^9}, 3.877145268202771*^9, {
   3.877151655864447*^9, 3.877151656206232*^9}, 3.877151729471819*^9, 
   3.877231219341444*^9, {3.877330922992877*^9, 3.877330956737487*^9}, 
   3.877331071504815*^9, {3.877351450387567*^9, 3.8773514697053537`*^9}, {
   3.87735151537541*^9, 3.877351537955406*^9}, {3.877352539239214*^9, 
   3.877352539961315*^9}, 3.877352664930305*^9, {3.8773707758603354`*^9, 
   3.877370786552219*^9}, {3.877530489755978*^9, 3.877530502666512*^9}, {
   3.8776134553035173`*^9, 3.877613459394692*^9}, {3.877613503035859*^9, 
   3.877613518012246*^9}, {3.877613674592321*^9, 3.8776136755800257`*^9}, {
   3.877614183721623*^9, 3.877614186320405*^9}, {3.879404167808715*^9, 
   3.8794041846550837`*^9}, {3.9247624601562233`*^9, 3.924762531245245*^9}, 
   3.9248134775034647`*^9, {3.924813984384494*^9, 3.924813987536162*^9}, {
   3.925167355788733*^9, 3.925167388959956*^9}, {3.925167451168148*^9, 
   3.925167489068882*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"074c716e-ddbb-4a79-885c-0ac2e1784cc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nSTLeadOrdExp", "[", 
    RowBox[{"S_", ",", "T_"}], "]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["vLeadOrd", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"S", ",", "T"}], "]"}], "+", 
       RowBox[{
        RowBox[{"\[Tau]", "[", "S", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wLeadOrd", "[", 
           RowBox[{"S", ",", "T"}], "]"}], "-", 
          RowBox[{"T", " ", 
           RowBox[{
            SuperscriptBox["wLeadOrd", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"S", ",", "T"}], "]"}]}]}], ")"}]}]}], ")"}], " "}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Nu]"}], ")"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.92476651858823*^9, 3.924766529492455*^9}, {
   3.924766587027725*^9, 3.924766587456036*^9}, 3.924813473649515*^9, {
   3.925167537867539*^9, 3.925167568086184*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"93586db6-c10a-4b34-a540-5feef7ac3e4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqvLeadOrdAltForm", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"fSLeadOrd", "[", "S", "]"}]}], " ", 
     RowBox[{"\[Delta]vLeadOrd", "[", 
      RowBox[{"S", ",", "T"}], "]"}]}], "+", " ", 
    RowBox[{
     RowBox[{"nSTLeadOrd", "[", 
      RowBox[{"S", ",", "T"}], "]"}], 
     RowBox[{
      SuperscriptBox["\[Delta]vLeadOrd", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"S", ",", "T"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.924766532654338*^9, 3.924766581886709*^9}, 
   3.9248134707279797`*^9, {3.925167577024472*^9, 3.925167592782621*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"b515cdf1-6118-4c59-bf26-2667864a41c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"check", " ", "expression", " ", "for", " ", "nSTLeadOrd"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CheckSanity", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"eqvLeadOrdAltForm", " ", "-", " ", "eqvLeadOrd"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"nSTLeadOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}], "->", " ", 
        RowBox[{"nSTLeadOrdExp", "[", 
         RowBox[{"S", ",", "T"}], "]"}]}], "}"}]}], "]"}], "==", "0"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.924766598453147*^9, 3.924766655301077*^9}, {
  3.9251675970651484`*^9, 3.9251676112227793`*^9}, {3.925185588854067*^9, 
  3.9251856060714207`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"60c34452-699f-4acc-b23d-476168044ba2"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
   "Calculation", " ", "of", " ", "differential", " ", "equation", " ", "for",
     " ", "vLeadOrd"}], " "}], "Subsubsection"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Integral]", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       RowBox[{"1", "/", "2"}]], " ", 
      RowBox[{"-", "fSLeadOrd\[Delta]vLeadLOrd"}]}], " ", "+", " ", 
     RowBox[{"nSTLeadOrd", " ", 
      SubscriptBox["\[Delta]vLeadOrd", 
       RowBox[{",", "T"}]], " ", "dT"}]}], "=", "0"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "fSLeadOrd"}], " ", "\[Delta]vLeadOrd"}], " ", "+", " ", 
        SubscriptBox[
         RowBox[{"(", 
          RowBox[{"nSTLeadOrd", " ", "\[Delta]vLeadOrd"}], ")"}], 
         RowBox[{",", "T"}]], " ", "-", " ", 
        RowBox[{
         SubscriptBox["nSTLeadOrd", 
          RowBox[{",", "T"}]], " ", "\[Delta]vLeadOrd"}]}], ")"}], " ", 
      "dT"}]}], "=", "0"}], " "}], "Text"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], " ", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"fSLeadOrd", " ", "+", " ", 
         SubscriptBox["nSTLeaOrd", 
          RowBox[{",", "T"}]]}], ")"}]}], " ", "\[Delta]vLeadOrd", " ", 
      "dT"}]}], " ", "+", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox[
       RowBox[{"[", 
        RowBox[{"nSTLeadOrd", " ", "\[Delta]vLeadOrd"}], "]"}], 
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}]], 
      RowBox[{"T", "=", 
       RowBox[{"1", "/", "2"}]}]], 
     RowBox[{"=", "0"}]}]}], ";"}], "Text"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
    "we", " ", "get", " ", "natural", " ", "boundary", " ", "conditions", " ", 
     RowBox[{"as", ":", " ", 
      RowBox[{"nSTLeadOrd", "[", 
       RowBox[{"S", ",", 
        RowBox[{
         RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}], "]"}]}]}], "=", "0"}], 
   ",", " ", "\[IndentingNewLine]", 
   RowBox[{
   "and", " ", "the", " ", "differential", " ", "equation", " ", "as"}]}], 
  "Text"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["nSTLeadOrd", 
      RowBox[{",", "T"}]], " ", "+", "fSLeadOrd"}], " ", "=", "0"}], ";"}], 
  "Text"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"on", " ", "integrating", " ", "along", " ", "T"}], ",", " ", 
   RowBox[{"we", " ", "get"}]}], "Text"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"nSTLeadOrd", " ", "+", " ", 
     RowBox[{"fSLeadOrd", " ", "T"}], " ", "+", " ", "cvLeadOrd"}], " ", "=", 
    "0"}], ";", " ", 
   RowBox[{
    RowBox[{"where", " ", "cvLeadOrd"}], " ", "=", " ", 
    RowBox[{"constant", " ", "of", " ", "integration"}]}]}], 
  "Text"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"At", " ", "T"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[PlusMinus]", "1"}], "/", "2"}], " ", "we", " ", "have"}]}], 
  "Text"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"nSTLeadOrd", "[", 
      RowBox[{"S", ",", 
       FractionBox["1", "2"]}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"fSLeadOrd", "[", "S", "]"}], 
      RowBox[{"(", 
       FractionBox["1", "2"], ")"}]}], " ", "+", " ", 
     RowBox[{"cvLeadOrd", "[", "S", "]"}]}], " ", "=", " ", "0"}], " ", ";"}],
   "Text"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"nSTLeadOrd", "[", 
      RowBox[{"S", ",", 
       RowBox[{"-", 
        FractionBox["1", "2"]}]}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"fSLeadOrd", "[", "S", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"-", 
        FractionBox["1", "2"]}], ")"}]}], "+", " ", 
     RowBox[{"cvLeadOrd", "[", "S", "]"}]}], " ", "=", " ", "0"}], " ", ";"}],
   "Text"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
   "using", " ", "the", " ", "natural", " ", "boundry", " ", "conditions"}], 
   ",", " ", 
   RowBox[{"it", " ", "boils", " ", "to"}]}], "Text"], "\[IndentingNewLine]", 

 RowBox[{
  StyleBox[" ", "Text"], 
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fSLeadOrd", "[", "S", "]"}], 
       RowBox[{"(", 
        FractionBox["1", "2"], ")"}]}], " ", "+", " ", 
      RowBox[{"cvLeadOrd", "[", "S", "]"}]}], " ", "=", " ", "0"}], " ", 
    ";"}], "Text"]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[" ", "Text"], 
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fSLeadOrd", "[", "S", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"-", 
         FractionBox["1", "2"]}], ")"}]}], "+", " ", 
      RowBox[{"cvLeadOrd", "[", "S", "]"}]}], " ", "=", " ", "0"}], " ", 
    ";"}], "Text"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"which", " ", "gives", " ", 
     RowBox[{"fSLeadOrd", "[", "S", "]"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"cvLeadOrd", "[", "S", "]"}], " ", "=", "0"}]}], ",", 
   RowBox[{
   "and", " ", "therefore", " ", "the", " ", "differential", " ", 
    "equation"}]}], "Text"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"nSTLeadOrd", " ", "[", 
    RowBox[{"S", ",", "T"}], "]"}], "=", " ", "0"}], 
  "Text"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
   "which", " ", "will", " ", "see", " ", "that", " ", "is", " ", "a", " ", 
    "first", " ", "order", " ", "differential", " ", "equation", " ", "in", 
    " ", 
    RowBox[{"T", ".", " ", "Once"}], " ", "wLeadOrd", " ", "is", " ", 
    "known"}], ",", " ", 
   RowBox[{
    RowBox[{
    "we", " ", "can", " ", "solve", " ", "it", " ", "in", " ", "conjuction", 
     " ", "with", " ", "the", " ", "integral", " ", "constraint", " ", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Integral]", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       RowBox[{"1", "/", "2"}]], " ", 
      RowBox[{
       RowBox[{"vLeadOrd", "[", 
        RowBox[{"S", ",", "T"}], "]"}], " ", "dT"}]}]}], " ", "=", " ", 
    "0"}]}], "Text"]}], "Text",
 CellChangeTimes->{{3.877022513712929*^9, 3.877022516973556*^9}, {
   3.877053704553198*^9, 3.877053878151829*^9}, {3.877053927770347*^9, 
   3.8770539708771276`*^9}, {3.877054005678164*^9, 3.8770540984145823`*^9}, {
   3.877054172339796*^9, 3.8770542044057407`*^9}, {3.877054272363752*^9, 
   3.877054361658428*^9}, {3.8770544146945953`*^9, 3.877054629323852*^9}, {
   3.8770547469068613`*^9, 3.877054754411489*^9}, {3.8770547845039253`*^9, 
   3.87705481982298*^9}, {3.8770548715690413`*^9, 3.877054893102345*^9}, {
   3.877054928676278*^9, 3.8770549923643303`*^9}, {3.877055023972196*^9, 
   3.877055172801949*^9}, 3.8770553087096243`*^9, {3.877055987277916*^9, 
   3.877055993380925*^9}, {3.87705606612225*^9, 3.8770560699863253`*^9}, {
   3.877056152687504*^9, 3.877056202020637*^9}, {3.8770575913823843`*^9, 
   3.877057606080278*^9}, {3.87713985126781*^9, 3.877139858981791*^9}, {
   3.87715221886835*^9, 3.8771522627296133`*^9}, 3.87715265504243*^9, {
   3.8772314054939938`*^9, 3.877231405777104*^9}, {3.877351548586211*^9, 
   3.877351552505745*^9}, {3.87735173217245*^9, 3.877351964560194*^9}, {
   3.877352167121801*^9, 3.877352171066856*^9}, {3.877352203476626*^9, 
   3.877352208011215*^9}, 3.877370355720194*^9, 3.877411277191889*^9, {
   3.8774397117574587`*^9, 3.8774397372743607`*^9}, {3.8774397838838882`*^9, 
   3.8774398229323072`*^9}, 3.87940418913976*^9, {3.924766677892531*^9, 
   3.924767024765521*^9}, {3.925167507719516*^9, 3.925167523943666*^9}, {
   3.925180117678648*^9, 3.925180157052143*^9}, {3.925184584758353*^9, 
   3.925184639804818*^9}, {3.925184705475583*^9, 3.925184733068904*^9}, {
   3.925184764937051*^9, 3.925184881758902*^9}, {3.925184913528421*^9, 
   3.92518493055575*^9}, {3.925184989033976*^9, 3.925185083730842*^9}, {
   3.92518513022123*^9, 3.925185287281581*^9}, {3.9251855495794687`*^9, 
   3.92518555339669*^9}, {3.925335751836584*^9, 3.925335762550386*^9}, {
   3.925346096300819*^9, 3.9253461081496973`*^9}, 
   3.926993281296541*^9},ExpressionUUID->"bde4b3a2-2703-442c-ab60-\
4f77d2ccb887"],

Cell[BoxData[
 RowBox[{
  RowBox[{"diffEqnvLeadOrd", " ", "=", " ", 
   RowBox[{"nSTLeadOrdExp", "[", 
    RowBox[{"S", ",", "T"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.877022513712929*^9, 3.877022516973556*^9}, {
   3.877053704553198*^9, 3.877053878151829*^9}, {3.877053927770347*^9, 
   3.8770539708771276`*^9}, {3.877054005678164*^9, 3.8770540984145823`*^9}, {
   3.877054172339796*^9, 3.8770542044057407`*^9}, {3.877054272363752*^9, 
   3.877054361658428*^9}, {3.8770544146945953`*^9, 3.877054629323852*^9}, {
   3.8770547469068613`*^9, 3.877054754411489*^9}, {3.8770547845039253`*^9, 
   3.87705481982298*^9}, {3.8770548715690413`*^9, 3.877054893102345*^9}, {
   3.877054928676278*^9, 3.8770549923643303`*^9}, {3.877055023972196*^9, 
   3.877055172801949*^9}, 3.8770553087096243`*^9, {3.877055987277916*^9, 
   3.877055993380925*^9}, {3.87705606612225*^9, 3.8770560699863253`*^9}, {
   3.877056152687504*^9, 3.877056164781526*^9}, {3.877057448436517*^9, 
   3.877057582965824*^9}, 3.877057629974504*^9, 3.877061239038818*^9, {
   3.877061535943677*^9, 3.877061537599843*^9}, {3.8770766985244217`*^9, 
   3.877076812499345*^9}, {3.877076903820915*^9, 3.87707695883564*^9}, {
   3.877077309118314*^9, 3.877077319939056*^9}, {3.87707793574288*^9, 
   3.877077937712892*^9}, {3.877142105241219*^9, 3.877142106546664*^9}, {
   3.877142569927475*^9, 3.877142570658235*^9}, {3.877143708002226*^9, 
   3.8771437088654737`*^9}, 3.877351558347041*^9, {3.877352642118937*^9, 
   3.877352647825848*^9}, {3.8773527734360228`*^9, 3.877352787872979*^9}, {
   3.877353026125814*^9, 3.8773530294897118`*^9}, {3.9247672173194237`*^9, 
   3.924767228844845*^9}, 3.924813464692789*^9, {3.92518004346148*^9, 
   3.9251800566098127`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"2ecd4962-a92f-4949-9e0d-0136754eea21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "In", " ", "the", " ", "differential", " ", "equation", " ", 
      "diffEqnvLeadOrd"}], " ", "=", " ", "0"}], ",", " ", 
    RowBox[{"we", " ", "collect", " ", 
     SubscriptBox["vLeadOrd", 
      RowBox[{",", "T"}]], " ", "on", " ", "left", " ", "hand", " ", "side", 
     " ", "and", " ", "rest", " ", "of", " ", "the", " ", "terms", " ", "on", 
     " ", "right", " ", "hand", " ", "side", " ", "as"}]}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vLeadOrdDT", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"vLeadOrd", "[", 
           RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Collect", "[", 
             RowBox[{
              RowBox[{"Simplify", "[", 
               RowBox[{"diffEqnvLeadOrd", 
                RowBox[{"(", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "\[Nu]"}], ")"}]}], " ", ")"}]}], "]"}], 
              ",", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"vLeadOrd", "[", 
                 RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}], ",", 
              "FullSimplify"}], "]"}], "==", "0"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"vLeadOrd", "[", 
              RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wLeadOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox["wLeadOrd", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"S", ",", "T"}], "]"}]}], "}"}], ",", "FullSimplify"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "It", " ", "is", " ", "a", " ", "first", " ", "order", " ", 
      "differential", " ", 
      RowBox[{"equation", ".", " ", "Once"}], " ", "wLeadOrd", " ", "is", " ",
       "known"}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "can", " ", "solve", " ", "it", " ", "in", " ", "conjuction",
        " ", "with", " ", "the", " ", "integral", " ", "constraint", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Integral]", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]], 
         RowBox[{"1", "/", "2"}]], " ", 
        RowBox[{
         RowBox[{"vLeadOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], " ", "dT"}]}]}], " ", "=", " ", 
      "0"}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.877077485266654*^9, 3.877077512618775*^9}, {
   3.87707764985079*^9, 3.87707777119314*^9}, {3.877077940731495*^9, 
   3.8770779427916517`*^9}, {3.8770820685160646`*^9, 
   3.8770820724413347`*^9}, {3.877151913837326*^9, 3.877151914370894*^9}, {
   3.877351369482993*^9, 3.877351372591715*^9}, {3.8773515641497498`*^9, 
   3.8773515737122173`*^9}, {3.877352800658642*^9, 3.877352801122967*^9}, {
   3.8773528378689003`*^9, 3.877352849600806*^9}, {3.87735289061014*^9, 
   3.877352891060618*^9}, {3.877530512275743*^9, 3.8775305262383537`*^9}, {
   3.87753110260773*^9, 3.8775311086007566`*^9}, {3.877614067382983*^9, 
   3.877614079750996*^9}, 3.879400258196865*^9, {3.924768030871813*^9, 
   3.924768162622357*^9}, {3.9247682258312197`*^9, 3.924768226074903*^9}, {
   3.924768273227687*^9, 3.9247682845717382`*^9}, 3.924813460380291*^9, {
   3.925180060324275*^9, 3.9251800930474987`*^9}, {3.925185466279001*^9, 
   3.9251855334705048`*^9}, {3.9251857514563437`*^9, 
   3.9251857533224497`*^9}, {3.925195384612173*^9, 3.925195389070134*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"ebf42137-44ac-453c-a557-270497ea07d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Terms with \[Delta]uLeadOrd and its derivatives in T", "Subsection",
 CellChangeTimes->{{3.877077485266654*^9, 3.877077512618775*^9}, {
   3.87707764985079*^9, 3.87707777119314*^9}, {3.877077940731495*^9, 
   3.8770779427916517`*^9}, {3.8770820685160646`*^9, 
   3.8770820724413347`*^9}, {3.877151913837326*^9, 3.877151914370894*^9}, {
   3.877351369482993*^9, 3.877351372591715*^9}, {3.8773515641497498`*^9, 
   3.8773515737122173`*^9}, {3.877352800658642*^9, 3.877352801122967*^9}, {
   3.8773528378689003`*^9, 3.877352849600806*^9}, {3.87735289061014*^9, 
   3.877352891060618*^9}, {3.877530512275743*^9, 3.8775305262383537`*^9}, {
   3.87753110260773*^9, 3.8775311086007566`*^9}, {3.877614067382983*^9, 
   3.877614079750996*^9}, 3.879400258196865*^9, {3.924768030871813*^9, 
   3.924768162622357*^9}, {3.9247682258312197`*^9, 3.924768226074903*^9}, {
   3.924768273227687*^9, 3.9247682845717382`*^9}, 3.924813460380291*^9, {
   3.925180060324275*^9, 3.9251800930474987`*^9}, {3.925185466279001*^9, 
   3.9251855334705048`*^9}, {3.9251857514563437`*^9, 
   3.9251857533224497`*^9}, {3.925195384612173*^9, 3.925195423088512*^9}, {
   3.925198722630021*^9, 
   3.925198723393837*^9}},ExpressionUUID->"22f7d6cb-8266-4397-adc4-\
f262dd2ffc6d"],

Cell["\<\
Collect coefficient of \[Delta]uLeadOrd and its derivatives in T in the first \
variation\
\>", "Text",
 CellChangeTimes->{{3.877077485266654*^9, 3.877077512618775*^9}, {
   3.87707764985079*^9, 3.87707777119314*^9}, {3.877077940731495*^9, 
   3.8770779427916517`*^9}, {3.8770820685160646`*^9, 
   3.8770820724413347`*^9}, {3.877151913837326*^9, 3.877151914370894*^9}, {
   3.877351369482993*^9, 3.877351372591715*^9}, {3.8773515641497498`*^9, 
   3.8773515737122173`*^9}, {3.877352800658642*^9, 3.877352801122967*^9}, {
   3.8773528378689003`*^9, 3.877352849600806*^9}, {3.87735289061014*^9, 
   3.877352891060618*^9}, {3.877530512275743*^9, 3.8775305262383537`*^9}, {
   3.87753110260773*^9, 3.8775311086007566`*^9}, {3.877614067382983*^9, 
   3.877614079750996*^9}, 3.879400258196865*^9, {3.924768030871813*^9, 
   3.924768162622357*^9}, {3.9247682258312197`*^9, 3.924768226074903*^9}, {
   3.924768273227687*^9, 3.9247682845717382`*^9}, 3.924813460380291*^9, {
   3.925180060324275*^9, 3.9251800930474987`*^9}, {3.925185466279001*^9, 
   3.9251855334705048`*^9}, {3.9251857514563437`*^9, 
   3.9251857533224497`*^9}, {3.925195384612173*^9, 3.9251954590451612`*^9}, {
   3.925198729530527*^9, 
   3.925198730109372*^9}},ExpressionUUID->"90243e6b-bdd5-41fa-95b7-\
4e510250fbd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"equLeadOrd", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"eqToSolveForLeadOrdDis", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]wLeadOrd", "->", " ", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}], ",", 
         RowBox[{"\[Delta]vLeadOrd", "->", " ", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Delta]uLeadOrd", "[", 
        RowBox[{"S", ",", "T"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Delta]uLeadOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}]}], "}"}], ",", 
     "FullSimplify"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.877077485266654*^9, 3.877077512618775*^9}, {
   3.87707764985079*^9, 3.87707777119314*^9}, {3.877077940731495*^9, 
   3.8770779427916517`*^9}, {3.8770820685160646`*^9, 
   3.8770820724413347`*^9}, {3.877151913837326*^9, 3.877151914370894*^9}, {
   3.877351369482993*^9, 3.877351372591715*^9}, {3.8773515641497498`*^9, 
   3.8773515737122173`*^9}, {3.877352800658642*^9, 3.877352801122967*^9}, {
   3.8773528378689003`*^9, 3.877352849600806*^9}, {3.87735289061014*^9, 
   3.877352891060618*^9}, {3.877530512275743*^9, 3.8775305262383537`*^9}, {
   3.87753110260773*^9, 3.8775311086007566`*^9}, {3.877614067382983*^9, 
   3.877614079750996*^9}, 3.879400258196865*^9, {3.924768030871813*^9, 
   3.924768162622357*^9}, {3.9247682258312197`*^9, 3.924768226074903*^9}, {
   3.924768273227687*^9, 3.9247682845717382`*^9}, 3.924813460380291*^9, {
   3.925180060324275*^9, 3.9251800930474987`*^9}, {3.925185466279001*^9, 
   3.9251855334705048`*^9}, {3.9251857514563437`*^9, 
   3.9251857533224497`*^9}, {3.925195384612173*^9, 3.925195556253847*^9}, 
   3.925197782390585*^9, 3.9251982414780416`*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"973432d9-8839-48ae-8d13-7ac9b451e315"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nTTLeadOrdExp", "[", 
    RowBox[{"S_", ",", "T_"}], "]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["T", "2"], " ", "\[Nu]", " ", 
        SuperscriptBox[
         RowBox[{"\[Tau]", "[", "S", "]"}], "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["uLeadOrd", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"S", ",", "T"}], "]"}]}], "+", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["wLeadOrd", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"S", ",", "T"}], "]"}], "2"]}], ")"}], " "}], 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"1", "-", " ", 
       SuperscriptBox["\[Nu]", "2"]}], ")"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.877077485266654*^9, 3.877077512618775*^9}, {
   3.87707764985079*^9, 3.87707777119314*^9}, {3.877077940731495*^9, 
   3.8770779427916517`*^9}, {3.8770820685160646`*^9, 
   3.8770820724413347`*^9}, {3.877151913837326*^9, 3.877151914370894*^9}, {
   3.877351369482993*^9, 3.877351372591715*^9}, {3.8773515641497498`*^9, 
   3.8773515737122173`*^9}, {3.877352800658642*^9, 3.877352801122967*^9}, {
   3.8773528378689003`*^9, 3.877352849600806*^9}, {3.87735289061014*^9, 
   3.877352891060618*^9}, {3.877530512275743*^9, 3.8775305262383537`*^9}, {
   3.87753110260773*^9, 3.8775311086007566`*^9}, {3.877614067382983*^9, 
   3.877614079750996*^9}, 3.879400258196865*^9, {3.924768030871813*^9, 
   3.924768162622357*^9}, {3.9247682258312197`*^9, 3.924768226074903*^9}, {
   3.924768273227687*^9, 3.9247682845717382`*^9}, 3.924813460380291*^9, {
   3.925180060324275*^9, 3.9251800930474987`*^9}, {3.925185466279001*^9, 
   3.9251855334705048`*^9}, {3.9251857514563437`*^9, 
   3.9251857533224497`*^9}, {3.925195384612173*^9, 3.9251955887555313`*^9}, 
   3.9251965988150454`*^9},
 CellLabel->"In[46]:=",ExpressionUUID->"8f2876bc-c069-436a-9d33-479b0d5cfa29"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"equLeadOrdAltForm", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"fTLeadOrd", "[", "S", "]"}]}], " ", 
      RowBox[{"\[Delta]uLeadOrd", "[", 
       RowBox[{"S", ",", "T"}], "]"}]}], "+", " ", 
     RowBox[{
      RowBox[{"nTTLeadOrd", "[", 
       RowBox[{"S", ",", "T"}], "]"}], 
      RowBox[{
       SuperscriptBox["\[Delta]uLeadOrd", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"S", ",", "T"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"check", " ", "expression", " ", "for", " ", "nTTLeadOrd"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"CheckSanity", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"equLeadOrdAltForm", " ", "-", " ", "equLeadOrd"}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nTTLeadOrd", "[", 
        RowBox[{"S", ",", "T"}], "]"}], "->", " ", 
       RowBox[{"nTTLeadOrdExp", "[", 
        RowBox[{"S", ",", "T"}], "]"}]}], "}"}]}], "]"}], "==", "0"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9251977755293417`*^9, 3.925197829220908*^9}, 
   3.925200964223125*^9, 3.9252011978161993`*^9, 3.925201295903932*^9},
 CellLabel->"In[47]:=",ExpressionUUID->"6ed79163-584c-4dc8-897d-0ec60288006e"],

Cell[CellGroupData[{

Cell["Calculation of differential equation for uLeadOrd", "Subsubsection",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
  3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
  3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, {
  3.925203069604192*^9, 
  3.925203157716688*^9}},ExpressionUUID->"971ff771-382c-4507-b3ab-\
f10b9baef11e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Integral]", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       RowBox[{"1", "/", "2"}]], 
      RowBox[{"-", "fTLeadOrd\[Delta]uLeadOrd"}]}], "Text"], 
    StyleBox["+", "Text"], 
    RowBox[{"nTTLeadOrd", 
     StyleBox[" ", "Text"], 
     StyleBox[
      SubscriptBox["\[Delta]uLeadOrd", 
       RowBox[{",", "T"}]], "Text"], 
     StyleBox["dT", "Text"]}]}], 
   StyleBox["=", "Text"], 
   StyleBox["0", "Text"]}], 
  StyleBox[";", "Text"]}], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Integral]", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       RowBox[{"1", "/", "2"}]], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"fTLeadOrd", "+", 
          SubscriptBox[
           StyleBox[
            RowBox[{"nTT", 
             StyleBox["LeadOrd", "Text"]}]], 
           RowBox[{",", "T"}]]}], ")"}]}], "\[Delta]uLeadOrd", " ", "dT"}]}], 
     "+", 
     SuperscriptBox[
      SubscriptBox[
       RowBox[{"[", 
        RowBox[{
         StyleBox[
          RowBox[{"nTT", 
           StyleBox["LeadOrd", "Text"]}]], 
         StyleBox[" ", "Text"], 
         StyleBox[
          RowBox[{"\[Delta]u", 
           StyleBox["LeadOrd", "Text"]}]]}], "]"}], 
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}]], 
      RowBox[{"T", "=", 
       RowBox[{"1", "/", "2"}]}]]}], "=", "0"}], ";"}], "Text"], "\n", 
 StyleBox[
  RowBox[{
  "we", " ", "get", " ", "natural", " ", "boundary", " ", "conditions", " ", 
   "as"}], "Text"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"nTTLeadOrd", "[", 
     RowBox[{"S", ",", 
      RowBox[{
       RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}], "]"}], "=", "0"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
   "and", " ", "the", " ", "differential", " ", "equation", " ", "as"}]}], 
  "Text"], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fTLeadOrd", 
    StyleBox["[", "Text"], 
    StyleBox["S", "Text"], 
    StyleBox["]", "Text"]}], 
   StyleBox["+", "Text"], 
   StyleBox[
    SubscriptBox[
     RowBox[{
      StyleBox[
       RowBox[{"nTT", 
        StyleBox["LeadOrd", "Text"]}]], "[", 
      RowBox[{"S", ",", "T"}], "]"}], 
     RowBox[{",", "T"}]], "Text"]}], 
  StyleBox["=", "Text"], 
  StyleBox["0", "Text"]}], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{"on", " ", "integrating", " ", "along", " ", "T"}], ",", 
   RowBox[{"we", " ", "get"}]}], "Text"], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fTLeadOrd", 
     StyleBox["[", "Text"], 
     StyleBox["S", "Text"], 
     StyleBox["]", "Text"]}], 
    StyleBox["+", "Text"], 
    RowBox[{"nTTLeadOrd", 
     StyleBox["[", "Text"], 
     StyleBox[
      RowBox[{"S", ",", "T"}], "Text"], 
     StyleBox["]", "Text"]}], 
    StyleBox["+", "Text"], 
    StyleBox[
     RowBox[{"cuLeadOrd", "[", "S", "]"}], "Text"]}], 
   StyleBox["=", "Text"], 
   StyleBox["0", "Text"]}], 
  StyleBox[";", "Text"]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{"where", " ", "cuLeadOrd"}], "Text"], 
  StyleBox["=", "Text"], 
  RowBox[{
   RowBox[{
    StyleBox["constant", "Text"], 
    StyleBox[" ", "Text"], 
    StyleBox["of", "Text"], 
    StyleBox[" ", "Text"], 
    RowBox[{
     StyleBox["integration", "Text"], 
     StyleBox[".", "Text"], "\n", "At"}], " ", "T"}], 
   StyleBox["=", "Text"], 
   StyleBox[
    RowBox[{
     RowBox[{"\[PlusMinus]", "1"}], "/", "2"}], "Text"]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fTLeadOrd", 
     StyleBox[
      FractionBox["1", "2"], "Text"]}], 
    StyleBox["+", "Text"], 
    StyleBox[
     RowBox[{"nTTLeadOrd", "[", 
      RowBox[{"S", ",", 
       FractionBox["1", "2"]}], "]"}], "Text"], 
    StyleBox["+", "Text"], 
    StyleBox["cuLeadOrd", "Text"]}], 
   StyleBox["=", "Text"], 
   StyleBox["0", "Text"]}], 
  StyleBox[";", "Text"]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "fTLeadOrd"}], 
     StyleBox[
      FractionBox["1", "2"], "Text"]}], 
    StyleBox["+", "Text"], 
    StyleBox[
     RowBox[{"nTTLeadOrd", "[", 
      RowBox[{"S", ",", 
       RowBox[{"-", 
        FractionBox["1", "2"]}]}], "]"}], "Text"], 
    StyleBox["+", "Text"], 
    StyleBox["cuLeadOrd", "Text"]}], 
   StyleBox["=", "Text"], 
   StyleBox["0", "Text"]}], 
  StyleBox[";", "Text"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
   "using", " ", "the", " ", "natural", " ", "boundry", " ", "conditions"}], 
   ",", 
   RowBox[{"it", " ", "boils", " ", "to"}]}], "Text"], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fTLeadOrd", 
     StyleBox[
      RowBox[{"(", 
       FractionBox["1", "2"], ")"}], "Text"]}], 
    StyleBox["+", "Text"], 
    StyleBox["cuLeadOrd", "Text"]}], 
   StyleBox["=", "Text"], 
   StyleBox["0", "Text"]}], 
  StyleBox[";", "Text"]}], "\n", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fTLeadOrd", 
      RowBox[{"(", 
       RowBox[{"-", 
        FractionBox["1", "2"]}], ")"}]}], "+", "cuLeadOrd"}], "=", "0"}], 
   ";"}], "Text"], "\n", 
 StyleBox[
  RowBox[{"which", " ", "gives", " ", "us"}], "Text"], "\[IndentingNewLine]", 

 RowBox[{
  StyleBox[" ", "Text"], 
  StyleBox[
   RowBox[{
    RowBox[{"fTLeadOrd", "=", 
     RowBox[{"cuLeadOrd", "=", "0"}]}], ";"}], 
   "Text"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
  "and", " ", "therefore", " ", "the", " ", "differential", " ", "equation"}],
   "Text"], "\n", 
 RowBox[{
  RowBox[{"nTTLeadOrd", "[", 
   RowBox[{"S", ",", "T"}], "]"}], 
  StyleBox["=", "Text"], 
  StyleBox["0", "Text"]}], "\n", 
 RowBox[{
  RowBox[{"We", " ", "will", " ", "see", " ", "that", " ", 
   StyleBox[
    RowBox[{"i", 
     StyleBox["t", "Text"]}]], 
   StyleBox[" ", "Text"], 
   StyleBox["is", "Text"], 
   StyleBox[" ", "Text"], 
   StyleBox["a", "Text"], 
   StyleBox[" ", "Text"], 
   StyleBox["first", "Text"], 
   StyleBox[" ", "Text"], 
   StyleBox["order", "Text"], 
   StyleBox[" ", "Text"], 
   StyleBox["differential", "Text"], 
   StyleBox[" ", "Text"], 
   StyleBox["equation", "Text"], 
   StyleBox[" ", "Text"], 
   StyleBox["in", "Text"], 
   StyleBox[" ", "Text"], 
   StyleBox[
    RowBox[{"T", ".", " ", "Once"}], "Text"], 
   StyleBox[" ", "Text"], 
   StyleBox["wLeadOrd", "Text"], 
   StyleBox[" ", "Text"], 
   StyleBox["is", "Text"], 
   StyleBox[" ", "Text"], 
   StyleBox["known", "Text"]}], 
  StyleBox[",", "Text"], 
  StyleBox[
   RowBox[{
    RowBox[{
    "we", "can", "solve", "it", "in", "conjuction", "with", "the", "integral",
      "constraint", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Integral]", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       RowBox[{"1", "/", "2"}]], 
      RowBox[{
       RowBox[{"uLeadOrd", "[", 
        RowBox[{"S", ",", "T"}], "]"}], "dT"}]}]}], "=", "0"}], 
   "Text"]}]}], "Text",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
  3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
  3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, {
  3.925203069604192*^9, 3.9252032927039137`*^9}, {3.9252033229791727`*^9, 
  3.925203380337694*^9}, {3.925203411210123*^9, 3.925203683440539*^9}, {
  3.925203732862488*^9, 3.925203739838388*^9}, {3.925346207219842*^9, 
  3.925346240762721*^9}, {3.925346338830769*^9, 3.925346348975444*^9}, {
  3.9269932840510187`*^9, 
  3.926993288859006*^9}},ExpressionUUID->"2bbf5994-0ea7-4c4a-aa8d-\
7be13187f410"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
   "We", " ", "have", " ", "differential", " ", "equation", " ", "as", " ", 
    RowBox[{"nTTLeadOrd", "[", 
     RowBox[{"S", ",", "T"}], "]"}]}], "=", 
   RowBox[{"0.", " ", "We", " ", "collect", " ", 
    SubscriptBox["uLeadOrd", 
     RowBox[{",", "T"}]], " ", "from", " ", "it", " ", "as"}]}], 
  TraditionalForm]], "Text",
 CellChangeTimes->{{3.925267064696813*^9, 
  3.925267183555626*^9}},ExpressionUUID->"6dd6b2e4-e9a9-44af-9a25-\
21c43e35e803"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Differential", " ", "equation", " ", 
     RowBox[{"n0TT", "[", "T", "]"}]}], " ", "=", " ", 
    RowBox[{"0.", " ", "We", " ", "collect", " ", 
     SubscriptBox["yu", 
      RowBox[{",", "T"}]], " ", "from", " ", "it", " ", "as"}]}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"uLeadOrdDT", "=", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["T", "2"], " ", "\[Nu]", " ", 
         SuperscriptBox[
          RowBox[{"\[Tau]", "[", "S", "]"}], "2"]}], "+", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["wLeadOrd", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"S", ",", "T"}], "]"}], "2"]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CheckSanity", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"nTTLeadOrdExp", "[", 
         RowBox[{"S", ",", "T"}], "]"}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["uLeadOrd", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"S", ",", "T"}], "]"}], "->", " ", "uLeadOrdDT"}], "}"}]}], 
      "]"}], "==", "0"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.925267114045911*^9, 3.925267122924171*^9}, {
   3.9252673031724567`*^9, 3.9252673352293997`*^9}, 3.925335651178288*^9, 
   3.925337444028304*^9, 3.925383523526167*^9, 
   3.926993290083877*^9},ExpressionUUID->"3e4d888a-8982-42c0-9224-\
6f41a44ee906"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculation of differential equation for wLeadOrd", "Subsubsection",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, {
   3.925203069604192*^9, 3.925203157716688*^9}, {3.925337542083267*^9, 
   3.9253375423158913`*^9}, 
   3.9253376086926193`*^9},ExpressionUUID->"5426e3f4-b444-402c-b421-\
3aba719a8491"],

Cell[BoxData[{
 RowBox[{"eqwLeadOrd", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"eqToSolveForLeadOrdDis", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]uLeadOrd", "->", " ", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}], ",", 
         RowBox[{"\[Delta]vLeadOrd", "->", " ", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}]}], "}"}]}], " ", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["vLeadOrd", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"S", ",", "T"}], "]"}], "->", " ", "vLeadOrdDT"}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["uLeadOrd", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"S", ",", "T"}], "]"}], "->", " ", "uLeadOrdDT"}]}], 
       "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Delta]wLeadOrd", "[", 
       RowBox[{"S", ",", "T"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Delta]wLeadOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Delta]wLeadOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
    "FullSimplify"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"sanity", " ", 
     RowBox[{"check", ":", " ", 
      RowBox[{
      "Have", " ", "included", " ", "all", " ", "the", " ", "terms", " ", 
       "of", " ", "variation", " ", "of", " ", "potential", " ", "in", " ", 
       "the", " ", "three", " ", "equations", " ", "equLeadOrd"}]}]}], ",", 
    " ", "eqvLeadOrd", ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"eqwLeadOrd", "?"}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, {
   3.925203069604192*^9, 3.925203157716688*^9}, {3.925337542083267*^9, 
   3.9253375423158913`*^9}, {3.9253376100081463`*^9, 
   3.9253376759237347`*^9}, {3.925338511854681*^9, 3.925338517013645*^9}, 
   3.925346002717574*^9, 3.925379828033012*^9, {3.925379874688241*^9, 
   3.925379875125773*^9}, 3.9253800288557673`*^9, {3.925380098223637*^9, 
   3.925380098502351*^9}, {3.925380186753201*^9, 3.9253802162293777`*^9}, {
   3.9253803107738132`*^9, 3.925380340569833*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"93b93a42-310d-4449-ac67-e3ea46a5df87"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"doSanityCheck", ",", 
   RowBox[{
    RowBox[{"CheckSanity", "[", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "equLeadOrd", "+", "eqvLeadOrd", "+", "eqwLeadOrd", "-", 
          "eqToSolveForLeadOrdDis"}], ")"}], " ", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["vLeadOrd", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"S", ",", "T"}], "]"}], "->", " ", "vLeadOrdDT"}], ",", 
          RowBox[{
           RowBox[{
            SuperscriptBox["uLeadOrd", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"S", ",", "T"}], "]"}], "->", " ", "uLeadOrdDT"}]}], 
         "}"}]}], "]"}], "==", "0"}], "]"}], ";"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, {
   3.925203069604192*^9, 3.925203157716688*^9}, {3.925337542083267*^9, 
   3.9253375423158913`*^9}, {3.9253376100081463`*^9, 
   3.9253376759237347`*^9}, {3.925338511854681*^9, 3.925338517013645*^9}, 
   3.925346002717574*^9, 3.925379828033012*^9, {3.925379874688241*^9, 
   3.925379875125773*^9}, 3.9253800288557673`*^9, {3.925380098223637*^9, 
   3.925380098502351*^9}, {3.925380186753201*^9, 3.9253802162293777`*^9}, {
   3.9253803107738132`*^9, 3.925380340569833*^9}, {3.925383982399096*^9, 
   3.9253839958102093`*^9}, {3.9253840325068083`*^9, 3.9253840976584177`*^9}},
 
 CellLabel->"In[52]:=",ExpressionUUID->"cd7572d5-4705-4afa-983d-38cd7e77fa47"],

Cell[BoxData[{
 RowBox[{
  SuperscriptBox[
   SubscriptBox["\[Integral]", 
    RowBox[{
     RowBox[{"-", "1"}], "/", "2"}]], 
   RowBox[{"1", "/", "2"}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "fNLeadOrd"}], "-", 
        RowBox[{"gNLeadOrd", " ", "T"}]}], ")"}], "\[Delta]wLeadOrd"}], "+", 
     RowBox[{
      SubscriptBox["wLeadOrd", 
       RowBox[{",", "TT"}]], 
      SubscriptBox["\[Delta]wLeadOrd", 
       RowBox[{",", "TT"}]]}]}], ")"}], "dT"}]}], "\[IndentingNewLine]", 
 RowBox[{"we", " ", "can", " ", "write", 
  RowBox[{
   SuperscriptBox[
    SubscriptBox["\[Integral]", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]], 
    RowBox[{"1", "/", "2"}]], 
   RowBox[{
    SubscriptBox["wLeadOrd", 
     RowBox[{",", "TT"}]], 
    SubscriptBox["\[Delta]wLeadOrd", 
     RowBox[{",", "TT"}]], "dT", " ", "as"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Integral]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]], 
     RowBox[{"1", "/", "2"}]], 
    RowBox[{
     SubscriptBox["wLeadOrd", 
      RowBox[{",", "TT"}]], 
     SubscriptBox["\[Delta]wLeadOrd", 
      RowBox[{",", "TT"}]], "dT"}]}], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["wLeadOrd", 
          RowBox[{",", "TT"}]], 
         SubscriptBox["\[Delta]wLeadOrd", 
          RowBox[{",", "T"}]]}], ")"}], 
       RowBox[{",", "T"}]], "dT"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      SubscriptBox["wLeadOrd", 
       RowBox[{",", "TTT"}]], 
      SubscriptBox["\[Delta]wLeadOrd", 
       RowBox[{",", "T"}]], "dT"}]}]}]}], ",", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Integral]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]], 
     RowBox[{"1", "/", "2"}]], 
    RowBox[{
     SubscriptBox["wLeadOrd", 
      RowBox[{",", "TT"}]], 
     SubscriptBox["\[Delta]wLeadOrd", 
      RowBox[{",", "TT"}]], "dT"}]}], "=", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox[
      RowBox[{"[", 
       RowBox[{
        SubscriptBox["wLeadOrd", 
         RowBox[{",", "TT"}]], 
        SubscriptBox["\[Delta]wLeadOrd", 
         RowBox[{",", "T"}]]}], "]"}], 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}]], 
     RowBox[{"T", "=", 
      RowBox[{"1", "/", "2"}]}]], "-", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      SubscriptBox["wLeadOrd", 
       RowBox[{",", "TTT"}]], 
      SubscriptBox["\[Delta]wLeadOrd", 
       RowBox[{",", "T"}]], "dT"}]}]}]}], ",", 
  RowBox[{
   RowBox[{
   "this", " ", "gives", " ", "first", " ", "natural", " ", 
    "boundarycondition", " ", "as", " ", 
    RowBox[{
     SubscriptBox["wLeadOrd", 
      RowBox[{",", "TT"}]], "[", 
     RowBox[{"S", ",", 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}]}], "]"}]}], "=", "0"}], 
  ",", 
  RowBox[{
   RowBox[{"on", " ", "setting", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      SubscriptBox["wLeadOrd", 
       RowBox[{",", "TT"}]], 
      SubscriptBox["\[Delta]wLeadOrd", 
       RowBox[{",", "TT"}]], "dT"}]}]}], "=", 
   RowBox[{"-", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      SubscriptBox["wLeadOrd", 
       RowBox[{",", "TTT"}]], 
      SubscriptBox["\[Delta]wLeadOrd", 
       RowBox[{",", "T"}]], "dT", " ", "in", " ", "the", " ", "initial", " ", 
      "equation", " ", "above", " ", "we", " ", "get"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Integral]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]], 
     RowBox[{"1", "/", "2"}]], 
    RowBox[{
     SubscriptBox["wLeadOrd", 
      RowBox[{",", "TT"}]], 
     SubscriptBox["\[Delta]wLeadOrd", 
      RowBox[{",", "TT"}]], "dT"}]}], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      SubscriptBox["wLeadOrd", 
       RowBox[{",", "TTTT"}]], "\[Delta]wLeadOrd", " ", "dT"}]}], "-", 
    SuperscriptBox[
     SubscriptBox[
      RowBox[{"[", 
       RowBox[{
        SubscriptBox["wLeadOrd", 
         RowBox[{",", "TTT"}]], "\[Delta]wLeadOrd"}], "]"}], 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}]], 
     RowBox[{"T", "=", 
      RowBox[{"1", "/", "2"}]}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "this", " ", "gives", " ", "the", " ", "second", " ", "natural", " ", 
    "boundary", " ", "condition", " ", "as", " ", 
    SubscriptBox["wLeadOrd", 
     RowBox[{",", "TTT"}]]}], "=", 
   RowBox[{
    RowBox[{"0", "at", "T"}], "=", 
    RowBox[{
     RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}]}], ",", 
  RowBox[{
  "on", "using", "this", "equation", "intheinitial", " ", "equation", " ", 
   "we", " ", "get"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox["wLeadOrd", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "4"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"S", ",", "T"}], "]"}], "=", 
   RowBox[{
    RowBox[{"fNLeadOrd", "[", "S", "]"}], "+", 
    RowBox[{"T", " ", 
     RowBox[{"gNLeadOrd", "[", "S", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "intergrating", " ", "the", " ", "above", " ", "equation", " ", "along", 
    " ", "T", " ", "from"}], "-", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", "to", " ", 
    RowBox[{"1", "/", "2"}], " ", "and", " ", "using", " ", "the", " ", 
    "first", " ", "natural", " ", "boundarycondition"}]}], ",", 
  RowBox[{
   RowBox[{"we", " ", "get", " ", "fNLeadOrd"}], "=", "0"}]}], "\n", 
 RowBox[{"we", " ", "multiply", " ", "the", " ", "differential", " ", 
  "equation", " ", "by", " ", "T"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"T", " ", 
    SubscriptBox["wLeadOrd", 
     RowBox[{",", "TTTT"}]]}], "=", 
   RowBox[{
    SuperscriptBox["T", "2"], "gNLeadOrd"}]}], ",", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{"T", " ", 
       SubscriptBox["wLeadOrd", 
        RowBox[{",", "TTT"}]]}], ")"}], 
     RowBox[{",", "T"}]], "-", 
    SubscriptBox["wLeadOrd", 
     RowBox[{",", "TTT"}]]}], "=", 
   RowBox[{
    SuperscriptBox["T", "2"], "gNLeadOrd"}]}], ",", 
  RowBox[{
   RowBox[{
   "on", " ", "integrating", " ", "the", " ", "aboveequation", " ", "along", 
    " ", "T", " ", "from"}], "-", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "to", " ", 
    RowBox[{"1", "/", "2"}], "and", " ", "using", " ", "the", " ", "first", 
    " ", "and", " ", "second", " ", "natural", " ", "boundaryconditions"}]}], 
  ",", 
  RowBox[{
   RowBox[{"we", " ", "get", " ", "gNLeadOrd"}], "=", "0."}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Therefore", " ", "we", " ", "have", " ", "differential", " ", 
    RowBox[{"equation", ":", 
     SubscriptBox["wLeadOrd", 
      RowBox[{",", "TTTT"}]]}]}], "=", "0"}], ",", 
  RowBox[{
   RowBox[{"boundaryconditions", ":", "\[IndentingNewLine]", 
    SubscriptBox["wLeadOrd", 
     RowBox[{",", "TT"}]]}], "=", 
   RowBox[{
    RowBox[{"0", "and", " ", 
     SubscriptBox["wLeadOrd", 
      RowBox[{",", "TTT"}]]}], "=", 
    RowBox[{
     RowBox[{"0", " ", "at", " ", "T"}], "=", 
     RowBox[{
      RowBox[{"\[PlusMinus]", "1"}], "/", 
      "2"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"and", " ", "two", " ", "integral", " ", "constrants", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"wLeadOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}], ",", 
        RowBox[{"T", " ", 
         RowBox[{"wLeadOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}]}]}], ")"}], "dT"}]}]}], "=", 
   RowBox[{"(", 
    RowBox[{"0", ",", "0"}], ")"}]}], ",", "\[IndentingNewLine]", 
  "whichgives"}], "\n", 
 RowBox[{
  RowBox[{"wLeadOrd", "[", 
   RowBox[{"S", ",", "T"}], "]"}], "=", "0"}]}], "Text",
 CellChangeTimes->{{3.925267114045911*^9, 3.925267122924171*^9}, {
   3.9252673031724567`*^9, 3.9252673352293997`*^9}, 3.925335651178288*^9, {
   3.925337444028304*^9, 3.925337524878137*^9}, {3.9253375572481527`*^9, 
   3.925337574565435*^9}, {3.925337694292242*^9, 3.925337764109044*^9}, {
   3.9253378128378057`*^9, 3.925337921179509*^9}, {3.925337967537364*^9, 
   3.925338104776945*^9}, {3.925338140995997*^9, 3.925338231622411*^9}, {
   3.925338280734405*^9, 3.925338444199893*^9}, {3.9253385885415173`*^9, 
   3.925338710567115*^9}, {3.925345872863785*^9, 3.925345988852437*^9}, {
   3.925346077213035*^9, 3.9253460824956017`*^9}, 3.9253468566456203`*^9, {
   3.925348563804772*^9, 3.925348567344561*^9}, {3.925348796572707*^9, 
   3.9253488060409737`*^9}, {3.9253491261613417`*^9, 3.925349145467285*^9}, 
   3.926993291475108*^9},ExpressionUUID->"dde6dae3-198a-4e39-861f-\
6ebff4c666b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "solution", " ", "for", " ", "w", " ", "at", " ", "leading", " ", 
    "order"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"wLeadOrdSol", "[", 
    RowBox[{"S_", ",", "T_"}], "]"}], " ", "=", " ", "0"}]}]], "Input",
 CellChangeTimes->{{3.878974306438919*^9, 3.878974312556782*^9}, {
  3.878974358819706*^9, 3.8789744593825006`*^9}, {3.878974563806904*^9, 
  3.878974567687158*^9}, {3.8794039223804483`*^9, 3.879403948330296*^9}, {
  3.924770127577766*^9, 3.924770128739019*^9}, {3.924770226931799*^9, 
  3.924770228114643*^9}, {3.9253491815802393`*^9, 3.925349198073265*^9}, {
  3.925349707952524*^9, 3.925349712649398*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"3ea61ab0-500d-4f58-91d0-e5c9dd6f9387"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "we", " ", "will", " ", "insert", " ", "this", " ", "wLeadOrd", " ", "in", 
   " ", "to", " ", "calculate", " ", "uLeadOrd", " ", "and", " ", 
   "vLeadOrd"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.925349434493301*^9, 3.925349503228904*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"619a8baa-ef3b-4846-a3b4-bf4c7c15ea8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "constant", " ", "of", " ", "integration", " ", "we", " ", "get", " ", 
     "on", " ", "integrating", " ", "uLeadOrdDT", " ", "along", " ", "T", " ",
      "from"}], " ", "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "to", " ", 
     RowBox[{"1", "/", "2"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"cuLeadordExp", "=", 
    RowBox[{
     RowBox[{"SolveValues", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"Integrate", "[", 
             RowBox[{
              RowBox[{"uLeadOrdDT", " ", "/.", 
               RowBox[{"{", 
                RowBox[{"wLeadOrd", "->", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"wLeadOrdSol", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], "}"}]}],
               ",", 
              RowBox[{"{", 
               RowBox[{"T", ",", "0", ",", "T"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"T", ",", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", 
              RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], " ", "+", " ", 
          "cu"}], " ", ")"}], "==", "0"}], ",", " ", "cu"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "solution", " ", "of", " ", "u", " ", "at", " ", "leading", " ", 
     "order"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uLeadOrdSol", "[", 
     RowBox[{"S_", ",", "T_"}], "]"}], " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"uLeadOrdDT", " ", "/.", 
          RowBox[{"{", 
           RowBox[{"wLeadOrd", "->", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"wLeadOrdSol", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"T", ",", "0", ",", "T"}], "}"}]}], "]"}], " ", "+", " ", 
       "cuLeadordExp"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Tau]", "[", "S", "]"}], ",", "\[Nu]"}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.925349434493301*^9, 3.9253496130666113`*^9}, {
   3.925349672587206*^9, 3.925349703435422*^9}, {3.925349747102107*^9, 
   3.925349753431032*^9}, 
   3.9269932926460123`*^9},ExpressionUUID->"023bbe84-81a6-4d48-990d-\
80d0d6ea3c70"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "constant", " ", "of", " ", "integration", " ", "we", " ", "get", " ", 
     "on", " ", "integrating", " ", "vLeadOrdDT", " ", "along", " ", "T", " ",
      "from"}], " ", "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "to", " ", 
     RowBox[{"1", "/", "2"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cvLeadOrdExp", "=", 
     RowBox[{
      RowBox[{"SolveValues", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"Integrate", "[", 
              RowBox[{
               RowBox[{"vLeadOrdDT", " ", "/.", 
                RowBox[{"{", 
                 RowBox[{"wLeadOrd", "->", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"wLeadOrdSol", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], "}"}]}],
                ",", 
               RowBox[{"{", 
                RowBox[{"T", ",", "0", ",", "T"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], ",", 
               RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], " ", "+", " ", 
           "cv"}], " ", ")"}], "==", "0"}], ",", " ", "cv"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vLeadOrdSol", "[", 
     RowBox[{"S_", ",", "T_"}], "]"}], " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"vLeadOrdDT", " ", "/.", 
          RowBox[{"{", 
           RowBox[{"wLeadOrd", "->", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"wLeadOrdSol", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"T", ",", "0", ",", "T"}], "}"}]}], "]"}], " ", "+", " ", 
       "cvLeadOrdExp"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Tau]", "[", "S", "]"}], ",", "\[Nu]"}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.925349768965907*^9, 3.9253498350066357`*^9}, {
   3.9253498708919163`*^9, 3.925349873533943*^9}, 
   3.926993293631117*^9},ExpressionUUID->"eddf2c3b-e194-4536-8d9c-\
0ea2af777f41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Is", " ", "nTTLeadOrd"}], " ", "=", " ", 
    RowBox[{"nSTLeadOrd", " ", "=", " ", "0"}]}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{"doSanityCheck", ",", 
    RowBox[{
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"nTTLeadOrdExp", "[", 
          RowBox[{"S", ",", "T"}], "]"}], "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vLeadOrd", "->", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"vLeadOrdSol", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
           RowBox[{"uLeadOrd", "->", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"uLeadOrdSol", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
           RowBox[{"wLeadOrd", "->", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"wLeadOrdSol", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}]}], "}"}]}], 
        "]"}], "==", "0"}], "]"}], ";", 
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"nSTLeadOrdExp", "[", 
          RowBox[{"S", ",", "T"}], "]"}], "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vLeadOrd", "->", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"vLeadOrdSol", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
           RowBox[{"uLeadOrd", "->", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"uLeadOrdSol", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
           RowBox[{"wLeadOrd", "->", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"wLeadOrdSol", "[", 
               RowBox[{"#1", ",", "#"}], "]"}], "&"}], ")"}]}]}], "}"}]}], 
        "]"}], "==", "0"}], "]"}], ";"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.925349768965907*^9, 3.9253498350066357`*^9}, {
  3.9253498708919163`*^9, 3.9253500326242523`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"fde2bd83-fe79-42a5-9129-bf47c5705e40"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Leading order strain energy ", "Subsubsection",
 CellChangeTimes->{{3.925349768965907*^9, 3.9253498350066357`*^9}, {
  3.9253498708919163`*^9, 
  3.925350054730098*^9}},ExpressionUUID->"2917c371-45df-4e12-b2a4-\
502ac99290a4"],

Cell[BoxData[
 RowBox[{"leadOrdEnr", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"strDenSlowVariationCoeffList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vLeadOrd", "->", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"vLeadOrdSol", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
          RowBox[{"uLeadOrd", "->", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"uLeadOrdSol", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
          RowBox[{"wLeadOrd", "->", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"wLeadOrdSol", "[", 
              RowBox[{"#1", ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\[CurlyEpsilon]p", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[CurlyEpsilon]pfnExp", "[", "#", "]"}], "&"}], 
            ")"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"T", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], ",", 
         RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ")"}], ",", " ", 
    RowBox[{"\[Tau]", "[", "S", "]"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{"#", ",", "\[CurlyEpsilon]", ",", "Simplify"}], "]"}], "&"}], 
     ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.924771215602765*^9, 3.924771221577731*^9}, {
   3.924771273117991*^9, 3.9247712928236313`*^9}, {3.92477136780319*^9, 
   3.9247714425183487`*^9}, {3.9247715399629593`*^9, 3.924771561013556*^9}, 
   3.924898877202114*^9, {3.925350069619998*^9, 3.925350100344357*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"23d2c3ae-a7cb-4f7c-9534-096080c852af"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["First order strain energy vanishes ", "Section",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.9253502212294292`*^9, 
   3.925350257339862*^9}},ExpressionUUID->"41ce01d1-9562-4172-a16c-\
e01505d3b931"],

Cell[BoxData[
 RowBox[{"CheckSanity", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"strDenSlowVariationCoeffList", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vLeadOrd", "->", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vLeadOrdSol", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
       RowBox[{"uLeadOrd", "->", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"uLeadOrdSol", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
       RowBox[{"wLeadOrd", "->", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wLeadOrdSol", "[", 
           RowBox[{"#1", ",", "#"}], "]"}], "&"}], ")"}]}]}], "}"}]}], "]"}], 
   "==", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.9253502212294292`*^9, 3.925350301902133*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"8feca4e0-499b-4c3a-9303-12242b8fc9c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Solving for first order displacements from strain energy at second order \
\>", "Section",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.925350329097713*^9, 3.925350336352416*^9}, {
   3.9253512081158667`*^9, 
   3.925351209295643*^9}},ExpressionUUID->"e9cb865d-3067-4582-904e-\
15851ef7508d"],

Cell[CellGroupData[{

Cell["Second order terms", "Subsubsection",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.925350329097713*^9, 3.925350336352416*^9}, {
   3.9253512081158667`*^9, 3.925351267770705*^9}, {3.9253530081567583`*^9, 
   3.925353035920971*^9}, 3.925364322344171*^9, {3.9253644642611513`*^9, 
   3.925364472420994*^9}, {3.9253666381306133`*^9, 3.9253666384936533`*^9}, {
   3.925366692406859*^9, 3.925366692811536*^9}, {3.925366851047394*^9, 
   3.9253668682754374`*^9}},ExpressionUUID->"d42e8308-dcf3-4aa0-a41d-\
474c3c846158"],

Cell[BoxData[
 RowBox[{
  RowBox[{"secondOrdStrainEnergyAllTerms", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"strDenSlowVariationCoeffList", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vLeadOrd", "->", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vLeadOrdSol", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
       RowBox[{"uLeadOrd", "->", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"uLeadOrdSol", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
       RowBox[{"wLeadOrd", "->", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wLeadOrdSol", "[", 
           RowBox[{"#1", ",", "#"}], "]"}], "&"}], ")"}]}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.925350329097713*^9, 3.925350336352416*^9}, {
   3.9253512081158667`*^9, 3.925351267770705*^9}, {3.9253530081567583`*^9, 
   3.925353035920971*^9}, 3.925364322344171*^9, {3.9253644642611513`*^9, 
   3.925364472420994*^9}, {3.9253666381306133`*^9, 3.9253666384936533`*^9}, {
   3.925366692406859*^9, 3.925366692811536*^9}, 3.925366851047394*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"0a40c4b3-eb51-47ba-8a5c-5cf8142896e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"secondOrdEnrExceptBoundaryTerm", "=", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"secondOrdStrainEnergyAllTerms", "-", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"secondOrdStrainEnergyAllTerms", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SuperscriptBox["wFirstOrd", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"S", ",", "T"}], "]"}], ",", 
             RowBox[{
              SuperscriptBox["wFirstOrd", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"S", ",", "T"}], "]"}], ",", 
             RowBox[{
              SuperscriptBox["vFirstOrd", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"S", ",", "T"}], "]"}]}], "}"}]}], "]"}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox["wFirstOrd", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"S", ",", "T"}], "]"}], ",", 
          RowBox[{
           SuperscriptBox["wFirstOrd", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"S", ",", "T"}], "]"}], ",", 
          RowBox[{
           SuperscriptBox["vFirstOrd", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"S", ",", "T"}], "]"}]}], "}"}]}]}], "]"}], "-", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{"Coefficient", "[", 
           RowBox[{"secondOrdStrainEnergyAllTerms", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SuperscriptBox["wFirstOrd", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"S", ",", "T"}], "]"}], ",", 
              RowBox[{
               SuperscriptBox["wFirstOrd", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "1"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"S", ",", "T"}], "]"}], ",", 
              RowBox[{
               SuperscriptBox["vFirstOrd", 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"1", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"S", ",", "T"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
         "S"}], "]"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wFirstOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}], ",", 
        RowBox[{
         SuperscriptBox["wFirstOrd", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"S", ",", "T"}], "]"}], ",", 
        RowBox[{"vFirstOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}]}], "}"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"secondOrdBoundaryTerms", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"secondOrdStrainEnergyAllTerms", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["wFirstOrd", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox["wFirstOrd", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox["vFirstOrd", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"S", ",", "T"}], "]"}]}], "}"}]}], "]"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"wFirstOrd", "[", 
       RowBox[{"S", ",", "T"}], "]"}], ",", 
      RowBox[{
       SuperscriptBox["wFirstOrd", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"S", ",", "T"}], "]"}], ",", 
      RowBox[{"vFirstOrd", "[", 
       RowBox[{"S", ",", "T"}], "]"}]}], "}"}]}]}], ";"}], "\n", 
 RowBox[{"CheckSanity", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"secondOrdEnrExceptBoundaryTerm", "+", 
     RowBox[{"D", "[", 
      RowBox[{"secondOrdBoundaryTerms", ",", "S"}], "]"}], "-", 
     "secondOrdStrainEnergyAllTerms"}], "]"}], "==", "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.925350329097713*^9, 3.925350336352416*^9}, {
   3.9253512081158667`*^9, 3.9253513494694033`*^9}, {3.925351393616753*^9, 
   3.925351428000167*^9}, 3.925352815670178*^9, 3.925352845829981*^9, {
   3.9253528806833153`*^9, 3.925352896274995*^9}, {3.925364118051174*^9, 
   3.925364125383419*^9}, 3.925366515841626*^9, {3.92536655129023*^9, 
   3.9253665654731197`*^9}, {3.925366612999741*^9, 3.9253666224655523`*^9}, {
   3.9253666608523417`*^9, 3.925366686684767*^9}, 3.9253667998553467`*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"bfbaf095-fe50-433a-af00-5aeba2ee755d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Potential to minimize", "Subsubsection",
 CellChangeTimes->{{3.92536681793567*^9, 
  3.925366821278873*^9}},ExpressionUUID->"0ac350b1-bd56-4188-93db-\
17402260308d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "omit", " ", "the", " ", "boundary", " ", "while", " ", 
    "solving", " ", "for", " ", "the", " ", "optimal", " ", "second", " ", 
    "order", " ", "displacements"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"secondOrdPotToMinimize", " ", "=", " ", 
    RowBox[{"secondOrdEnrExceptBoundaryTerm", " ", "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"fSSecondOrd", "[", "S", "]"}], " ", 
        RowBox[{"vFirstOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"fTSecondOrd", "[", "S", "]"}], " ", 
        RowBox[{"uFirstOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"fNSecondOrd", "[", "S", "]"}], 
        RowBox[{"wFirstOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"gNSecondOrd", "[", "S", "]"}], " ", "T", " ", 
        RowBox[{"wFirstOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}]}]}], ")"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.925350329097713*^9, 3.925350336352416*^9}, {
   3.9253512081158667`*^9, 3.9253513494694033`*^9}, {3.925351393616753*^9, 
   3.925351428000167*^9}, 3.925352815670178*^9, 3.925352845829981*^9, {
   3.9253528806833153`*^9, 3.925352896274995*^9}, {3.925364118051174*^9, 
   3.925364125383419*^9}, 3.925366515841626*^9, {3.92536655129023*^9, 
   3.9253665654731197`*^9}, {3.925366612999741*^9, 3.9253666224655523`*^9}, {
   3.9253666608523417`*^9, 3.925366686684767*^9}, {3.9253667998553467`*^9, 
   3.925366810879343*^9}, {3.9253668960596647`*^9, 3.9253668979974623`*^9}, 
   3.92563158648661*^9, 3.9256316592712584`*^9, {3.92563172364999*^9, 
   3.92563174989432*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"45dbadd9-afd7-4a26-8bb3-d9815dab8332"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"minimize", " ", "rules"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"repRulesFirstOrderDisPerturb", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"wFirstOrd", "->", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"wFirstOrd", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "+", " ", 
           RowBox[{"\[Eta]", " ", 
            RowBox[{"\[Delta]wFirstOrd", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}]}]}], ")"}], " ", "&"}], ")"}]}],
       ",", 
      RowBox[{"uFirstOrd", "->", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"uFirstOrd", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "+", " ", 
           RowBox[{"\[Eta]", " ", 
            RowBox[{"\[Delta]uFirstOrd", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}]}]}], ")"}], " ", "&"}], ")"}]}],
       ",", " ", 
      RowBox[{"vFirstOrd", "->", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"vFirstOrd", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "+", " ", 
           RowBox[{"\[Eta]", " ", 
            RowBox[{"\[Delta]vFirstOrd", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}]}]}], ")"}], " ", "&"}], 
        ")"}]}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.925350329097713*^9, 3.925350336352416*^9}, {
   3.9253512081158667`*^9, 3.9253513494694033`*^9}, {3.925351393616753*^9, 
   3.925351428000167*^9}, 3.925352815670178*^9, 3.925352845829981*^9, {
   3.9253528806833153`*^9, 3.925352896274995*^9}, {3.925364118051174*^9, 
   3.925364125383419*^9}, 3.925366515841626*^9, {3.92536655129023*^9, 
   3.9253665654731197`*^9}, {3.925366612999741*^9, 3.9253666224655523`*^9}, {
   3.9253666608523417`*^9, 3.925366686684767*^9}, {3.9253667998553467`*^9, 
   3.925366810879343*^9}, {3.9253668960596647`*^9, 3.925366908007086*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"0b1bee6e-60f6-4d0c-8fbf-1d7c50c0c129"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"first", " ", "variation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"eqToSolveForFirstOrdDis", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
       "secondOrdPotToMinimize", "/.", "repRulesFirstOrderDisPerturb"}], " ", 
       ",", "\[Eta]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Eta]", "->", " ", "0"}], "}"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.925350329097713*^9, 3.925350336352416*^9}, {
   3.9253512081158667`*^9, 3.9253513494694033`*^9}, {3.925351393616753*^9, 
   3.925351428000167*^9}, 3.925352815670178*^9, 3.925352845829981*^9, {
   3.9253528806833153`*^9, 3.925352896274995*^9}, {3.925364118051174*^9, 
   3.925364125383419*^9}, 3.925366515841626*^9, {3.92536655129023*^9, 
   3.9253665654731197`*^9}, {3.925366612999741*^9, 3.9253666224655523`*^9}, {
   3.9253666608523417`*^9, 3.925366686684767*^9}, {3.9253667998553467`*^9, 
   3.925366810879343*^9}, {3.9253668960596647`*^9, 3.925366925125349*^9}, 
   3.925367055450906*^9, 3.925367100760113*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"6a2ae325-f283-483c-82d6-fdd873aa7fba"]
}, Closed]],

Cell[CellGroupData[{

Cell["Terms with \[Delta]vFirstOrd and its derivatives in T", "Subsubsection",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.925350329097713*^9, 3.925350336352416*^9}, {
   3.9253512081158667`*^9, 3.9253513494694033`*^9}, {3.925351393616753*^9, 
   3.925351428000167*^9}, 3.925352815670178*^9, 3.925352845829981*^9, {
   3.9253528806833153`*^9, 3.925352896274995*^9}, {3.925364118051174*^9, 
   3.925364125383419*^9}, 3.925366515841626*^9, {3.92536655129023*^9, 
   3.9253665654731197`*^9}, {3.925366612999741*^9, 3.9253666224655523`*^9}, {
   3.9253666608523417`*^9, 3.925366686684767*^9}, {3.9253667998553467`*^9, 
   3.925366810879343*^9}, {3.9253668960596647`*^9, 3.925366925125349*^9}, 
   3.925367055450906*^9, {3.925367100760113*^9, 3.925367112464711*^9}, {
   3.925371692953485*^9, 
   3.925371693588953*^9}},ExpressionUUID->"1701db54-8be1-4d4d-9441-\
b1007f88a819"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "collect", " ", "coefficient", " ", "of", " ", "\[Delta]vFirstOrd", " ", 
    "and", " ", "its", " ", "derivatives", " ", "in", " ", "T", " ", "in", 
    " ", "the", " ", "variational", " ", "form"}], " ", "*)"}], "\n", 
  RowBox[{"eqvFirstOrd", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"eqToSolveForFirstOrdDis", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]wFirstOrd", "->", " ", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}], ",", 
         RowBox[{"\[Delta]uFirstOrd", "->", " ", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Delta]vFirstOrd", "[", 
        RowBox[{"S", ",", "T"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Delta]vFirstOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}]}], "}"}], ",", 
     "FullSimplify"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.925350329097713*^9, 3.925350336352416*^9}, {
   3.9253512081158667`*^9, 3.9253513494694033`*^9}, {3.925351393616753*^9, 
   3.925351428000167*^9}, 3.925352815670178*^9, 3.925352845829981*^9, {
   3.9253528806833153`*^9, 3.925352896274995*^9}, {3.925364118051174*^9, 
   3.925364125383419*^9}, 3.925366515841626*^9, {3.92536655129023*^9, 
   3.9253665654731197`*^9}, {3.925366612999741*^9, 3.9253666224655523`*^9}, {
   3.9253666608523417`*^9, 3.925366686684767*^9}, {3.9253667998553467`*^9, 
   3.925366810879343*^9}, {3.9253668960596647`*^9, 3.925366925125349*^9}, {
   3.925367055450906*^9, 3.9253670678834257`*^9}, {3.9253671813536253`*^9, 
   3.9253671935747833`*^9}, 
   3.92699329465758*^9},ExpressionUUID->"98c19318-4bf1-4e87-a82f-\
e4cf9b112508"],

Cell[BoxData[
 StyleBox[
  RowBox[{" ", 
   RowBox[{
   "Calculation", " ", "of", " ", "differential", " ", "equation", " ", "for",
     " ", "vFirstOrd"}]}], "Subsection"]], "Text",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.925350329097713*^9, 3.925350336352416*^9}, {
   3.9253512081158667`*^9, 3.9253513494694033`*^9}, {3.925351393616753*^9, 
   3.925351428000167*^9}, 3.925352815670178*^9, 3.925352845829981*^9, {
   3.9253528806833153`*^9, 3.925352896274995*^9}, {3.925364118051174*^9, 
   3.925364125383419*^9}, 3.925366515841626*^9, {3.92536655129023*^9, 
   3.9253665654731197`*^9}, {3.925366612999741*^9, 3.9253666224655523`*^9}, {
   3.9253666608523417`*^9, 3.925366686684767*^9}, {3.9253667998553467`*^9, 
   3.925366810879343*^9}, {3.9253668960596647`*^9, 3.925366925125349*^9}, {
   3.925367055450906*^9, 3.9253670678834257`*^9}, {3.9253671813536253`*^9, 
   3.925367262198792*^9}, {3.9253695798915787`*^9, 
   3.9253695943687973`*^9}},ExpressionUUID->"4e313347-6ee5-45c7-bf14-\
775fcb0e0562"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], " ", 
     RowBox[{"coeffvFirstOrd", " ", "\[Delta]vFirstOrd"}]}], " ", "+", " ", 
    RowBox[{"coeffvFirstOrdDT", " ", 
     SubscriptBox["\[Delta]vFirstOrd", 
      RowBox[{",", "T"}]], " ", "dT"}]}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Integral]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]], 
     RowBox[{"1", "/", "2"}]], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"coeffvFirstOrd", " ", "\[Delta]vFirstOrd"}], " ", "+", " ", 
       SubscriptBox[
        RowBox[{"(", 
         RowBox[{"coeffvFirstOrdDT", " ", "\[Delta]vFirstOrd"}], ")"}], 
        RowBox[{",", "T"}]], " ", "-", 
       RowBox[{
        SubscriptBox["coeffvFirstOrdDT", 
         RowBox[{",", "T"}]], " ", "\[Delta]vFirstOrd"}]}], ")"}], " ", 
     "dT"}]}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"coeffvFirstOrd", " ", "-", 
        SubscriptBox["coeffvFirstOrdDT", 
         RowBox[{",", "T"}]]}], ")"}], " ", "\[Delta]vFirstOrd", " ", 
      "dT"}]}], " ", "+", " ", 
    SuperscriptBox[
     SubscriptBox[
      RowBox[{"[", 
       RowBox[{"coeffvFirstOrdDT", " ", "\[Delta]vFirstOrd"}], "]"}], 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}]], 
     RowBox[{"T", "=", 
      RowBox[{"1", "/", "2"}]}]]}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "we", " ", "get", " ", "natural", " ", "boundary", " ", "conditions", " ", 
    
    RowBox[{"as", ":", " ", 
     RowBox[{"coeffvFirstOrdDT", "[", 
      RowBox[{"S", ",", 
       RowBox[{
        RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}], "]"}]}]}], "=", "0"}], 
  ",", "\[IndentingNewLine]", " ", 
  RowBox[{
  "and", " ", "the", " ", "differential", " ", "equation", " ", 
   "as"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coeffvFirstOrd", " ", "-", 
    SubscriptBox["coeffvFirstOrdDT", 
     RowBox[{",", "T"}]]}], " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"on", " ", "integrating"}], ",", " ", 
  RowBox[{"we", " ", "get"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", "0"], "T"], 
     RowBox[{
      RowBox[{"coeffvFirstOrd", "[", 
       RowBox[{"S", ",", "m"}], "]"}], " ", "dm"}]}], " ", "-", " ", 
    RowBox[{"coeffvFirstOrdDT", "[", 
     RowBox[{"S", ",", "T"}], "]"}], " ", "+", " ", 
    RowBox[{"cvFirstOrd", "[", "S", "]"}]}], " ", "=", "0"}], ";", " ", 
  RowBox[{
   RowBox[{"where", " ", "cvFirstOrd"}], " ", "=", " ", 
   RowBox[{"constant", " ", "of", " ", "integration"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"at", " ", "T"}], "=", 
  RowBox[{
   RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", "0"], 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      RowBox[{"coeffvFirstOrd", "[", 
       RowBox[{"S", ",", "m"}], "]"}], " ", "dm"}]}], " ", "-", " ", 
    RowBox[{"coeffvFirstOrdDT", "[", 
     RowBox[{"S", ",", 
      RowBox[{"1", "/", "2"}]}], "]"}], " ", "+", " ", 
    RowBox[{"cvFirstOrd", "[", "S", "]"}]}], " ", "=", " ", "0"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", "0"], 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]], 
     RowBox[{
      RowBox[{"coeffvFirstOrd", "[", 
       RowBox[{"S", ",", "m"}], "]"}], " ", "dm"}]}], " ", "-", " ", 
    RowBox[{"coeffvFirstOrdDT", "[", 
     RowBox[{"S", ",", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]}], "]"}], " ", "+", " ", 
    RowBox[{"cvFirstOrd", "[", "S", "]"}]}], " ", "=", " ", "0"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "using", " ", "the", " ", "natural", " ", "boundry", " ", "conditions"}], 
  ",", " ", 
  RowBox[{"it", " ", "boils", " ", "to"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", "0"], 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      RowBox[{"coeffvFirstOrd", "[", 
       RowBox[{"S", ",", "m"}], "]"}], " ", "dm"}]}], " ", "+", " ", 
    RowBox[{"cvFirstOrd", "[", "S", "]"}]}], " ", "=", " ", "0"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", "0"], 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]], 
     RowBox[{
      RowBox[{"coeffvFirstOrd", "[", 
       RowBox[{"S", ",", "m"}], "]"}], " ", "dm"}]}], " ", "+", " ", 
    RowBox[{"cvFirstOrd", "[", "S", "]"}]}], " ", "=", " ", "0"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"we", " ", "use", " ", "these", " ", "boundary", " ", "conditions", 
  " ", "to", " ", "solve", " ", "for", " ", "cvFirstOrdS", " ", "and", " ", 
  "fSSecondOrd", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"contained", " ", "in", " ", "coeffvFirstOrd"}], ")"}], 
   "."}]}]}], "Text",
 CellChangeTimes->{{3.925369631995002*^9, 3.92536964365549*^9}, {
   3.9253697169767237`*^9, 3.9253697513798513`*^9}, {3.925369826472069*^9, 
   3.925369835260553*^9}, {3.92536986580931*^9, 3.9253698789222317`*^9}, {
   3.925369914069175*^9, 3.925369953438611*^9}, {3.9253700078481703`*^9, 
   3.925370175737873*^9}, {3.925370213441114*^9, 3.925370316973755*^9}, 
   3.9256316025803833`*^9, 
   3.926993295750442*^9},ExpressionUUID->"fdb3029d-0dee-48b9-bb25-\
f2a1f175144d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Identify", " ", "coefficients", " ", "of", " ", 
    RowBox[{"\[Delta]vFirstOrd", "[", "T", "]"}], " ", "and", " ", 
    SubscriptBox["\[Delta]vFirsOrd", 
     RowBox[{",", "T"}]]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"coeffvFirstOrd", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", " ", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"eqvFirstOrd", ",", 
       RowBox[{"\[Delta]vFirstOrd", "[", 
        RowBox[{"S", ",", "T"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coeffvFirstOrdDT", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", " ", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"eqvFirstOrd", ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Delta]vFirstOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8770056461077957`*^9, 3.877005667192342*^9}, {
   3.877005705558473*^9, 3.877005806394244*^9}, {3.877006190355116*^9, 
   3.8770061918453827`*^9}, {3.877022485481937*^9, 3.877022500781509*^9}, {
   3.8770532577413177`*^9, 3.877053272967491*^9}, {3.877061650480495*^9, 
   3.87706166296099*^9}, {3.877078498203377*^9, 3.877078512635633*^9}, {
   3.877139919058017*^9, 3.877139920464994*^9}, 3.877145268202771*^9, {
   3.877151655864447*^9, 3.877151656206232*^9}, 3.877151729471819*^9, 
   3.877231219341444*^9, {3.8774088512739897`*^9, 3.877408854996834*^9}, {
   3.877409208230685*^9, 3.877409219112339*^9}, {3.8774096932833033`*^9, 
   3.877409696247348*^9}, {3.8774099296185102`*^9, 3.877409931171424*^9}, 
   3.877509449480441*^9, {3.877534155319561*^9, 3.877534157242735*^9}, {
   3.8775958725960293`*^9, 3.877595876144641*^9}, {3.8776090753198023`*^9, 
   3.8776090757696867`*^9}, {3.877609111446823*^9, 3.8776091220316763`*^9}, 
   3.879148475149231*^9, 3.879484199087397*^9, {3.924823921592435*^9, 
   3.924823977744035*^9}, {3.9248988522348003`*^9, 3.9248988565294437`*^9}, {
   3.9253664571712523`*^9, 3.9253664571766577`*^9}, {3.925370625597034*^9, 
   3.925370653021399*^9}, {3.925371013508725*^9, 3.9253710232666492`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"db8326c6-5ee9-4554-925f-f1d5f0d86e36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"sanity", " ", 
    RowBox[{"check", ":", " ", 
     RowBox[{"only", " ", "two", " ", "terms", " ", 
      RowBox[{"(", 
       RowBox[{"coeffvFirstOrd", ",", " ", "coeffvFirstOrdDT"}], ")"}], " ", 
      "are", " ", "associated", " ", "with", " ", "\[Delta]vFirstOrd", " ", 
      "and", " ", "its", " ", "derivatives", " ", "in", " ", "T"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{"doSanityCheck", ",", 
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coeffvFirstOrd", "[", 
           RowBox[{"S", ",", "T"}], "]"}], " ", 
          RowBox[{"\[Delta]vFirstOrd", "[", 
           RowBox[{"S", ",", "T"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"coeffvFirstOrdDT", "[", 
           RowBox[{"S", ",", "T"}], "]"}], " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Delta]vFirstOrd", "[", 
             RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}]}], "-", 
         "eqvFirstOrd"}], "]"}], "==", "0"}], "]"}]}], "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.8770056461077957`*^9, 3.877005667192342*^9}, {
   3.877005705558473*^9, 3.877005806394244*^9}, {3.877006190355116*^9, 
   3.8770061918453827`*^9}, {3.877022485481937*^9, 3.877022500781509*^9}, {
   3.8770532577413177`*^9, 3.877053272967491*^9}, {3.877061650480495*^9, 
   3.87706166296099*^9}, {3.877078498203377*^9, 3.877078512635633*^9}, {
   3.877139919058017*^9, 3.877139920464994*^9}, 3.877145268202771*^9, {
   3.877151655864447*^9, 3.877151656206232*^9}, 3.877151729471819*^9, 
   3.877231219341444*^9, {3.8774088512739897`*^9, 3.877408854996834*^9}, {
   3.877409208230685*^9, 3.877409219112339*^9}, {3.8774096932833033`*^9, 
   3.877409696247348*^9}, {3.8774099296185102`*^9, 3.877409931171424*^9}, 
   3.877509449480441*^9, {3.877534155319561*^9, 3.877534157242735*^9}, {
   3.8775958725960293`*^9, 3.877595876144641*^9}, {3.8776090753198023`*^9, 
   3.8776090757696867`*^9}, {3.877609111446823*^9, 3.8776091220316763`*^9}, 
   3.879148475149231*^9, 3.879484199087397*^9, {3.924823921592435*^9, 
   3.924823993030195*^9}, {3.924824599992481*^9, 3.9248246179463778`*^9}, 
   3.924898846690692*^9, {3.925366457178035*^9, 3.9253664571834717`*^9}, {
   3.925370657085787*^9, 3.925370698076638*^9}, {3.925371027235504*^9, 
   3.925371038438501*^9}, {3.925371117654779*^9, 3.925371118832979*^9}, 
   3.9253799898361683`*^9, {3.926993296660096*^9, 
   3.926993298234912*^9}},ExpressionUUID->"269eac7b-f8da-43f6-8696-\
3f8d3a9f2315"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"we", " ", "write", " ", "icoeffFirstOrd"}], " ", "=", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", "0"], "T"], " ", 
     RowBox[{
      RowBox[{"coeffvFirstOrd", "[", 
       RowBox[{"S", ",", "m"}], "]"}], " ", "dm"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"icoeffvFirstOrd", "[", "T_", "]"}], " ", "=", " ", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"coeffvFirstOrd", "[", 
       RowBox[{"S", ",", "T"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "0", ",", "T"}], "}"}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.877022513712929*^9, 3.877022516973556*^9}, {
   3.877053704553198*^9, 3.877053878151829*^9}, {3.877053927770347*^9, 
   3.8770539708771276`*^9}, {3.877054005678164*^9, 3.8770540984145823`*^9}, {
   3.877054172339796*^9, 3.8770542044057407`*^9}, {3.877054272363752*^9, 
   3.877054361658428*^9}, {3.8770544146945953`*^9, 3.877054629323852*^9}, {
   3.8770547469068613`*^9, 3.877054754411489*^9}, {3.8770547845039253`*^9, 
   3.87705481982298*^9}, {3.8770548715690413`*^9, 3.877054893102345*^9}, {
   3.877054928676278*^9, 3.8770549923643303`*^9}, {3.877055023972196*^9, 
   3.877055172801949*^9}, 3.8770553087096243`*^9, {3.877055987277916*^9, 
   3.877055993380925*^9}, {3.87705606612225*^9, 3.8770560699863253`*^9}, {
   3.877056152687504*^9, 3.877056263910925*^9}, {3.877056316465229*^9, 
   3.877056334521469*^9}, {3.877056389953575*^9, 3.877056517645081*^9}, {
   3.877056596651601*^9, 3.8770566681631327`*^9}, {3.877056909972349*^9, 
   3.877056938805242*^9}, {3.877057635329927*^9, 3.877057684988014*^9}, {
   3.877059894787829*^9, 3.87705989536189*^9}, {3.877139860995453*^9, 
   3.877139862297923*^9}, 3.877142550440325*^9, {3.8771435074330997`*^9, 
   3.877143511619226*^9}, 3.8771436621533747`*^9, {3.8771519346215677`*^9, 
   3.877151935119718*^9}, {3.8771558866910057`*^9, 3.8771558873151627`*^9}, {
   3.877156148243258*^9, 3.877156150835207*^9}, 3.8772278918089867`*^9, {
   3.877231556616836*^9, 3.8772315663450737`*^9}, 3.8772317073456917`*^9, 
   3.877411430553953*^9, {3.879148433314232*^9, 3.879148449094481*^9}, {
   3.9248246259942217`*^9, 3.9248246817311172`*^9}, 3.924898843710051*^9, {
   3.9253664571847486`*^9, 3.925366457185697*^9}, {3.925370720258788*^9, 
   3.9253707543107243`*^9}, {3.925371041571446*^9, 3.9253710463416*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"2b24059c-5db1-432b-a4c2-50686931c981"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"we", " ", "solve", " ", "for", " ", "fSSecondOrd", " ", 
     RowBox[{"(", 
      RowBox[{"coeffvFirstOrd", " ", "contains", " ", "fSSecondOrd"}], ")"}], 
     " ", "and", " ", "cvFFirstOrd"}], ",", " ", 
    RowBox[{"and", " ", "obtain", " ", "them", " ", "as"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cvFirstOrdExp", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"cvFirstOrd", "/.", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"icoeffvFirstOrd", "[", 
               RowBox[{"1", "/", "2"}], "]"}], "+", " ", "cvFirstOrd"}], "==",
              "0"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"icoeffvFirstOrd", "[", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], "]"}], "+", " ", 
              "cvFirstOrd"}], "==", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"cvFirstOrd", ",", 
            RowBox[{"fSSecondOrd", "[", "S", "]"}]}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fSSecondOrdExp", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"fSSecondOrd", "[", "S", "]"}], "/.", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"icoeffvFirstOrd", "[", 
               RowBox[{"1", "/", "2"}], "]"}], "+", " ", "cvFirstOrd"}], "==",
              "0"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"icoeffvFirstOrd", "[", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], "]"}], "+", " ", 
              "cvFirstOrd"}], "==", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"cvFirstOrd", ",", 
            RowBox[{"fSSecondOrd", "[", "S", "]"}]}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.877060043824081*^9, 3.877060073160631*^9}, {
   3.877060107925115*^9, 3.877060140491888*^9}, {3.8770603605650806`*^9, 
   3.8770603911685057`*^9}, {3.87706049377262*^9, 3.877060606804925*^9}, {
   3.877060722562911*^9, 3.877060760612526*^9}, {3.877060944236978*^9, 
   3.8770609476989527`*^9}, {3.877061100787385*^9, 3.877061185053154*^9}, {
   3.877076662887693*^9, 3.877076663625435*^9}, {3.877142095634777*^9, 
   3.877142103667554*^9}, {3.877142563775569*^9, 3.877142566514224*^9}, {
   3.87714369347083*^9, 3.877143696668911*^9}, {3.8772317554826603`*^9, 
   3.877231826313933*^9}, 3.877236071158021*^9, {3.87731843497287*^9, 
   3.877318444206861*^9}, 3.877409934948555*^9, {3.877609135270553*^9, 
   3.877609175092894*^9}, {3.8791489920059*^9, 3.879149071615182*^9}, {
   3.879483615827712*^9, 3.879483617532814*^9}, {3.924824713220558*^9, 
   3.9248247575194607`*^9}, {3.924824824772038*^9, 3.924824852409391*^9}, {
   3.9248249045721483`*^9, 3.924824905170165*^9}, {3.924898829293077*^9, 
   3.924898831708973*^9}, {3.925366457187296*^9, 3.925366457201468*^9}, {
   3.925366743092629*^9, 3.925366743098646*^9}, {3.9253707588798447`*^9, 
   3.92537079256889*^9}, 3.9253708667098293`*^9, {3.925631605248824*^9, 
   3.925631618289139*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"14a69d48-9cfa-4361-9e85-54580e638bbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "setting", " ", "the", " ", "expressions", " ", "of", " ", "cvFirstOrd", 
     " ", "and", " ", "fSSecondOrd", " ", "back", " ", "in", " ", "the", " ", 
     "differntial", " ", "equation", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[Integral]", "0"], "T"], 
         RowBox[{
          RowBox[{"coeffvFirstOrd", "[", 
           RowBox[{"S", ",", "m"}], "]"}], " ", "dm"}]}], " ", "-", " ", 
        RowBox[{"coeffFirstOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}], " ", "+", " ", 
        RowBox[{"cvFirsOrd", "[", "S", "]"}]}], " ", "=", "0"}], ")"}]}], ",",
     " ", 
    RowBox[{"we", " ", 
     RowBox[{"get", ":"}]}]}], " ", "*)"}], "\n", 
  RowBox[{"diffEqnvFirstOrd", " ", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "\[Nu]"}], ")"}], 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"icoeffvFirstOrd", "[", "T", "]"}], "-", 
         RowBox[{"coeffvFirstOrdDT", "[", 
          RowBox[{"S", ",", "T"}], "]"}], "+", "cvFirstOrdExp"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fSSecondOrd", "[", "S", "]"}], "->", " ", 
          "fSSecondOrdExp"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"vFirstOrd", "[", 
        RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}], ",", 
     "FullSimplify"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.877060043824081*^9, 3.877060073160631*^9}, {
   3.877060107925115*^9, 3.877060140491888*^9}, {3.8770603605650806`*^9, 
   3.8770603911685057`*^9}, {3.87706049377262*^9, 3.877060606804925*^9}, {
   3.877060722562911*^9, 3.877060760612526*^9}, {3.877060944236978*^9, 
   3.8770609476989527`*^9}, {3.877061100787385*^9, 3.877061185053154*^9}, {
   3.877076662887693*^9, 3.877076663625435*^9}, {3.877142095634777*^9, 
   3.877142103667554*^9}, {3.877142563775569*^9, 3.877142566514224*^9}, {
   3.87714369347083*^9, 3.877143696668911*^9}, {3.8772317554826603`*^9, 
   3.877231826313933*^9}, 3.877236071158021*^9, {3.87731843497287*^9, 
   3.877318444206861*^9}, 3.877409934948555*^9, {3.877609135270553*^9, 
   3.877609175092894*^9}, {3.8791489920059*^9, 3.879149071615182*^9}, {
   3.879483615827712*^9, 3.879483617532814*^9}, {3.924824713220558*^9, 
   3.9248247575194607`*^9}, {3.924824824772038*^9, 3.924824852409391*^9}, {
   3.9248249045721483`*^9, 3.924824905170165*^9}, {3.924898829293077*^9, 
   3.924898831708973*^9}, {3.925366457187296*^9, 3.925366457201468*^9}, {
   3.925366743092629*^9, 3.925366743098646*^9}, {3.9253707588798447`*^9, 
   3.92537079256889*^9}, 3.9253708667098293`*^9, {3.925370952054462*^9, 
   3.925370998975749*^9}, {3.925371062904344*^9, 3.925371128712357*^9}, 
   3.92538014663759*^9, {3.925391813473991*^9, 3.925391814409368*^9}, {
   3.925631605257689*^9, 3.925631605260219*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"00dcafe8-7265-49e3-96d0-06a90fb3910a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "In", " ", "the", " ", "above", " ", "differential", " ", "equation", 
      " ", "diffEqnvFirstOrd"}], " ", "=", " ", "0"}], ",", " ", 
    RowBox[{"we", " ", "collect", " ", 
     SubscriptBox["vFirstOrd", 
      RowBox[{",", "T"}]], " ", "on", " ", "left", " ", "hand", " ", "side", 
     " ", "and", " ", "rest", " ", "of", " ", "the", " ", "terms", " ", "on", 
     " ", "right", " ", "hand", " ", "side", " ", "as"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vFirstOrdDT", "=", 
     RowBox[{
      FractionBox["1", "6"], " ", 
      RowBox[{"\[Tau]", "[", "S", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "6"}], " ", 
         RowBox[{"wFirstOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}]}], "+", 
        RowBox[{"T", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Nu]", "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["T", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "\[Nu]"}], ")"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Tau]", "\[Prime]",
           MultilineFunction->None], "[", "S", "]"}]}], "+", 
        RowBox[{"6", " ", "T", " ", 
         RowBox[{
          SuperscriptBox["wFirstOrd", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"S", ",", "T"}], "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CheckSanity", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"diffEqnvFirstOrd", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["vFirstOrd", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"S", ",", "T"}], "]"}], "->", " ", "vFirstOrdDT"}], "}"}]}],
       "]"}], "==", "0"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "We", " ", "have", " ", "a", " ", "first", " ", "order", " ", 
      "differential", " ", 
      RowBox[{"equation", ".", " ", "Once"}], " ", "wFirstOrd", " ", "is", 
      " ", "known"}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "can", " ", "solve", " ", "it", " ", "in", " ", "conjuction",
        " ", "with", " ", "the", " ", "integral", " ", "constraint", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Integral]", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]], 
         RowBox[{"1", "/", "2"}]], " ", 
        RowBox[{"vFirstOrd", " ", "dT"}]}]}], " ", "=", " ", 
      RowBox[{"0", " ", "for", " ", "vFirstOrd"}]}]}], " ", 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.877077485266654*^9, 3.877077512618775*^9}, {
   3.87707764985079*^9, 3.87707777119314*^9}, {3.877077940731495*^9, 
   3.8770779427916517`*^9}, {3.8770820685160646`*^9, 
   3.8770820724413347`*^9}, {3.877151913837326*^9, 3.877151914370894*^9}, {
   3.8774099480801783`*^9, 3.8774099492366943`*^9}, 3.877533845617806*^9, 
   3.877533907944727*^9, 3.8775343379796762`*^9, 3.877609205809536*^9, {
   3.8776092362857018`*^9, 3.877609239654377*^9}, {3.877613592478963*^9, 
   3.877613600840415*^9}, {3.924830021140985*^9, 3.9248300354110823`*^9}, {
   3.924831479977426*^9, 3.924831485502075*^9}, 3.924898819284478*^9, {
   3.92536641448769*^9, 3.9253664155590563`*^9}, {3.925366457209942*^9, 
   3.925366457213621*^9}, 3.925371138510779*^9, {3.925371225626355*^9, 
   3.9253712380405617`*^9}, 3.9253713709172688`*^9, {3.925371489531665*^9, 
   3.92537149595446*^9}, 3.925371545401682*^9, 3.925371579512488*^9, {
   3.925378500164359*^9, 3.925378504318963*^9}, {3.9269933020056543`*^9, 
   3.926993313216411*^9}},ExpressionUUID->"a009dc3b-15ab-409e-a625-\
257506fe8f82"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Terms with \[Delta]uFirstOrd and its derivatives in T", "Subsubsection",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942537932708*^9, 3.924942546666551*^9}, {3.924942596303712*^9, 
   3.924942608541396*^9}, {3.925202916259794*^9, 3.925202917478636*^9}, 
   3.925203065287524*^9, {3.925350329097713*^9, 3.925350336352416*^9}, {
   3.9253512081158667`*^9, 3.9253513494694033`*^9}, {3.925351393616753*^9, 
   3.925351428000167*^9}, 3.925352815670178*^9, 3.925352845829981*^9, {
   3.9253528806833153`*^9, 3.925352896274995*^9}, {3.925364118051174*^9, 
   3.925364125383419*^9}, 3.925366515841626*^9, {3.92536655129023*^9, 
   3.9253665654731197`*^9}, {3.925366612999741*^9, 3.9253666224655523`*^9}, {
   3.9253666608523417`*^9, 3.925366686684767*^9}, {3.9253667998553467`*^9, 
   3.925366810879343*^9}, {3.9253668960596647`*^9, 3.925366925125349*^9}, 
   3.925367055450906*^9, {3.925367100760113*^9, 3.925367112464711*^9}, {
   3.925371682323928*^9, 
   3.9253716869065523`*^9}},ExpressionUUID->"8cbf8bbb-7055-40a0-bce0-\
053760a0b054"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"calculation", "of", "differential", "equation", "for", 
    RowBox[{"uFirstOrd", ":", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Integral]", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]], 
        RowBox[{"1", "/", "2"}]], 
       RowBox[{
        RowBox[{"-", "fTSecondOrd"}], " ", "\[Delta]uFirstOrd"}]}], "+", " ", 
      
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[Nu]", "2"]}]], " ", 
       SubscriptBox["uFirstOrd", 
        RowBox[{",", "T"}]], 
       SubscriptBox["\[Delta]uFirstOrd", 
        RowBox[{",", "T"}]], "dT"}]}]}]}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"fTSecondOrd", "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"1", "-", 
            SuperscriptBox["\[Nu]", "2"]}]], " ", 
          SubscriptBox["uFirstOrd", 
           RowBox[{",", "TT"}]]}]}], ")"}]}], "\[Delta]uFirstOrd", " ", 
      "dT"}]}], "+", 
    SuperscriptBox[
     SubscriptBox[
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[Nu]", "2"]}]], " ", "[", 
       RowBox[{
        SubscriptBox["uFirstOrd", 
         RowBox[{",", "T"}]], "\[Delta]uFirstOrd"}], "]"}], 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}]], 
     RowBox[{"T", "=", 
      RowBox[{"1", "/", "2"}]}]]}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"we", "get", "natural", "boundary", "conditions", 
    RowBox[{"as", ":", 
     RowBox[{
      SubscriptBox["uFirstOrd", 
       RowBox[{",", "T"}]], "[", 
      RowBox[{"S", ",", 
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}]}], "]"}]}]}], "=", "0"}],
   ",", 
  RowBox[{"and", "the", "differentialequationas"}]}], "\n", 
 RowBox[{
  RowBox[{"fTSecondOrd", "+", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"1", "-", 
      SuperscriptBox["\[Nu]", "2"]}]], " ", 
    SubscriptBox["uFirstOrd", 
     RowBox[{",", "TT"}]]}]}], "=", "0"}], "\n", 
 RowBox[{
  RowBox[{"on", "integrating"}], ",", "weget"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fTSecondOrd", " ", "T"}], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[Nu]", "2"]}]], " ", 
     SubscriptBox["uFirstOrd", 
      RowBox[{",", "T"}]]}], "+", "cuFirstOrd"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"where", " ", "cuFirstOrd"}], "=", "constantofintegration"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"at", "T"}], "=", 
  RowBox[{
   RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fTSecondOrd", "[", "S", "]"}], 
     RowBox[{"(", 
      FractionBox["1", "2"], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[Nu]", "2"]}]], " ", 
     RowBox[{
      SubscriptBox["uFirstOrd", 
       RowBox[{",", "T"}]], "[", 
      RowBox[{"S", ",", 
       FractionBox["1", "2"]}], "]"}]}], "+", 
    RowBox[{"cuFirstOrd", "[", "S", "]"}]}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fTSecondOrd", "[", "S", "]"}], 
     RowBox[{"(", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[Nu]", "2"]}]], " ", 
     RowBox[{
      SubscriptBox["uFirstOrd", 
       RowBox[{",", "T"}]], "[", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "]"}]}], "+", 
    RowBox[{"cuFirstOrd", "[", "S", "]"}]}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "using", " ", "the", " ", "natural", " ", "boundry", " ", "conditions"}], 
  ",", 
  RowBox[{"it", " ", "boils", " ", "to"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fTSecondOrd", "[", "S", "]"}], 
     RowBox[{"(", 
      FractionBox["1", "2"], ")"}]}], "+", 
    RowBox[{"cuFirstOrd", "[", "S", "]"}]}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fTSecondOrd", "[", "S", "]"}], 
     RowBox[{"(", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], ")"}]}], "+", 
    RowBox[{"cuFirstOrd", "[", "S", "]"}]}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"which", " ", "gives", " ", "us", " ", "fTSecondOrd"}], "=", 
   RowBox[{"cuFirstOrd", "=", "0"}]}], ";", 
  RowBox[{"and", "therefore", "the", "differential", "equation"}]}], "\n", 
 RowBox[{
  SubscriptBox["uFirstOrd", 
   RowBox[{",", "T"}]], "=", "0"}], "\n", 
 RowBox[{
  RowBox[{
  "Itisafirst", " ", "order", " ", "differential", " ", "equation", " ", "in",
    " ", "T"}], ";", 
  RowBox[{
   RowBox[{
   "solving", " ", "it", " ", "in", " ", "conjuction", " ", "with", " ", 
    "the", " ", "integral", " ", "constraint", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      RowBox[{"uFirstOrd", "[", 
       RowBox[{"S", ",", "T"}], "]"}], "dT"}]}]}], "=", 
   RowBox[{"0", "gives"}]}]}], "\n", 
 RowBox[{
  RowBox[{"uFirstOrd", "[", 
   RowBox[{"S", ",", "T"}], "]"}], "=", "0"}]}], "Text",
 CellChangeTimes->{{3.877077485266654*^9, 3.877077512618775*^9}, {
   3.87707764985079*^9, 3.87707777119314*^9}, {3.877077940731495*^9, 
   3.8770779427916517`*^9}, {3.8770820685160646`*^9, 
   3.8770820724413347`*^9}, {3.877151913837326*^9, 3.877151914370894*^9}, {
   3.8774099480801783`*^9, 3.8774099492366943`*^9}, 3.877533845617806*^9, 
   3.877533907944727*^9, 3.8775343379796762`*^9, 3.877609205809536*^9, {
   3.8776092362857018`*^9, 3.877609239654377*^9}, {3.877613592478963*^9, 
   3.877613600840415*^9}, {3.924830021140985*^9, 3.9248300354110823`*^9}, {
   3.924831479977426*^9, 3.924831485502075*^9}, 3.924898819284478*^9, {
   3.92536641448769*^9, 3.9253664155590563`*^9}, {3.925366457209942*^9, 
   3.925366457213621*^9}, 3.925371138510779*^9, {3.925371225626355*^9, 
   3.9253712380405617`*^9}, 3.9253713709172688`*^9, {3.925371489531665*^9, 
   3.92537149595446*^9}, {3.925371545401682*^9, 3.9253716049746313`*^9}, {
   3.925371708148981*^9, 3.925371771266141*^9}, {3.925371834029036*^9, 
   3.9253718371819477`*^9}, {3.9253785173174467`*^9, 
   3.9253787973947353`*^9}, {3.925379141503521*^9, 3.925379207753647*^9}, {
   3.925379639832512*^9, 3.925379652120413*^9}, {3.9256316332581367`*^9, 
   3.925631633269573*^9}, 
   3.926993302008739*^9},ExpressionUUID->"d10d4764-57c9-45ad-bdff-\
9eb120d6e8da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"equFirstOrd", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"eqToSolveForFirstOrdDis", " ", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]wFirstOrd", "->", " ", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}], ",", 
         RowBox[{"\[Delta]vFirstOrd", "->", " ", 
          RowBox[{"(", 
           RowBox[{"0", "&"}], ")"}]}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Delta]uFirstOrd", "[", 
        RowBox[{"S", ",", "T"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Delta]uFirstOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}]}], "}"}], ",", 
     "FullSimplify"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"collect", " ", "coefficient", " ", "of", " ", 
    SubscriptBox["\[Delta]uFirstOrd", 
     RowBox[{",", "T"}]], " ", "in", " ", "the", " ", "variation", " ", "of", 
    " ", "potential"}], " ", "*)"}]}], "\n", 
 RowBox[{"If", "[", 
  RowBox[{"doSanityCheck", ",", 
   RowBox[{"CheckSanity", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", " ", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"equFirstOrd", ",", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Delta]uFirstOrd", "[", 
            RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}]}], "]"}], "-", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Nu]", "2"]}]], " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"uFirstOrd", "[", 
           RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}]}]}], "]"}], "==",
      "0"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.877077485266654*^9, 3.877077512618775*^9}, {
   3.87707764985079*^9, 3.87707777119314*^9}, {3.877077940731495*^9, 
   3.8770779427916517`*^9}, {3.8770820685160646`*^9, 
   3.8770820724413347`*^9}, {3.877151913837326*^9, 3.877151914370894*^9}, {
   3.8774099480801783`*^9, 3.8774099492366943`*^9}, 3.877533845617806*^9, 
   3.877533907944727*^9, 3.8775343379796762`*^9, 3.877609205809536*^9, {
   3.8776092362857018`*^9, 3.877609239654377*^9}, {3.877613592478963*^9, 
   3.877613600840415*^9}, {3.924830021140985*^9, 3.9248300354110823`*^9}, {
   3.924831479977426*^9, 3.924831485502075*^9}, 3.924898819284478*^9, {
   3.92536641448769*^9, 3.9253664155590563`*^9}, {3.925366457209942*^9, 
   3.925366457213621*^9}, 3.925371138510779*^9, {3.925371225626355*^9, 
   3.9253712380405617`*^9}, 3.9253713709172688`*^9, {3.925371489531665*^9, 
   3.92537149595446*^9}, {3.925371545401682*^9, 3.9253716049746313`*^9}, {
   3.925371708148981*^9, 3.925371733618112*^9}, {3.925379700188162*^9, 
   3.925379704138681*^9}, 
   3.926993302010659*^9},ExpressionUUID->"23e3a5c8-66c7-4bd0-9c3b-\
3d3a74d8637d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"we", " ", "will", " ", "use"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"uFirstOrdDT", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uFirstOrdSol", "[", 
     RowBox[{"S_", ",", "T_"}], "]"}], "=", " ", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.877082469528946*^9, 3.877082479368155*^9}, {
   3.877082663395711*^9, 3.877082708936462*^9}, 3.877082784839858*^9, 
   3.8770828190243807`*^9, {3.8770828510190887`*^9, 3.877082901968637*^9}, 
   3.8770829834442377`*^9, {3.8770848112526007`*^9, 3.8770848152221603`*^9}, {
   3.877085419627633*^9, 3.8770854243477993`*^9}, {3.877143735567498*^9, 
   3.877143736827957*^9}, {3.877236791716367*^9, 3.877236796984006*^9}, {
   3.877236962974997*^9, 3.877236963997034*^9}, {3.877237022501871*^9, 
   3.877237030006996*^9}, {3.877237060767922*^9, 3.877237088382408*^9}, 
   3.877237124590249*^9, 3.877237174737205*^9, {3.877237223457127*^9, 
   3.8772373335261173`*^9}, {3.877355529284507*^9, 3.8773555452503777`*^9}, 
   3.877509454845703*^9, {3.877527903589282*^9, 3.8775279052840223`*^9}, {
   3.87759589879466*^9, 3.8775959019057827`*^9}, {3.8776094635148077`*^9, 
   3.877609474462267*^9}, {3.877609511550806*^9, 3.877609545870584*^9}, {
   3.8791493169963427`*^9, 3.879149350949473*^9}, {3.879484924648643*^9, 
   3.879484929774089*^9}, {3.879485017821434*^9, 3.879485040182283*^9}, 
   3.879485173375194*^9, {3.9248308317783937`*^9, 3.9248308385153217`*^9}, 
   3.92489880619608*^9, {3.925366466835113*^9, 3.92536646683613*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"eaf070fa-2a73-4335-9e35-8acf39f18659"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Terms with \[Delta]wFirstOrd and its derivatives ", "Subsection",
 CellChangeTimes->{{3.8770832512980013`*^9, 3.877083258242156*^9}, {
   3.877083644876461*^9, 3.8770836735219717`*^9}, {3.877085437627351*^9, 
   3.877085453979806*^9}, {3.877085580733629*^9, 3.877085675922286*^9}, {
   3.877085710125102*^9, 3.877085853811496*^9}, {3.877085925894361*^9, 
   3.877085968998953*^9}, {3.877086098699175*^9, 3.877086272203559*^9}, {
   3.877086306402602*^9, 3.8770863657026567`*^9}, {3.877086514753149*^9, 
   3.8770866800938797`*^9}, {3.877086747648378*^9, 3.8770868146774893`*^9}, {
   3.877086858044056*^9, 3.877086872467382*^9}, {3.87708696448761*^9, 
   3.877086973860702*^9}, {3.877087080053789*^9, 3.877087080689988*^9}, {
   3.877087116417864*^9, 3.877087284882596*^9}, {3.877087327523135*^9, 
   3.877087458990073*^9}, {3.877087737120924*^9, 3.8770879730724573`*^9}, {
   3.877088003441382*^9, 3.8770883601528*^9}, {3.8770884083492126`*^9, 
   3.877088427246805*^9}, {3.877089819355278*^9, 3.877089844373837*^9}, {
   3.8770899517052794`*^9, 3.87708997878941*^9}, {3.8770900210095863`*^9, 
   3.8770900328150253`*^9}, 3.8770906151099577`*^9, 3.877236801468814*^9, {
   3.8773184730153503`*^9, 3.877318550408924*^9}, {3.877370021135536*^9, 
   3.8773700227702208`*^9}, {3.877525491037469*^9, 3.877525530485752*^9}, 
   3.877534698066868*^9, {3.877584774111837*^9, 3.877584780140218*^9}, 
   3.925371238050087*^9},ExpressionUUID->"8915af98-6caf-4162-982c-\
0f5bea90dcb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "variation", " ", "terms", " ", "that", " ", "have", " ", 
    "involve", " ", "\[Delta]wFirstOrd", " ", "and", " ", "its", " ", 
    "derivatives", " ", "in", " ", "T"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"eqwFirstOrd", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"eqToSolveForFirstOrdDis", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Delta]uFirstOrd", "->", " ", 
            RowBox[{"(", 
             RowBox[{"0", "&"}], ")"}]}], ",", 
           RowBox[{"\[Delta]vFirstOrd", "->", " ", 
            RowBox[{"(", 
             RowBox[{"0", "&"}], ")"}]}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]wFirstOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Delta]wFirstOrd", "[", 
            RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}], ",", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Delta]wFirstOrd", "[", 
            RowBox[{"S", ",", "T"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"T", ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
       "FullSimplify"}], "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8770832512980013`*^9, 3.877083258242156*^9}, {
   3.877083644876461*^9, 3.8770836735219717`*^9}, {3.877085437627351*^9, 
   3.877085453979806*^9}, {3.877085580733629*^9, 3.877085675922286*^9}, {
   3.877085710125102*^9, 3.877085853811496*^9}, {3.877085925894361*^9, 
   3.877085968998953*^9}, {3.877086098699175*^9, 3.877086272203559*^9}, {
   3.877086306402602*^9, 3.8770863657026567`*^9}, {3.877086514753149*^9, 
   3.8770866800938797`*^9}, {3.877086747648378*^9, 3.8770868146774893`*^9}, {
   3.877086858044056*^9, 3.877086872467382*^9}, {3.87708696448761*^9, 
   3.877086973860702*^9}, {3.877087080053789*^9, 3.877087080689988*^9}, {
   3.877087116417864*^9, 3.877087284882596*^9}, {3.877087327523135*^9, 
   3.877087458990073*^9}, {3.877087737120924*^9, 3.8770879730724573`*^9}, {
   3.877088003441382*^9, 3.8770883601528*^9}, {3.8770884083492126`*^9, 
   3.877088427246805*^9}, {3.877089819355278*^9, 3.877089844373837*^9}, {
   3.8770899517052794`*^9, 3.87708997878941*^9}, {3.8770900210095863`*^9, 
   3.8770900328150253`*^9}, 3.8770906151099577`*^9, 3.877236801468814*^9, {
   3.8773184730153503`*^9, 3.877318550408924*^9}, {3.877370021135536*^9, 
   3.8773700227702208`*^9}, {3.877525491037469*^9, 3.877525530485752*^9}, 
   3.877534698066868*^9, 3.877584774111837*^9, {3.8776095680056133`*^9, 
   3.877609633241149*^9}, 3.8791492256942167`*^9, {3.879485061762589*^9, 
   3.879485071725688*^9}, {3.9248310865690536`*^9, 3.9248311409150257`*^9}, {
   3.92483139617774*^9, 3.924831398479141*^9}, 3.9248988012006283`*^9, {
   3.92536641812414*^9, 3.92536642100782*^9}, {3.9253664572162733`*^9, 
   3.9253664668374567`*^9}, 3.92537123805435*^9, {3.925379757956168*^9, 
   3.925379758595614*^9}, {3.9253797945113783`*^9, 3.925379807113245*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"c8955a8a-c9ac-4adc-a6e9-9de99bf086ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"sanity", " ", 
     RowBox[{"check", ":", " ", 
      RowBox[{
      "Have", " ", "included", " ", "all", " ", "the", " ", "terms", " ", 
       "of", " ", "variation", " ", "of", " ", "potential", " ", "in", " ", 
       "the", " ", "three", " ", "equations", " ", "equFirstOrd"}]}]}], ",", 
    " ", "eqvFirstOrd", ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"eqwFirstOrd", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{"doSanityCheck", ",", 
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"equFirstOrd", "+", "eqvFirstOrd", "+", "eqwFirstOrd"}], 
          ")"}], "-", "eqToSolveForFirstOrdDis"}], "]"}], "==", "0"}], 
      "]"}]}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8770832512980013`*^9, 3.877083258242156*^9}, {
   3.877083644876461*^9, 3.8770836735219717`*^9}, {3.877085437627351*^9, 
   3.877085453979806*^9}, {3.877085580733629*^9, 3.877085675922286*^9}, {
   3.877085710125102*^9, 3.877085853811496*^9}, {3.877085925894361*^9, 
   3.877085968998953*^9}, {3.877086098699175*^9, 3.877086272203559*^9}, {
   3.877086306402602*^9, 3.8770863657026567`*^9}, {3.877086514753149*^9, 
   3.8770866800938797`*^9}, {3.877086747648378*^9, 3.8770868146774893`*^9}, {
   3.877086858044056*^9, 3.877086872467382*^9}, {3.87708696448761*^9, 
   3.877086973860702*^9}, {3.877087080053789*^9, 3.877087080689988*^9}, {
   3.877087116417864*^9, 3.877087284882596*^9}, {3.877087327523135*^9, 
   3.877087458990073*^9}, {3.877087737120924*^9, 3.8770879730724573`*^9}, {
   3.877088003441382*^9, 3.8770883601528*^9}, {3.8770884083492126`*^9, 
   3.877088427246805*^9}, {3.877089819355278*^9, 3.877089844373837*^9}, {
   3.8770899517052794`*^9, 3.87708997878941*^9}, {3.8770900210095863`*^9, 
   3.8770900328150253`*^9}, 3.8770906151099577`*^9, 3.877236801468814*^9, {
   3.8773184730153503`*^9, 3.877318550408924*^9}, {3.877370021135536*^9, 
   3.8773700227702208`*^9}, {3.877525491037469*^9, 3.877525530485752*^9}, 
   3.877534698066868*^9, 3.877584774111837*^9, {3.8776095680056133`*^9, 
   3.877609633241149*^9}, 3.8791492256942167`*^9, {3.879485061762589*^9, 
   3.879485071725688*^9}, {3.9248310865690536`*^9, 3.9248311409150257`*^9}, {
   3.9248312353989162`*^9, 3.924831252706079*^9}, 3.924898796981745*^9, 
   3.925366422285626*^9, {3.9253664572174387`*^9, 3.9253664668386106`*^9}, {
   3.925371225632358*^9, 3.925371245913827*^9}, 3.925379947867847*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"b4c4b5ed-273f-47fa-ae9e-f7180c9edb23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"reorganize", " ", "eqwFirstOrd"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"eqwFirstOrd", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"eqwFirstOrd", " ", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uFirstOrd", "->", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"uFirstOrdSol", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"vFirstOrd", "[", 
            RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}], "->", " ", 
         "vFirstOrdDT"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Delta]wFirstOrd", "[", 
        RowBox[{"S", ",", "T"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Delta]wFirstOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Delta]wFirstOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"T", ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
     "FullSimplify"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8770832512980013`*^9, 3.877083258242156*^9}, {
   3.877083644876461*^9, 3.8770836735219717`*^9}, {3.877085437627351*^9, 
   3.877085453979806*^9}, {3.877085580733629*^9, 3.877085675922286*^9}, {
   3.877085710125102*^9, 3.877085853811496*^9}, {3.877085925894361*^9, 
   3.877085968998953*^9}, {3.877086098699175*^9, 3.877086272203559*^9}, {
   3.877086306402602*^9, 3.8770863657026567`*^9}, {3.877086514753149*^9, 
   3.8770866800938797`*^9}, {3.877086747648378*^9, 3.8770868146774893`*^9}, {
   3.877086858044056*^9, 3.877086872467382*^9}, {3.87708696448761*^9, 
   3.877086973860702*^9}, {3.877087080053789*^9, 3.877087080689988*^9}, {
   3.877087116417864*^9, 3.877087284882596*^9}, {3.877087327523135*^9, 
   3.877087458990073*^9}, {3.877087737120924*^9, 3.8770879730724573`*^9}, {
   3.877088003441382*^9, 3.8770883601528*^9}, {3.8770884083492126`*^9, 
   3.877088427246805*^9}, {3.877089819355278*^9, 3.877089844373837*^9}, {
   3.8770899517052794`*^9, 3.87708997878941*^9}, {3.8770900210095863`*^9, 
   3.8770900328150253`*^9}, 3.8770906151099577`*^9, 3.877236801468814*^9, {
   3.8773184730153503`*^9, 3.877318550408924*^9}, {3.877370021135536*^9, 
   3.8773700227702208`*^9}, {3.877525491037469*^9, 3.877525530485752*^9}, 
   3.877534698066868*^9, 3.877584774111837*^9, {3.8776095680056133`*^9, 
   3.877609633241149*^9}, 3.8791492256942167`*^9, {3.879485061762589*^9, 
   3.879485071725688*^9}, {3.9248310865690536`*^9, 3.9248311409150257`*^9}, {
   3.9248312353989162`*^9, 3.924831331956874*^9}, {3.924831402106608*^9, 
   3.9248314045041847`*^9}, 3.924898793210532*^9, {3.925366423020914*^9, 
   3.925366423982041*^9}, {3.925366457218792*^9, 3.9253664668413277`*^9}, 
   3.925371238057036*^9, {3.9253799295043383`*^9, 3.9253799461181602`*^9}, 
   3.925388496568572*^9},
 CellLabel->"In[85]:=",ExpressionUUID->"b8c3c632-c2cb-4e7f-8efc-298094c1b0ea"],

Cell[CellGroupData[{

Cell[" Calculation of differential equation for wFirstOrd", "Subsubsection",
 CellChangeTimes->{{3.8770832512980013`*^9, 3.877083258242156*^9}, {
   3.877083644876461*^9, 3.8770836735219717`*^9}, {3.877085437627351*^9, 
   3.877085453979806*^9}, {3.877085580733629*^9, 3.877085675922286*^9}, {
   3.877085710125102*^9, 3.877085853811496*^9}, {3.877085925894361*^9, 
   3.877085968998953*^9}, {3.877086098699175*^9, 3.877086272203559*^9}, {
   3.877086306402602*^9, 3.8770863657026567`*^9}, {3.877086514753149*^9, 
   3.8770866800938797`*^9}, {3.877086747648378*^9, 3.8770868146774893`*^9}, {
   3.877086858044056*^9, 3.877086872467382*^9}, {3.87708696448761*^9, 
   3.877086973860702*^9}, {3.877087080053789*^9, 3.877087080689988*^9}, {
   3.877087116417864*^9, 3.877087284882596*^9}, {3.877087327523135*^9, 
   3.877087458990073*^9}, {3.877087737120924*^9, 3.8770879730724573`*^9}, {
   3.877088003441382*^9, 3.8770883601528*^9}, {3.8770884083492126`*^9, 
   3.877088427246805*^9}, {3.877089819355278*^9, 3.877089844373837*^9}, {
   3.8770899517052794`*^9, 3.87708997878941*^9}, {3.8770900210095863`*^9, 
   3.8770900328150253`*^9}, 3.8770906151099577`*^9, 3.877236801468814*^9, {
   3.8773184730153503`*^9, 3.877318550408924*^9}, {3.877370021135536*^9, 
   3.8773700227702208`*^9}, {3.877525491037469*^9, 3.877525530485752*^9}, 
   3.877534698066868*^9, 3.877584774111837*^9, 3.8776095680056133`*^9, {
   3.9248321058619337`*^9, 3.924832110379684*^9}, {3.925366424149308*^9, 
   3.9253664258735123`*^9}, {3.9253712380594997`*^9, 3.925371238151353*^9}, {
   3.9253843352232122`*^9, 
   3.9253843767606993`*^9}},ExpressionUUID->"3ee22ce2-7343-4208-99c4-\
ebdb719cd82a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"coeffwFirstOrd", " ", "\[Delta]wFirstOrd"}], " ", "+", " ", 
        RowBox[{"coeffwFirstOrdDT", " ", 
         SubscriptBox["\[Delta]wFirstOrd", 
          RowBox[{",", "T"}]]}], " ", "+", " ", 
        RowBox[{"coeffwFirstOrdD2T", " ", 
         SubscriptBox["\[Delta]wFirstOrd", 
          RowBox[{",", "TT"}]]}]}], ")"}], " ", "dT"}]}], "=", "0"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"we", " ", "can", " ", "write", " ", 
  RowBox[{
   SuperscriptBox[
    SubscriptBox["\[Integral]", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]], 
    RowBox[{"1", "/", "2"}]], " ", 
   RowBox[{"coeffwFirstOrdD2T", " ", 
    SubscriptBox["\[Delta]wFirstOrd", 
     RowBox[{",", "TT"}]], " ", "dT", " ", 
    "as"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Integral]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]], 
     RowBox[{"1", "/", "2"}]], " ", 
    RowBox[{"coeffwFirstOrdD2T", " ", 
     SubscriptBox["\[Delta]wFirstOrd", 
      RowBox[{",", "TT"}]], " ", "dT"}]}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], " ", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{"coeffwFirstOrdD2T", " ", 
         SubscriptBox["\[Delta]wFirstOrd", 
          RowBox[{",", "T"}]]}], ")"}], 
       RowBox[{",", "T"}]], " ", "dT"}]}], " ", "-", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], " ", 
     RowBox[{
      SubscriptBox["coeffwFirstOrdD2T", 
       RowBox[{",", "T"}]], " ", 
      SubscriptBox["\[Delta]wFirstOrd", 
       RowBox[{",", "T"}]], " ", "dT"}]}]}]}], ",", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Integral]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]], 
     RowBox[{"1", "/", "2"}]], " ", 
    RowBox[{"coeffwFirstOrdD2T", " ", 
     SubscriptBox["\[Delta]wFirstOrd", 
      RowBox[{",", "TT"}]], " ", "dT"}]}], " ", "=", " ", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox[
      RowBox[{"[", 
       RowBox[{"coeffwFirstOrdD2T", " ", 
        SubscriptBox["\[Delta]wFirstOrd", 
         RowBox[{",", "T"}]]}], "]"}], 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}]], 
     RowBox[{"T", "=", 
      RowBox[{"1", "/", "2"}]}]], " ", "-", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}]], 
      RowBox[{"T", "=", 
       RowBox[{"1", "/", "2"}]}]], " ", 
     RowBox[{
      SubscriptBox["coeffwFirstOrdD2T", 
       RowBox[{",", "T"}]], " ", 
      SubscriptBox["\[Delta]wFirstOrd", 
       RowBox[{",", "T"}]], " ", "dT"}]}]}]}], ",", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "this", " ", "gives", " ", "first", " ", "natural", " ", "boundary", " ", 
    "condition", " ", "as", " ", 
    RowBox[{"coeffwFirstOrdD2T", "[", 
     RowBox[{"S", ",", 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}]}], "]"}]}], " ", "=", " ",
    "0"}], ",", " ", 
  RowBox[{"on", " ", "clubbing", " ", "terms"}], ",", " ", 
  RowBox[{
  "which", " ", "can", " ", "be", " ", "rewritten", " ", 
   "as"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["wFirstOrd", 
     RowBox[{",", "TT"}]], " ", "=", " ", 
    RowBox[{
     RowBox[{"D2wFirstOrdBc", " ", "at", " ", "T"}], "=", 
     RowBox[{
      RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"on", " ", "setting", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], " ", 
     RowBox[{"coeffwFirstOrdD2T", " ", 
      SubscriptBox["\[Delta]wFirstOrd", 
       RowBox[{",", "TT"}]], " ", "dT"}]}]}], " ", "=", 
   RowBox[{"-", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], " ", 
     RowBox[{
      SubscriptBox["coeffwFirstOrdD2T", 
       RowBox[{",", "T"}]], " ", 
      SubscriptBox["\[Delta]wFirstOrd", 
       RowBox[{",", "T"}]], " ", "dT"}]}]}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "in", " ", "the", " ", "initial", " ", "equation", " ", "above", " ", 
    "and", " ", "clubbing", " ", "the", " ", "terms", " ", "with", " ", 
    "factor", " ", 
    SubscriptBox["\[Delta]wFirstOrd", 
     RowBox[{",", "T"}]]}], ",", " ", 
   RowBox[{"we", " ", "get"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Integral]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]], 
     RowBox[{"1", "/", "2"}]], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"coeffwFirstOrdDT", " ", "-", " ", 
       SubscriptBox["coeffwFirstOrdD2T", 
        RowBox[{",", "T"}]]}], ")"}], " ", 
     SubscriptBox["\[Delta]wFirstOrd", 
      RowBox[{",", "T"}]], " ", "dT"}]}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["coeffwFirstOrdD2T", 
         RowBox[{",", "TT"}]], "-", " ", 
        SubscriptBox["coeffwFirstOrdDT", 
         RowBox[{",", "T"}]]}], ")"}], " ", "\[Delta]wFirstOrd", " ", 
      "dT"}]}], " ", "-", " ", 
    SuperscriptBox[
     SubscriptBox[
      RowBox[{"[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["coeffwFirstOrdD2T", 
           RowBox[{",", "T"}]], "-", " ", "coeffwFirstOrdDT"}], ")"}], 
        "\[Delta]wFirstOrd"}], "]"}], 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}]], 
     RowBox[{"T", "=", 
      RowBox[{"1", "/", "2"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "this", " ", "gives", " ", "the", " ", "second", " ", "natural", " ", 
     "boundary", " ", "condition", " ", "as", " ", 
     SubscriptBox["coeffwFirstOrdD2T", 
      RowBox[{",", "T"}]]}], "-", " ", "coeffwFirstOrdDT"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"0", " ", "at", " ", "T"}], "=", 
    RowBox[{
     RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}]}], ",", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "which", " ", "can", " ", "be", " ", "rewritten", " ", "as", " ", 
     SubscriptBox["wFirstOrd", 
      RowBox[{",", "TTT"}]]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"D3wFirstOrdBc", " ", "at", " ", "T"}], "=", 
     RowBox[{
      RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"on", " ", "using", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"coeffwFirstOrdDT", " ", "-", " ", 
        SubscriptBox["coeffwFirstOrdD2T", 
         RowBox[{",", "T"}]]}], ")"}], " ", 
      SubscriptBox["\[Delta]wFirstOrd", 
       RowBox[{",", "T"}]], " ", "dT"}]}]}], " ", "=", " ", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Integral]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]], 
     RowBox[{"1", "/", "2"}]], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["coeffwFirstOrdD2T", 
        RowBox[{",", "TT"}]], "-", " ", 
       SubscriptBox["coeffwFirstOrdDT", 
        RowBox[{",", "T"}]]}], ")"}], " ", "\[Delta]wFirstOrd", " ", 
     "dT"}]}]}], ",", " ", 
  RowBox[{
  "we", " ", "can", " ", "rewrite", " ", "the", " ", "inital", " ", 
   "equation", " ", "as"}]}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], 
      RowBox[{"1", "/", "2"}]], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"coeffwFirstOrd", " ", "-", " ", 
        SubscriptBox["coeffwFirstOrdDT", 
         RowBox[{",", "T"}]], " ", "+", " ", 
        SubscriptBox["coeffwFirstOrdD2T", 
         RowBox[{",", "TT"}]]}], ")"}], "\[Delta]wFirstOrd", " ", "dT"}]}], 
    "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"on", " ", "rearranging", " ", "the", " ", "terms"}], ",", " ", 
   RowBox[{
   "we", " ", "get", " ", "the", " ", "differential", " ", "equation", " ", 
    "for", " ", "wFirstOrd", " ", "as"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["wFirstOrd", 
    RowBox[{",", "TTTT"}]], " ", "=", " ", 
   RowBox[{"nonHomwFirstOrd", " ", "+", " ", "fNSecondOrd", " ", "+", " ", 
    RowBox[{"T", " ", "gNSecondOrd"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "intergrating", " ", "the", " ", "above", " ", "equation", " ", "along", 
    " ", "T", " ", "from"}], " ", "-", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", "to", " ", 
    RowBox[{"1", "/", "2"}]}]}], ",", " ", 
  RowBox[{
  "we", " ", "calculate", " ", "fNSecondOrd"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNSecondOrd", "=", " ", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox[
      RowBox[{"[", 
       RowBox[{
        SubscriptBox["wFirstOrd", 
         RowBox[{",", "TTT"}]], "-", "inonHomwFirstOrd"}], "]"}], 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}]], 
     RowBox[{"T", "=", 
      RowBox[{"1", "/", "2"}]}]], " ", "=", " ", 
    SuperscriptBox[
     SubscriptBox[
      RowBox[{"[", 
       RowBox[{"D3wFirstOrdBc", "-", "inonHomwFirstOrd"}], "]"}], 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}]], 
     RowBox[{"T", "=", 
      RowBox[{"1", "/", "2"}]}]]}]}], " ", ",", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"where", " ", 
     RowBox[{"inonHomwFirstOrd", "[", "T", "]"}]}], " ", "=", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Integral]", "0"], "T"], " ", 
     RowBox[{
      RowBox[{"nonHomwFirstOrd", "[", 
       RowBox[{"S", ",", "m"}], "]"}], " ", "dm"}]}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"we", " ", "multiply", " ", "the", " ", "differential", " ", 
  "equation", " ", "by", " ", "T"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", " ", 
    SubscriptBox["wFirstOrd", 
     RowBox[{",", "TTTT"}]]}], " ", "=", " ", 
   RowBox[{
    RowBox[{"T", " ", "nonHomwFirstOrd"}], " ", "+", " ", 
    RowBox[{"T", " ", "fNSecondOrd"}], " ", "+", " ", 
    RowBox[{
     SuperscriptBox["T", "2"], " ", "gNSecondOrd"}]}]}], ",", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{"T", " ", 
       SubscriptBox["wFirstOrd", 
        RowBox[{",", "TTT"}]]}], ")"}], 
     RowBox[{",", "T"}]], " ", "-", " ", 
    SubscriptBox["wFirstOrd", 
     RowBox[{",", "TTT"}]], " ", "-", " ", 
    RowBox[{"T", " ", "nonHomwFirstOrd"}]}], " ", "=", " ", 
   RowBox[{
    RowBox[{"T", " ", "fNSecondOrd"}], " ", "+", " ", 
    RowBox[{
     SuperscriptBox["T", "2"], " ", "gNSecondOrd"}]}]}], ",", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "on", " ", "integrating", " ", "the", " ", "above", " ", "equation", " ", 
     "along", " ", "T", " ", "from"}], " ", "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "to", " ", 
     RowBox[{"1", "/", "2"}], " ", "and", " ", "using", " ", "the", " ", 
     "first", " ", "natural", " ", "and", " ", "second", " ", "boundary", " ",
      "conditions", " ", "and", " ", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Integral]", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       RowBox[{"1", "/", "2"}]], " ", 
      RowBox[{"T", " ", "wFirstOrd", " ", "dT"}]}]}]}], " ", "=", " ", "0"}], 
  ",", " ", 
  RowBox[{"we", " ", "get", " ", "gN", " ", "FirstOrd"}]}]}], "Text",
 CellChangeTimes->{{3.8770832512980013`*^9, 3.877083258242156*^9}, {
   3.877083644876461*^9, 3.8770836735219717`*^9}, {3.877085437627351*^9, 
   3.877085453979806*^9}, {3.877085580733629*^9, 3.877085675922286*^9}, {
   3.877085710125102*^9, 3.877085853811496*^9}, {3.877085925894361*^9, 
   3.877085968998953*^9}, {3.877086098699175*^9, 3.877086272203559*^9}, {
   3.877086306402602*^9, 3.8770863657026567`*^9}, {3.877086514753149*^9, 
   3.8770866800938797`*^9}, {3.877086747648378*^9, 3.8770868146774893`*^9}, {
   3.877086858044056*^9, 3.877086872467382*^9}, {3.87708696448761*^9, 
   3.877086973860702*^9}, {3.877087080053789*^9, 3.877087080689988*^9}, {
   3.877087116417864*^9, 3.877087284882596*^9}, {3.877087327523135*^9, 
   3.877087458990073*^9}, {3.877087737120924*^9, 3.8770879730724573`*^9}, {
   3.877088003441382*^9, 3.8770883601528*^9}, {3.8770884083492126`*^9, 
   3.877088427246805*^9}, {3.877089819355278*^9, 3.877089844373837*^9}, {
   3.8770899517052794`*^9, 3.87708997878941*^9}, {3.8770900210095863`*^9, 
   3.8770900328150253`*^9}, 3.8770906151099577`*^9, 3.877236801468814*^9, {
   3.8773184730153503`*^9, 3.877318550408924*^9}, {3.877370021135536*^9, 
   3.8773700227702208`*^9}, {3.877525491037469*^9, 3.877525530485752*^9}, 
   3.877534698066868*^9, 3.877584774111837*^9, 3.8776095680056133`*^9, {
   3.9248321058619337`*^9, 3.924832110379684*^9}, {3.925366424149308*^9, 
   3.9253664258735123`*^9}, {3.9253712380594997`*^9, 3.925371238151353*^9}, {
   3.9253843352232122`*^9, 3.925384361687632*^9}, {3.9253854091369*^9, 
   3.925385437757359*^9}, {3.925385488873672*^9, 3.925385559704088*^9}, {
   3.925386449326283*^9, 3.925386494736993*^9}, {3.9253880849683867`*^9, 
   3.925388142236055*^9}, {3.9253883619705667`*^9, 3.9253884553900957`*^9}, {
   3.925388516511458*^9, 3.925388831922936*^9}, {3.925388944808785*^9, 
   3.92538895422554*^9}, 3.9253890523312607`*^9, {3.925631723651931*^9, 
   3.9256317498992147`*^9}, {3.926993302023172*^9, 
   3.92699330203538*^9}},ExpressionUUID->"e3043436-695c-4995-b16d-\
b6265b976d2b"],

Cell[BoxData[
 RowBox[{"gNSecondOrd", " ", "=", " ", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox[
      RowBox[{"12", " ", "[", 
       RowBox[{
        RowBox[{"T", " ", "D3wFirstOrdBc"}], " ", "-", " ", "D2wFirstOrdBc", 
        " ", "-", " ", "iTnonHomwFirstOrd"}], "]"}], 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]], 
     RowBox[{"1", "/", "2"}]], " ", "where", " ", 
    RowBox[{"iTnonHomwFirstOrd", "[", "T", "]"}]}], " ", "=", " ", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Integral]", "0"], "T"], " ", 
    RowBox[{"m", " ", 
     RowBox[{"nonHomwFirstOrd", "[", "m", "]"}], " ", "dm"}]}]}]}]], "Text",
 CellChangeTimes->{{3.8770832512980013`*^9, 3.877083258242156*^9}, {
   3.877083644876461*^9, 3.8770836735219717`*^9}, {3.877085437627351*^9, 
   3.877085453979806*^9}, {3.877085580733629*^9, 3.877085675922286*^9}, {
   3.877085710125102*^9, 3.877085853811496*^9}, {3.877085925894361*^9, 
   3.877085968998953*^9}, {3.877086098699175*^9, 3.877086272203559*^9}, {
   3.877086306402602*^9, 3.8770863657026567`*^9}, {3.877086514753149*^9, 
   3.8770866800938797`*^9}, {3.877086747648378*^9, 3.8770868146774893`*^9}, {
   3.877086858044056*^9, 3.877086872467382*^9}, {3.87708696448761*^9, 
   3.877086973860702*^9}, {3.877087080053789*^9, 3.877087080689988*^9}, {
   3.877087116417864*^9, 3.877087284882596*^9}, {3.877087327523135*^9, 
   3.877087458990073*^9}, {3.877087737120924*^9, 3.8770879730724573`*^9}, {
   3.877088003441382*^9, 3.8770883601528*^9}, {3.8770884083492126`*^9, 
   3.877088427246805*^9}, {3.877089819355278*^9, 3.877089844373837*^9}, {
   3.8770899517052794`*^9, 3.87708997878941*^9}, {3.8770900210095863`*^9, 
   3.8770900328150253`*^9}, 3.8770906151099577`*^9, 3.877236801468814*^9, {
   3.8773184730153503`*^9, 3.877318550408924*^9}, {3.877370021135536*^9, 
   3.8773700227702208`*^9}, {3.877525491037469*^9, 3.877525530485752*^9}, 
   3.877534698066868*^9, 3.877584774111837*^9, 3.8776095680056133`*^9, {
   3.9248321058619337`*^9, 3.924832110379684*^9}, {3.925366424149308*^9, 
   3.9253664258735123`*^9}, {3.9253712380594997`*^9, 3.925371238151353*^9}, {
   3.9253843352232122`*^9, 3.925384361687632*^9}, {3.9253854091369*^9, 
   3.925385437757359*^9}, {3.925385488873672*^9, 3.925385559704088*^9}, {
   3.925386449326283*^9, 3.925386494736993*^9}, {3.9253880849683867`*^9, 
   3.925388142236055*^9}, {3.9253883619705667`*^9, 3.9253884553900957`*^9}, {
   3.925388516511458*^9, 3.925388831922936*^9}, {3.925388944808785*^9, 
   3.92538895422554*^9}, {3.925389001761611*^9, 3.925389002345099*^9}, {
   3.925389093855826*^9, 3.92538910494779*^9}, 3.9256317499004717`*^9, {
   3.926993302037669*^9, 
   3.92699330203855*^9}},ExpressionUUID->"1df25e66-90e8-4817-b616-\
7203d2951504"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "collect", " ", "coefficient", " ", "of", " ", "\[Delta]wFirstOrd", " ", 
    "in", " ", "the", " ", "variation"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"coeffwFirstOrd", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"eqwFirstOrd", ",", 
        RowBox[{"\[Delta]wFirstOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"collect", " ", "coefficient", " ", "of", " ", 
     SubscriptBox["\[Delta]wFirstOrd", 
      RowBox[{",", "T"}]], " ", "in", " ", "the", " ", "variation"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffwFirstOrdDT", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"eqwFirstOrd", ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Delta]wFirstOrd", "[", 
           RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"collect", " ", "coefficient", " ", "of", " ", 
     SubscriptBox["\[Delta]wFirstOrd", 
      RowBox[{",", "TT"}]], " ", "in", " ", "the", " ", "variation"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffwFirstOrdD2T", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"eqwFirstOrd", ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Delta]wFirstOrd", "[", 
           RowBox[{"S", ",", "T"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "2"}], "}"}]}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"sanity", " ", 
     RowBox[{"check", ":", " ", 
      RowBox[{"only", " ", "three", " ", "terms", " ", 
       RowBox[{"(", 
        RowBox[{
        "coeffwFirstOrd", ",", " ", "coeffwFirstOrdDT", ",", " ", 
         "coeffwFirstOrdD2T"}], ")"}], " ", "are", " ", "associated", " ", 
       "with", " ", "\[Delta]wFirstOrd", " ", "and", " ", "its", " ", 
       "derivatives", " ", "in", " ", "the", " ", "variation", " ", "of", " ",
        "potential"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{"doSanityCheck", ",", 
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"coeffwFirstOrd", " ", 
          RowBox[{"\[Delta]wFirstOrd", "[", 
           RowBox[{"S", ",", "T"}], "]"}]}], " ", "+", " ", 
         RowBox[{"coeffwFirstOrdDT", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Delta]wFirstOrd", "[", 
             RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}]}], "+", " ", 
         RowBox[{"coeffwFirstOrdD2T", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Delta]wFirstOrd", "[", 
             RowBox[{"S", ",", "T"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"T", ",", "2"}], "}"}]}], "]"}]}], "-", "eqwFirstOrd"}], 
        "]"}], "==", "0"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8770832512980013`*^9, 3.877083258242156*^9}, {
   3.877083644876461*^9, 3.8770836735219717`*^9}, 3.877085437627351*^9, {
   3.877085527687989*^9, 3.8770855391938057`*^9}, {3.877090064011057*^9, 
   3.877090072137437*^9}, {3.877355083265671*^9, 3.877355098270568*^9}, {
   3.877509456051759*^9, 3.877509456771614*^9}, {3.8775339810261993`*^9, 
   3.877533999733696*^9}, {3.877534321235874*^9, 3.877534332253212*^9}, {
   3.877595908760811*^9, 3.8775959225142*^9}, {3.877609579652556*^9, 
   3.877609584397738*^9}, {3.877609656907341*^9, 3.877609676992401*^9}, {
   3.877609722692503*^9, 3.87760972322968*^9}, {3.8794851976093493`*^9, 
   3.879485200643304*^9}, {3.9248321208695383`*^9, 3.92483232178234*^9}, {
   3.924898778981412*^9, 3.924898784209917*^9}, {3.925366426008069*^9, 
   3.925366428213818*^9}, {3.9253712381530437`*^9, 3.925371238157423*^9}, {
   3.925385491516333*^9, 3.925385542140723*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"41add999-f54f-4a28-b2ee-e123f705ddb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "differential", " ", "equation", " ", "for", " ", 
    "wFirstOrd"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"diffEqnwFirstOrd", "=", 
    RowBox[{"Collect", "[", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"coeffwFirstOrdD2T", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "2"}], "}"}]}], "]"}], "-", " ", 
        RowBox[{"D", "[", 
         RowBox[{"coeffwFirstOrdDT", ",", "T"}], "]"}], "+", 
        "coeffwFirstOrd"}], ")"}], " ", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"S", ",", "T"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"S", ",", "T"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "2"}], "}"}]}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"S", ",", "T"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"S", ",", "T"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "4"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"fNSecondOrd", "[", "S", "]"}], ",", 
        RowBox[{
         RowBox[{"gNSecondOrd", "[", "S", "]"}], " ", "T"}]}], "}"}], ",", 
      "FullSimplify"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8770891285299253`*^9, 3.877089141957427*^9}, {
   3.877089179799315*^9, 3.877089205343918*^9}, {3.877141643090095*^9, 
   3.877141645977737*^9}, {3.877152813483418*^9, 3.87715282981149*^9}, 
   3.877238048647299*^9, 3.877533846703479*^9, {3.877533909324963*^9, 
   3.877533942070517*^9}, {3.924832385221051*^9, 3.924832513026713*^9}, 
   3.924898771797688*^9, {3.925366428367482*^9, 3.9253664288273487`*^9}, {
   3.92536676871061*^9, 3.925366782040203*^9}, 3.925371238158453*^9, {
   3.925389141149118*^9, 3.92538914639821*^9}, {3.925631723660214*^9, 
   3.925631749901924*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"4b9a4641-02fd-47de-96af-0b16a49a2b18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"natural", " ", "boundary", " ", 
     RowBox[{"condition", ":", " ", 
      RowBox[{
       SubscriptBox["wFirstOrd", 
        RowBox[{",", "TT"}]], "[", 
       RowBox[{"S", ",", 
        RowBox[{"T", "=", 
         RowBox[{
          RowBox[{"\[PlusMinus]", "1"}], "/", "2"}]}]}], "]"}]}]}], " ", "=", 
    " ", 
    RowBox[{"D2wFirstOrdBc", "[", 
     RowBox[{"S", ",", 
      RowBox[{"T", "\[PlusMinus]", 
       RowBox[{"1", "/", "2"}]}]}], "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"D2wFirstOrdBc", "[", 
     RowBox[{"S_", ",", "T_"}], "]"}], " ", "=", 
    RowBox[{
     RowBox[{"-", "coeffwFirstOrdD2T"}], " ", "+", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"wFirstOrd", "[", 
        RowBox[{"S", ",", "T"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"T", ",", "2"}], "}"}]}], "]"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.877089562591235*^9, 3.877089569126189*^9}, {
   3.8770896870607853`*^9, 3.877089695061591*^9}, {3.87708973849051*^9, 
   3.877089746221363*^9}, {3.877090099471476*^9, 3.877090120472905*^9}, {
   3.877090241011812*^9, 3.877090282226797*^9}, {3.877090396797496*^9, 
   3.877090400993243*^9}, {3.877090481341448*^9, 3.877090500834477*^9}, 
   3.877142108123414*^9, {3.8771425768765*^9, 3.877142577870945*^9}, {
   3.877142674824102*^9, 3.8771426764694967`*^9}, {3.877143793849131*^9, 
   3.877143809649416*^9}, 3.877241121997622*^9, {3.877242050798092*^9, 
   3.877242058127234*^9}, {3.877609746237728*^9, 3.877609773212462*^9}, {
   3.924834345114421*^9, 3.9248343871764193`*^9}, {3.9248344260018377`*^9, 
   3.924834426613186*^9}, 3.924898768237879*^9, {3.925366428966422*^9, 
   3.9253664292749987`*^9}, {3.925371238159581*^9, 3.9253712381604567`*^9}, {
   3.925385439138359*^9, 3.925385439775526*^9}, {3.925389308622241*^9, 
   3.925389364869938*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"6fbe3bf5-092c-45ec-b58d-4dec629e0185"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"natural", " ", "boundary", " ", 
     RowBox[{"condition", ":", " ", 
      RowBox[{
       SubscriptBox["wFirstOrd", 
        RowBox[{",", "TTT"}]], "[", 
       RowBox[{"S", ",", 
        RowBox[{"T", "\[PlusMinus]", 
         RowBox[{"1", "/", "2"}]}]}], "]"}]}]}], " ", "=", " ", 
    RowBox[{"D3wFirstOrdBc", "[", 
     RowBox[{"S", ",", 
      RowBox[{"T", "\[PlusMinus]", 
       RowBox[{"1", "/", "2"}]}]}], "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"D3wFirstOrdBc", "[", 
     RowBox[{"S_", ",", "T_"}], "]"}], " ", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"D", "[", 
           RowBox[{"coeffwFirstOrdD2T", ",", "T"}], "]"}]}], "+", 
         "coeffwFirstOrdDT"}], ")"}], ")"}], " ", "+", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"wFirstOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.877089562591235*^9, 3.877089569126189*^9}, {
   3.8770896870607853`*^9, 3.877089695061591*^9}, {3.87708973849051*^9, 
   3.877089746221363*^9}, {3.877090099471476*^9, 3.877090120472905*^9}, {
   3.877090241011812*^9, 3.877090282226797*^9}, {3.877090396797496*^9, 
   3.877090400993243*^9}, {3.877090481341448*^9, 3.877090500834477*^9}, 
   3.877142108123414*^9, {3.8771425768765*^9, 3.877142577870945*^9}, {
   3.877142674824102*^9, 3.8771426764694967`*^9}, {3.877143793849131*^9, 
   3.877143809649416*^9}, 3.877241121997622*^9, {3.877242050798092*^9, 
   3.877242058127234*^9}, {3.877609746237728*^9, 3.877609773212462*^9}, 
   3.924834345114421*^9, 3.92483441904956*^9, {3.924835566875229*^9, 
   3.924835618927417*^9}, {3.924835675117112*^9, 3.924835676745015*^9}, {
   3.9248458952055883`*^9, 3.924845895795034*^9}, 3.924898764578424*^9, {
   3.9253664294474087`*^9, 3.925366429950886*^9}, {3.925371238161605*^9, 
   3.925371238162487*^9}, {3.925385440405052*^9, 3.9253854410512877`*^9}, {
   3.9253893403708277`*^9, 3.925389375001857*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"6d0b9b47-f219-4d08-a0d0-d6790a9f8d5a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "We", " ", "want", " ", "the", " ", "differential", " ", "equation", " ", 
     "diffEqnwFirstOrd", " ", "in", " ", "this", " ", "form", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wFirstOrd", 
       RowBox[{",", "TTTT"}]], "[", 
      RowBox[{"S", ",", "T"}], "]"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"nonHomwFirstOrd", "[", 
      RowBox[{"S", ",", "T"}], "]"}], " ", "+", " ", 
     RowBox[{"fNSecondOrd", "[", "S", "]"}], " ", "+", " ", 
     RowBox[{"T", " ", 
      RowBox[{"gNSecondOrd", "[", "S", "]"}]}]}]}], ";", 
   RowBox[{
    RowBox[{"we", " ", "calculate", " ", "the", " ", "non"}], "-", 
    RowBox[{"homogeneous", " ", "part", " ", 
     RowBox[{"nonHomwFirstOrd", "[", 
      RowBox[{"S", ",", "T"}], "]"}], " ", "as"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.8770905772393637`*^9, 3.877090590490191*^9}, {
   3.877090650464807*^9, 3.877090708082748*^9}, {3.877090811568214*^9, 
   3.877090837731523*^9}, {3.8770909495826807`*^9, 3.877090961256481*^9}, 
   3.8770911229469337`*^9, {3.877091739338058*^9, 3.877091769033226*^9}, 
   3.877227912430646*^9, {3.877238313086899*^9, 3.877238313584899*^9}, {
   3.877242224693309*^9, 3.877242236244573*^9}, 3.8775347140870657`*^9, 
   3.877609850937215*^9, {3.924845800248341*^9, 3.924845830993655*^9}, 
   3.9253664301059017`*^9, {3.925366768712673*^9, 3.925366782042036*^9}, {
   3.925371238163463*^9, 3.925371238165207*^9}, {3.9253893796826067`*^9, 
   3.925389401812035*^9}, {3.925631723662098*^9, 3.9256317499030123`*^9}, 
   3.926993302044424*^9},ExpressionUUID->"21a39eb6-8dba-43da-a4fa-\
baff0e6ac53e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nonHomwFirstOrd", "[", 
    RowBox[{"S_", ",", "T_"}], "]"}], " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{"Simplify", "[", 
     RowBox[{"diffEqnwFirstOrd", " ", "-", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"wFirstOrd", "[", 
           RowBox[{"S", ",", "T"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "4"}], "}"}]}], "]"}], " ", "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fNSecondOrd", "[", "S", "]"}], "+", 
          RowBox[{
           RowBox[{"gNSecondOrd", "[", "S", "]"}], " ", "T"}]}], ")"}]}], 
       ")"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.877091781125448*^9, 3.877091888426427*^9}, {
   3.877091933290057*^9, 3.877091964231841*^9}, {3.877092112690422*^9, 
   3.877092188145534*^9}, {3.87709374351624*^9, 3.877093744038048*^9}, 
   3.877094808457583*^9, {3.877101488024021*^9, 3.87710152009871*^9}, {
   3.8771083912698717`*^9, 3.877108394148438*^9}, {3.877142109998295*^9, 
   3.877142111468959*^9}, 3.877142262530881*^9, {3.877142579571145*^9, 
   3.877142587412951*^9}, {3.877142680911479*^9, 3.877142681878044*^9}, {
   3.877143826204718*^9, 3.877143849257901*^9}, 3.877227919453987*^9, {
   3.877242638470957*^9, 3.8772426566258993`*^9}, {3.9248456827355833`*^9, 
   3.92484569450865*^9}, {3.924845742960512*^9, 3.9248457645194807`*^9}, {
   3.9248464406155567`*^9, 3.924846441197419*^9}, 3.924898760463171*^9, {
   3.925366430274399*^9, 3.9253664306003227`*^9}, {3.9253667687155724`*^9, 
   3.9253667820439577`*^9}, {3.925389404640231*^9, 3.925389421838154*^9}, {
   3.925631723664124*^9, 3.9256317499041986`*^9}, {3.9269933020472307`*^9, 
   3.926993302048304*^9}},ExpressionUUID->"4f5be1fe-c7c9-4764-8e82-\
d442d4d9776f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fNSecondOrdExp", " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"D3wFirstOrdBc", "[", 
       RowBox[{"S", ",", 
        FractionBox["1", "2"]}], "]"}], "-", 
      RowBox[{"D3wFirstOrdBc", "[", 
       RowBox[{"S", ",", 
        RowBox[{"-", 
         FractionBox["1", "2"]}]}], "]"}]}], ")"}], "-", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"nonHomwFirstOrd", "[", 
        RowBox[{"S", ",", "T"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[CurlyEpsilon]p", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[CurlyEpsilon]pfnExp", "[", "#", "]"}], "&"}], ")"}]}], 
        "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", 
        RowBox[{"-", 
         FractionBox["1", "2"]}], ",", 
        FractionBox["1", "2"]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.92484591314609*^9, 3.9248459312793703`*^9}, {
   3.9248461157191133`*^9, 3.924846118435755*^9}, {3.9248461904184713`*^9, 
   3.924846206791209*^9}, {3.9248464454384317`*^9, 3.924846446042652*^9}, 
   3.924898748992125*^9, {3.92536643076112*^9, 3.92536643109859*^9}, 
   3.925366768718532*^9, {3.9253894262497787`*^9, 3.92538944072442*^9}, 
   3.925631723666448*^9},
 CellLabel->"In[95]:=",ExpressionUUID->"0ccbce09-d9f3-4d28-a0f1-839d7c5cd8ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gNSecondOrdExp", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"12", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{" ", 
         RowBox[{"D3wFirstOrdBc", "[", 
          RowBox[{"S", ",", 
           RowBox[{"1", "/", "2"}]}], "]"}]}], "2"], "+", " ", 
       FractionBox[
        RowBox[{" ", 
         RowBox[{"D3wFirstOrdBc", "[", 
          RowBox[{"S", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "]"}]}], "2"], "-", 
       RowBox[{"D2wFirstOrdBc", "[", 
        RowBox[{"S", ",", 
         FractionBox["1", "2"]}], "]"}], "+", 
       RowBox[{"D2wFirstOrdBc", "[", 
        RowBox[{"S", ",", 
         RowBox[{"-", 
          FractionBox["1", "2"]}]}], "]"}], " ", "-", " ", 
       RowBox[{"Integrate", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"T", " ", 
           RowBox[{"nonHomwFirstOrd", "[", 
            RowBox[{"S", ",", "T"}], "]"}]}], " ", "/.", 
          RowBox[{"{", 
           RowBox[{"\[CurlyEpsilon]p", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CurlyEpsilon]pfnExp", "[", "#", "]"}], "&"}], 
             ")"}]}], "}"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"T", ",", 
           RowBox[{"-", 
            FractionBox["1", "2"]}], ",", 
           FractionBox["1", "2"]}], "}"}]}], "]"}]}], ")"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.92484636091284*^9, 3.924846452608266*^9}, {
   3.924846526837685*^9, 3.924846534745222*^9}, {3.92484659887433*^9, 
   3.924846600833735*^9}, 3.9248987460587673`*^9, {3.92536643126589*^9, 
   3.925366431955604*^9}, 3.925366782046609*^9, {3.925389449138378*^9, 
   3.925389503858345*^9}, 3.9253917921752253`*^9, 3.925631749907193*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"a49f11a8-f65e-41ee-af5e-f202a2dd27ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"differential", " ", "equation", " ", "for", " ", "wFirstOrd"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["wFirstOrd", 
       RowBox[{",", "TTTT"}]], "[", 
      RowBox[{"S", ",", "T"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"nonHomwFirstOrd", "[", 
       RowBox[{"S", ",", "T"}], "]"}], " ", "+", " ", "fNSecondOrd", " ", "+",
       " ", 
      RowBox[{"T", " ", "gNSecondOrd"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"D4wFirstOrd", "[", 
     RowBox[{"S_", ",", "T_"}], "]"}], "=", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"nonHomwFirstOrd", "[", 
         RowBox[{"S", ",", "T"}], "]"}], "+", "fNSecondOrdExp", "+", 
        RowBox[{"T", " ", "gNSecondOrdExp"}]}], " ", ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", 
        RowBox[{
         RowBox[{"\[Tau]", "'"}], "[", "S", "]"}]}], "}"}], ",", "Simplify"}],
      "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.877150489973415*^9, 3.87715053501407*^9}, {
   3.877151018461117*^9, 3.8771512155249987`*^9}, 3.877151293760796*^9, {
   3.877151420765995*^9, 3.877151437906726*^9}, 3.877242476103437*^9, 
   3.877243280579528*^9, {3.877243428363452*^9, 3.87724342876446*^9}, {
   3.877243484756441*^9, 3.877243520717288*^9}, {3.8772438259270487`*^9, 
   3.877243826250258*^9}, {3.87758483255179*^9, 3.8775848454377003`*^9}, 
   3.877584879151311*^9, {3.877584920776601*^9, 3.877584930672942*^9}, {
   3.924846629558423*^9, 3.9248466559303513`*^9}, {3.924846978006124*^9, 
   3.9248469794059887`*^9}, {3.925366432114169*^9, 3.925366432288293*^9}, {
   3.925366768720996*^9, 3.9253667820481*^9}, {3.925371238166226*^9, 
   3.9253712381679296`*^9}, {3.9253895221123343`*^9, 
   3.9253895458051243`*^9}, {3.92539087409409*^9, 3.925390878528597*^9}, {
   3.925631723668247*^9, 3.925631749909349*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"f5953fb0-7fca-4cfa-b983-174e468b9b36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rawwFirstOrdSol", "[", 
    RowBox[{"S_", ",", "T_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
    RowBox[{"DSolveValue", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"rawwFirstOrd", "[", "T", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"T", ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", "==", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"D4wFirstOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"\[CurlyEpsilon]p", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[CurlyEpsilon]pfnExp", "[", "#", "]"}], "&"}], ")"}]}],
           "}"}]}], ")"}]}], ",", " ", 
      RowBox[{"rawwFirstOrd", "[", "T", "]"}], ",", "T"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.925385317337888*^9, 3.925385337200522*^9}, {
   3.925385441713522*^9, 3.9253854525581493`*^9}, {3.925389565260398*^9, 
   3.9253897213176727`*^9}, 3.925390854971075*^9, 3.9253908945063677`*^9},
 CellLabel->"In[98]:=",ExpressionUUID->"40a9cf78-a89c-40e4-a06b-8e59208b8f24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"constantsC3C4Solved", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["rawwFirstOrdSol", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "3"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"S", ",", 
             FractionBox["1", "2"]}], "]"}], "-", 
           RowBox[{"D3wFirstOrdBc", "[", 
            RowBox[{"S", ",", 
             FractionBox["1", "2"]}], "]"}]}], "]"}], "==", "0"}], ",", " ", 
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["rawwFirstOrdSol", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "2"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"S", ",", 
             FractionBox["1", "2"]}], "]"}], "-", 
           RowBox[{"D2wFirstOrdBc", "[", 
            RowBox[{"S", ",", 
             FractionBox["1", "2"]}], "]"}]}], "]"}], "==", "0"}]}], "}"}], 
      ",", 
      RowBox[{"{", " ", 
       RowBox[{
        TemplateBox[{"3"},
         "C"], ",", " ", 
        TemplateBox[{"4"},
         "C"]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c3Exp", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     TemplateBox[{"3"},
      "C"], "/.", "constantsC3C4Solved"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c4Exp", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      TemplateBox[{"4"},
       "C"], "/.", "constantsC3C4Solved"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Two", " ", "other", " ", "boundary", " ", "conditions", " ", "at", " ", 
      "T"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], " ", "satisfies", " ", "the", " ", 
      TemplateBox[{"3"},
       "C"]}]}], ",", " ", 
    RowBox[{
     TemplateBox[{"4"},
      "C"], " ", "values", " ", "we", " ", "calculated"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"doSanityCheck", ",", 
   RowBox[{"CheckSanity", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["rawwFirstOrdSol", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "3"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"S", ",", 
             RowBox[{"-", 
              FractionBox["1", "2"]}]}], "]"}], "-", 
           RowBox[{"D3wFirstOrdBc", "[", 
            RowBox[{"S", ",", 
             RowBox[{"-", 
              FractionBox["1", "2"]}]}], "]"}]}], ")"}], ",", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["rawwFirstOrdSol", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "2"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"S", ",", 
             RowBox[{"-", 
              FractionBox["1", "2"]}]}], "]"}], "-", 
           RowBox[{"D2wFirstOrdBc", "[", 
            RowBox[{"S", ",", 
             RowBox[{"-", 
              FractionBox["1", "2"]}]}], "]"}]}], "]"}]}], "}"}], "/.", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{
          TemplateBox[{"3"},
           "C"], "->", "c3Exp"}], ",", " ", 
         RowBox[{
          TemplateBox[{"4"},
           "C"], "->", "c4Exp"}]}], "}"}]}], "]"}], "==", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.925385317337888*^9, 3.925385337200522*^9}, {
   3.925385441713522*^9, 3.9253854525581493`*^9}, 3.925389565260398*^9, {
   3.925389697723474*^9, 3.925389697942078*^9}, {3.925389753421257*^9, 
   3.925389854844829*^9}, 3.925389893973329*^9, {3.9253900343964653`*^9, 
   3.92539008511598*^9}, {3.925390151175871*^9, 3.925390154126666*^9}, {
   3.925390239263932*^9, 3.925390279532115*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"71d0419f-b599-4b7e-adc8-d2dbba47cf49"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rawwFirstOrdSol", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"rawwFirstOrdSol", "[", 
       RowBox[{"S", ",", "T"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         TemplateBox[{"3"},
          "C"], "->", " ", "c3Exp"}], ",", 
        RowBox[{
         TemplateBox[{"4"},
          "C"], " ", "->", " ", "c4Exp"}]}], "}"}]}]}], ";"}], "\n", 
   RowBox[{"If", "[", 
    RowBox[{"doSanityCheck", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckSanity", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["rawwFirstOrdSol", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "3"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"S", ",", 
            FractionBox["1", "2"]}], "]"}], "-", 
          RowBox[{"D3wFirstOrdBc", "[", 
           RowBox[{"S", ",", 
            FractionBox["1", "2"]}], "]"}]}], "]"}], "==", "0"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckSanity", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["rawwFirstOrdSol", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "3"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"S", ",", 
            RowBox[{"-", 
             FractionBox["1", "2"]}]}], "]"}], "-", 
          RowBox[{"D3wFirstOrdBc", "[", 
           RowBox[{"S", ",", 
            RowBox[{"-", 
             FractionBox["1", "2"]}]}], "]"}]}], "]"}], "==", "0"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CheckSanity", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["rawwFirstOrdSol", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"S", ",", 
            FractionBox["1", "2"]}], "]"}], "-", 
          RowBox[{"D2wFirstOrdBc", "[", 
           RowBox[{"S", ",", 
            FractionBox["1", "2"]}], "]"}]}], "]"}], "==", "0"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckSanity", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["rawwFirstOrdSol", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"S", ",", 
            RowBox[{"-", 
             FractionBox["1", "2"]}]}], "]"}], "-", 
          RowBox[{"D2wFirstOrdBc", "[", 
           RowBox[{"S", ",", 
            RowBox[{"-", 
             FractionBox["1", "2"]}]}], "]"}]}], "]"}], "==", "0"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.925385317337888*^9, 3.925385337200522*^9}, {
   3.925385441713522*^9, 3.9253854525581493`*^9}, 3.925389565260398*^9, {
   3.925389697723474*^9, 3.925389697942078*^9}, {3.925389753421257*^9, 
   3.925389854844829*^9}, 3.9253900725890627`*^9, {3.925390415083407*^9, 
   3.925390568052597*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"f77b63b2-3463-4878-b708-78bab1db221f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c1Exp", ",", " ", "c2Exp"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"SolveValues", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"rawwFirstOrdSol", "[", 
             RowBox[{"S", ",", "T"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"T", ",", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", 
              RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"T", " ", 
             RowBox[{"rawwFirstOrdSol", "[", 
              RowBox[{"S", ",", "T"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"T", ",", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", 
              RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], "==", "0"}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         TemplateBox[{"1"},
          "C"], ",", " ", 
         TemplateBox[{"2"},
          "C"]}], "}"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"wFirstOrdSol", "[", 
    RowBox[{"S_", ",", "T_"}], "]"}], "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"rawwFirstOrdSol", "[", 
      RowBox[{"S", ",", "T"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{"1"},
         "C"], "->", " ", "c1Exp"}], ",", 
       RowBox[{
        TemplateBox[{"2"},
         "C"], " ", "->", " ", "c2Exp"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.925385317337888*^9, 3.925385337200522*^9}, {
   3.925385441713522*^9, 3.9253854525581493`*^9}, 3.925389565260398*^9, {
   3.925389697723474*^9, 3.925389697942078*^9}, {3.925389753421257*^9, 
   3.925389854844829*^9}, 3.9253900725890627`*^9, {3.925390415083407*^9, 
   3.925390453118313*^9}, {3.925390577533525*^9, 3.9253906198062067`*^9}, {
   3.925390960027822*^9, 3.925390988226384*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"f4453347-14bf-410a-9a7b-de519cceb747"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "check", " ", "whether", " ", "solution", " ", "for", " ", "wFirstOrd", 
     " ", "satifies", " ", "the", " ", "fourth"}], "-", 
    RowBox[{"order", " ", "differential", " ", "equation"}]}], " ", "*)"}], 
  "\n", 
  RowBox[{"If", "[", 
   RowBox[{"doSanityCheck", ",", "\[IndentingNewLine]", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", "T"}], "!=", "r"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "T"}], "+", "r"}], "!=", "0"}]}], "}"}], ",", 
      RowBox[{"CheckSanity", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"wFirstOrd", "[", 
                 RowBox[{"S", ",", "T"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"T", ",", "4"}], "}"}]}], "]"}], "-", 
              RowBox[{"D4wFirstOrd", "[", 
               RowBox[{"S", ",", "T"}], "]"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"wFirstOrd", "->", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"wFirstOrdSol", "[", 
                 RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], "}"}]}], 
           ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{"\[CurlyEpsilon]p", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CurlyEpsilon]pfnExp", "[", "#", "]"}], "&"}], 
             ")"}]}], "}"}]}], "]"}], "==", "0"}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.925385317337888*^9, 3.925385337200522*^9}, {
   3.925385441713522*^9, 3.9253854525581493`*^9}, 3.925389565260398*^9, {
   3.925389697723474*^9, 3.925389697942078*^9}, {3.925389753421257*^9, 
   3.925389854844829*^9}, 3.9253900725890627`*^9, {3.925390415083407*^9, 
   3.925390453118313*^9}, {3.925390577533525*^9, 3.9253906198062067`*^9}, 
   3.925390655423773*^9, {3.925390707153068*^9, 3.9253907166226807`*^9}, 
   3.9253909346527653`*^9, 
   3.9269933020691643`*^9},ExpressionUUID->"e12ac56d-78d9-4168-8fd0-\
1dea5793aee2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "sanity", " ", "checks", " ", "for", " ", "wFirstOrd", " ", "solution"}], 
   " ", "*)"}], "\n", 
  RowBox[{"If", "[", 
   RowBox[{"doSanityCheck", ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"check", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Integral]", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]], 
         RowBox[{"1", "/", "2"}]], " ", 
        RowBox[{
         RowBox[{"wFirstOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], " ", "dT"}]}]}], " ", "=", " ", 
      RowBox[{"0", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"wFirstOrdSol", "[", 
           RowBox[{"S", ",", "T"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], "]"}], "==", "0"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"check", " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[Integral]", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]], 
          RowBox[{"1", "/", "2"}]], " ", 
         RowBox[{"T", " ", 
          RowBox[{"wFirstOrd", "[", 
           RowBox[{"S", ",", "T"}], "]"}], " ", "dT"}]}]}], " ", "=", " ", 
       RowBox[{"0", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"T", " ", 
           RowBox[{"wFirstOrdSol", "[", 
            RowBox[{"S", ",", "T"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], "]"}], "==", "0"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"satisfies", " ", "boundary", " ", 
       RowBox[{"conditions", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"wFirstOrdSol", "[", 
              RowBox[{"S", ",", "T"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", "2"}], "}"}]}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"T", "->", " ", 
             RowBox[{"1", "/", "2"}]}], "}"}]}], ")"}], "-", " ", 
         RowBox[{"D2wFirstOrdBc", "[", 
          RowBox[{"S", ",", 
           RowBox[{"1", "/", "2"}]}], "]"}]}], "]"}], "==", "0"}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"wFirstOrdSol", "[", 
              RowBox[{"S", ",", "T"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", "2"}], "}"}]}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"T", "->", " ", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], ")"}], "-", " ", 
         RowBox[{"D2wFirstOrdBc", "[", 
          RowBox[{"S", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "]"}]}], "]"}], "==", "0"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"wFirstOrdSol", "[", 
              RowBox[{"S", ",", "T"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", "3"}], "}"}]}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"T", "->", " ", 
             RowBox[{"1", "/", "2"}]}], "}"}]}], ")"}], "-", " ", 
         RowBox[{"D3wFirstOrdBc", "[", 
          RowBox[{"S", ",", 
           RowBox[{"1", "/", "2"}]}], "]"}]}], "]"}], "==", "0"}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"CheckSanity", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"wFirstOrdSol", "[", 
              RowBox[{"S", ",", "T"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", "3"}], "}"}]}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"T", "->", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], ")"}], "-", " ", 
         RowBox[{"D3wFirstOrdBc", "[", 
          RowBox[{"S", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "]"}]}], "]"}], "==", "0"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.925385317337888*^9, 3.925385337200522*^9}, {
   3.925385441713522*^9, 3.9253854525581493`*^9}, 3.925389565260398*^9, {
   3.925389697723474*^9, 3.925389697942078*^9}, {3.925389753421257*^9, 
   3.925389854844829*^9}, 3.9253900725890627`*^9, {3.925390415083407*^9, 
   3.925390453118313*^9}, {3.925390577533525*^9, 3.9253906198062067`*^9}, 
   3.925390655423773*^9, {3.925390707153068*^9, 3.9253907166226807`*^9}, 
   3.9253909346527653`*^9, {3.9269933020761538`*^9, 
   3.926993302078208*^9}},ExpressionUUID->"1190d1b5-f9dd-4cd7-9b13-\
42130a4e6f01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"calculate", " ", "vFirstOrd"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rawvFirstOrd", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", " ", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"vFirstOrdDT", "/.", 
        RowBox[{"{", 
         RowBox[{"wFirstOrd", "->", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"wFirstOrdSol", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"T", ",", "0", ",", "T"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cvFirstOrdExp", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"rawvFirstOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], " ", "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"vFirstOrdSol", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", " ", 
     RowBox[{"Collect", "[", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rawvFirstOrd", "[", 
          RowBox[{"S", ",", "T"}], "]"}], "+", "cvFirstOrdExp"}], ")"}], ",", 
       
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Tau]", "'"}], "[", "S", "]"}], ",", "T"}], "}"}], ",", 
       "Simplify"}], "]"}]}], ";"}], "\n", 
   RowBox[{"If", "[", 
    RowBox[{"doSanityCheck", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckSanity", "[", 
       RowBox[{
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", " ", "T"}], "!=", "r"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"2", " ", "T"}], "+", "r"}], "!=", "0"}], ",", 
            RowBox[{"T", "!=", "0"}]}], "}"}], ",", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"vFirstOrdSol", "[", 
                 RowBox[{"S", ",", "T"}], "]"}], ",", "T"}], "]"}], "-", 
              "vFirstOrdDT"}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"wFirstOrd", "->", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"wFirstOrdSol", "[", 
                 RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ")"}]}], "}"}]}], 
           "]"}]}], "]"}], "==", "0"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CheckSanity", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"vFirstOrdSol", "[", 
            RowBox[{"S", ",", "T"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"T", ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], "]"}], "==", "0"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.925385317337888*^9, 3.925385337200522*^9}, {
   3.925385441713522*^9, 3.9253854525581493`*^9}, 3.925389565260398*^9, {
   3.925389697723474*^9, 3.925389697942078*^9}, {3.925389753421257*^9, 
   3.925389854844829*^9}, 3.9253900725890627`*^9, {3.925390415083407*^9, 
   3.925390453118313*^9}, {3.925390577533525*^9, 3.9253906198062067`*^9}, {
   3.925390655423773*^9, 3.925390682464201*^9}, 3.925390746979648*^9, 
   3.926993302083933*^9},ExpressionUUID->"7d2715af-90f3-4169-9b1f-\
28f57a043b5d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimal cross-sectional displacements we will use", "Section",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
  3.924942670975276*^9, 3.924942678081658*^9}, {3.924942743699375*^9, 
  3.9249427465121803`*^9}, {3.925030923148438*^9, 3.92503092857327*^9}, {
  3.9253907894404*^9, 
  3.925390794745822*^9}},ExpressionUUID->"b59728ed-eb1b-45c6-940b-\
49c6c9e8a2ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "check", " ", "consistencies", " ", "with", " ", "the", " ", "expressions",
     " ", "given", " ", "in", " ", "the", " ", "paper"}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"uPaper", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "6"]}], " ", 
      SuperscriptBox["T", "3"], " ", "\[Nu]", " ", 
      SuperscriptBox[
       RowBox[{"\[Tau]", "[", "S", "]"}], "2"]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"vPaper", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", " ", 
     RowBox[{
      FractionBox["1", "12"], 
      RowBox[{"\[Tau]", "[", "S", "]"}], 
      RowBox[{
       RowBox[{"\[Tau]", "'"}], "[", "S", "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["T", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Nu]"}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["T", "4"], 
         RowBox[{"(", 
          RowBox[{"3", "-", "\[Nu]"}], ")"}]}], "+", 
        RowBox[{
         FractionBox["8", "5"], 
         SuperscriptBox["T", "6"], 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Nu]"}], ")"}]}], "-", 
        FractionBox[
         RowBox[{"83", "+", 
          RowBox[{"155", " ", "\[Nu]"}]}], "1680"], "+", 
        "\[IndentingNewLine]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"\[Tau]", "[", "S", "]"}], "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["1", "1920"], 
            SuperscriptBox["T", "4"]}], "-", 
           RowBox[{
            FractionBox["1", "600"], 
            SuperscriptBox["T", "6"]}], "+", 
           RowBox[{
            FractionBox["1", "560"], 
            SuperscriptBox["T", "8"]}], "-", 
           FractionBox["23", "6451200"]}], ")"}]}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["1", "15"], "p", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["r", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["3", "16"], 
               SuperscriptBox["r", "2"], "T"}], "-", 
              RowBox[{
               FractionBox["5", "4"], 
               SuperscriptBox["T", "3"]}], "-", 
              RowBox[{
               FractionBox["15", "8"], 
               SuperscriptBox["T", "4"]}], "+", 
              SuperscriptBox["T", "6"], "+", 
              RowBox[{
               FractionBox["1", "896"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"9", 
                  SuperscriptBox["r", "4"]}], "+", 
                 RowBox[{"42", " ", 
                  SuperscriptBox["r", "2"]}], "-", "16"}], ")"}]}]}], ")"}]}],
            "+", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"T", "-", 
                FractionBox["r", "2"]}], ")"}], "4"], 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["T", "2"], "+", 
               RowBox[{"2", " ", "r", " ", "T"}], "+", 
               RowBox[{
                FractionBox["5", "8"], 
                SuperscriptBox["r", "2"]}]}], ")"}], 
             RowBox[{"UnitStep", "[", 
              RowBox[{"T", "-", 
               FractionBox["r", "2"]}], "]"}]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"T", "+", 
                FractionBox["r", "2"]}], ")"}], "4"], 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["T", "2"], "-", 
               RowBox[{"2", " ", "r", " ", "T"}], "+", 
               RowBox[{
                FractionBox["5", "8"], 
                SuperscriptBox["r", "2"]}]}], ")"}], 
             RowBox[{"UnitStep", "[", 
              RowBox[{"T", "+", 
               FractionBox["r", "2"]}], "]"}]}], ")"}]}], ")"}]}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"wPaper", "[", 
      RowBox[{"S_", ",", "T_"}], "]"}], "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Tau]", "'"}], "[", "S", "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "560"], 
         RowBox[{"(", 
          RowBox[{"11", "-", 
           RowBox[{"25", "\[Nu]"}]}], ")"}], "T"}], " ", "-", " ", 
        RowBox[{
         FractionBox["1", "6"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "\[Nu]"}]}], ")"}], 
         SuperscriptBox["T", "3"]}], "+", 
        RowBox[{
         FractionBox["1", "5"], 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Nu]"}], ")"}], 
         SuperscriptBox["T", "5"]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"\[Tau]", "[", "S", "]"}], "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["41", "4838400"]}], "T"}], "+", 
           RowBox[{
            FractionBox["1", "11520"], 
            SuperscriptBox["T", "3"]}], " ", "-", " ", 
           RowBox[{
            FractionBox["1", "4800"], 
            SuperscriptBox["T", "5"]}], "+", 
           RowBox[{
            FractionBox["1", "5040"], 
            SuperscriptBox["T", "7"]}]}], ")"}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["p", "120"], 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{
            SuperscriptBox["r", "3"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["3", "112"], "T", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["r", "4"], "-", 
                 RowBox[{"14", " ", 
                  SuperscriptBox["r", "2"]}], "-", "22"}], ")"}]}], "-", 
              RowBox[{
               FractionBox["5", "2"], 
               SuperscriptBox["T", "2"]}], "-", 
              RowBox[{
               FractionBox["5", "2"], 
               SuperscriptBox["T", "3"]}], "+", 
              SuperscriptBox["T", "5"], "-", 
              FractionBox[
               SuperscriptBox["r", "2"], "8"]}], ")"}]}], "+", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"T", "-", 
                FractionBox["r", "2"]}], ")"}], "4"], 
             RowBox[{"(", 
              RowBox[{"T", "+", 
               RowBox[{"2", " ", "r"}]}], ")"}], 
             RowBox[{"UnitStep", "[", 
              RowBox[{"T", "-", 
               FractionBox["r", "2"]}], "]"}]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"T", "+", 
                FractionBox["r", "2"]}], ")"}], "4"], 
             RowBox[{"(", 
              RowBox[{"T", "-", 
               RowBox[{"2", " ", "r"}]}], ")"}], 
             RowBox[{"UnitStep", "[", 
              RowBox[{"T", "+", 
               FractionBox["r", "2"]}], "]"}]}], ")"}]}], ")"}]}]}], 
       ")"}]}]}], ";"}], "\n", 
   RowBox[{"CheckSanity", "[", 
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "T"}], "!=", "r"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"2", " ", "T"}], "+", "r"}], "!=", "0"}]}], "}"}], ",", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vPaper", "[", 
           RowBox[{"S", ",", "T"}], "]"}], "-", 
          RowBox[{"vFirstOrdSol", "[", 
           RowBox[{"S", ",", "T"}], "]"}]}], ")"}], "]"}]}], "]"}], "==", 
     "0"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"CheckSanity", "[", 
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "T"}], "!=", "r"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"2", " ", "T"}], "+", "r"}], "!=", "0"}]}], "}"}], ",", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wPaper", "[", 
           RowBox[{"S", ",", "T"}], "]"}], "-", 
          RowBox[{"wFirstOrdSol", "[", 
           RowBox[{"S", ",", "T"}], "]"}]}], ")"}], "]"}]}], "]"}], "==", 
     "0"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"CheckSanity", "[", 
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "T"}], "!=", "r"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"2", " ", "T"}], "+", "r"}], "!=", "0"}]}], "}"}], ",", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"uPaper", "[", 
           RowBox[{"S", ",", "T"}], "]"}], "-", 
          RowBox[{"uLeadOrdSol", "[", 
           RowBox[{"S", ",", "T"}], "]"}]}], ")"}], "]"}]}], "]"}], "==", 
     "0"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942670975276*^9, 3.924942678081658*^9}, {3.924942743699375*^9, 
   3.9249427465121803`*^9}, {3.925030923148438*^9, 3.92503092857327*^9}, {
   3.9253907894404*^9, 3.9253907971848497`*^9}, 3.925391129768268*^9, {
   3.925391234926218*^9, 3.925391371468679*^9}, {3.926993302085762*^9, 
   3.926993302088698*^9}},ExpressionUUID->"5f1eaf0a-5852-49cf-b0f2-\
9c819cf97e85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "At", " ", "Leading", " ", "order", " ", "v", " ", "and", " ", "w", " ", 
    "vanish", " ", "and", " ", "at", " ", "first", " ", "order", " ", "u", 
    " ", 
    RowBox[{"vanishes", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CheckSanity", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vLeadOrdSol", "[", 
       RowBox[{"S", ",", "T"}], "]"}], ",", " ", 
      RowBox[{"wLeadOrdSol", "[", 
       RowBox[{"S", ",", "T"}], "]"}], ",", 
      RowBox[{"uFirstOrdSol", "[", 
       RowBox[{"S", ",", "T"}], "]"}]}], "}"}], "==", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8775829902575693`*^9, 3.877582995605624*^9}, {
   3.924942670975276*^9, 3.924942678081658*^9}, {3.924942743699375*^9, 
   3.9249427465121803`*^9}, {3.925030923148438*^9, 3.92503092857327*^9}, {
   3.9253907894404*^9, 3.9253907971848497`*^9}, {3.925391129768268*^9, 
   3.925391145273055*^9}, {3.9253911854809227`*^9, 3.925391198358775*^9}, 
   3.92699330208986*^9},ExpressionUUID->"919c0660-b2ed-46c8-8a17-\
74ccac84cd62"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1399.5, 762.},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1929855a-eac3-4a8f-9587-eefe70d72949"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 205, 4, 60, "Title",ExpressionUUID->"d4973709-2b46-4085-a0fb-67d4520ec0a7"],
Cell[788, 28, 156, 3, 98, "Title",ExpressionUUID->"582dd357-c636-4605-a0ae-d464e7383ffd"],
Cell[947, 33, 814, 12, 73, "Author",ExpressionUUID->"aaace130-c4b3-4301-8bd2-c70bddfcfca9"],
Cell[1764, 47, 2366, 52, 200, "Abstract",ExpressionUUID->"8b8fbf1b-1de5-4340-b49d-ac71a170fe5c"],
Cell[CellGroupData[{
Cell[4155, 103, 237, 4, 68, "Section",ExpressionUUID->"369e299b-bd1a-4a01-b367-41bfe42a7e9e"],
Cell[4395, 109, 4113, 103, 416, "Input",ExpressionUUID->"942f32d7-1abf-489c-bb6e-54d9d4a48f29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8545, 217, 295, 5, 68, "Section",ExpressionUUID->"d25e40ce-ace5-4156-a106-7401037ed908"],
Cell[CellGroupData[{
Cell[8865, 226, 229, 4, 54, "Subsection",ExpressionUUID->"8824d6ec-741f-47ac-9f17-6edf6a59a03c"],
Cell[9097, 232, 5631, 177, 225, "Input",ExpressionUUID->"16c1906a-9ae7-4c14-b604-7222a7e1ed13"],
Cell[14731, 411, 1255, 32, 158, "Input",ExpressionUUID->"eccdd160-59e7-4b85-b2f1-0e1ed716586d"],
Cell[15989, 445, 3587, 105, 130, "Input",ExpressionUUID->"2fdd5fa9-7810-46cf-9af7-908b087f5426"]
}, Closed]],
Cell[CellGroupData[{
Cell[19613, 555, 342, 5, 38, "Subsection",ExpressionUUID->"b5cbf3e5-be06-44e1-8133-6217bc086cc3"],
Cell[19958, 562, 3731, 100, 329, "Input",ExpressionUUID->"7cbf8b3d-c300-4707-b707-e21a1aafa017"],
Cell[23692, 664, 1781, 37, 71, "Input",ExpressionUUID->"a82dc203-2b0c-4e4a-9209-e8ba58463c49"],
Cell[25476, 703, 7373, 225, 246, "Input",ExpressionUUID->"ba0e2a33-0df6-4054-adc6-4dc6d4e698cc"],
Cell[32852, 930, 3335, 80, 121, "Input",ExpressionUUID->"8ee74b46-eb91-4a67-b305-409bc4e777a0"],
Cell[36190, 1012, 4754, 112, 299, "Input",ExpressionUUID->"2e852bbe-3c8f-4f6e-8a10-d151e0373afc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40993, 1130, 241, 5, 68, "Section",ExpressionUUID->"2dcd8f12-cd46-4cfa-ab10-6683e0485d67"],
Cell[41237, 1137, 2117, 56, 41, "Text",ExpressionUUID->"268210e7-e673-47b8-b2ab-da664a0e4187"],
Cell[43357, 1195, 2796, 72, 99, "Input",ExpressionUUID->"ef585acd-6946-4c5f-bbaa-b309b222f63f"],
Cell[46156, 1269, 998, 21, 51, "Input",ExpressionUUID->"58d47743-d464-4ca8-a484-6055d7954106"],
Cell[47157, 1292, 3890, 89, 176, "Text",ExpressionUUID->"3936feb0-8c65-497e-bdc0-7c0a14127dcf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51084, 1386, 333, 5, 68, "Section",ExpressionUUID->"1b38ee61-3587-47ee-8c7f-c033e805e38f"],
Cell[51420, 1393, 1309, 31, 51, "Input",ExpressionUUID->"45db21c7-417b-475b-a28a-7f7e866c49ad"],
Cell[52732, 1426, 1823, 47, 71, "Input",ExpressionUUID->"e60a032a-d5eb-4f48-8cab-7f4a2df30a24"],
Cell[54558, 1475, 878, 18, 51, "Input",ExpressionUUID->"6a3d3a98-eca6-4a7f-9ad7-5b916eed1ea5"],
Cell[CellGroupData[{
Cell[55461, 1497, 1380, 19, 54, "Subsection",ExpressionUUID->"66a82287-17a1-4d75-8785-0a55b8abf728"],
Cell[56844, 1518, 1441, 22, 35, "Text",ExpressionUUID->"7913e807-529d-446e-bd5e-8215ba6f3b53"],
Cell[58288, 1542, 2233, 43, 29, "Input",ExpressionUUID->"074c716e-ddbb-4a79-885c-0ac2e1784cc5"],
Cell[60524, 1587, 1314, 38, 51, "Input",ExpressionUUID->"93586db6-c10a-4b34-a540-5feef7ac3e4f"],
Cell[61841, 1627, 815, 22, 29, "Input",ExpressionUUID->"b515cdf1-6118-4c59-bf26-2667864a41c9"],
Cell[62659, 1651, 854, 21, 51, "Input",ExpressionUUID->"60c34452-699f-4acc-b23d-476168044ba2"],
Cell[63516, 1674, 8610, 235, 580, "Text",ExpressionUUID->"bde4b3a2-2703-442c-ab60-4f77d2ccb887"],
Cell[72129, 1911, 1811, 27, 29, "Input",ExpressionUUID->"2ecd4962-a92f-4949-9e0d-0136754eea21"],
Cell[73943, 1940, 4073, 96, 120, "Input",ExpressionUUID->"ebf42137-44ac-453c-a557-270497ea07d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78053, 2041, 1249, 18, 54, "Subsection",ExpressionUUID->"22f7d6cb-8266-4397-adc4-f262dd2ffc6d"],
Cell[79305, 2061, 1290, 21, 35, "Text",ExpressionUUID->"90243e6b-bdd5-41fa-95b7-4e510250fbd9"],
Cell[80598, 2084, 1996, 40, 29, "Input",ExpressionUUID->"973432d9-8839-48ae-8d13-7ac9b451e315"],
Cell[82597, 2126, 2211, 51, 55, "Input",ExpressionUUID->"8f2876bc-c069-436a-9d33-479b0d5cfa29"],
Cell[84811, 2179, 1429, 39, 71, "Input",ExpressionUUID->"6ed79163-584c-4dc8-897d-0ec60288006e"],
Cell[CellGroupData[{
Cell[86265, 2222, 395, 6, 45, "Subsubsection",ExpressionUUID->"971ff771-382c-4507-b3ab-f10b9baef11e"],
Cell[86663, 2230, 7620, 263, 613, "Text",ExpressionUUID->"2bbf5994-0ea7-4c4a-aa8d-7be13187f410"],
Cell[94286, 2495, 501, 13, 35, "Text",ExpressionUUID->"6dd6b2e4-e9a9-44af-9a25-21c43e35e803"],
Cell[94790, 2510, 1856, 54, 91, "Input",ExpressionUUID->"3e4d888a-8982-42c0-9224-6f41a44ee906"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96683, 2569, 475, 7, 45, "Subsubsection",ExpressionUUID->"5426e3f4-b444-402c-b421-3aba719a8491"],
Cell[97161, 2578, 2945, 73, 96, "Input",ExpressionUUID->"93b93a42-310d-4449-ac67-e3ea46a5df87"],
Cell[100109, 2653, 1965, 45, 54, "Input",ExpressionUUID->"cd7572d5-4705-4afa-983d-38cd7e77fa47"],
Cell[102077, 2700, 9700, 306, 601, "Text",ExpressionUUID->"dde6dae3-198a-4e39-861f-6ebff4c666b2"],
Cell[111780, 3008, 782, 15, 51, "Input",ExpressionUUID->"3ea61ab0-500d-4f58-91d0-e5c9dd6f9387"],
Cell[112565, 3025, 375, 7, 29, "Input",ExpressionUUID->"619a8baa-ef3b-4846-a3b4-bf4c7c15ea8f"],
Cell[112943, 3034, 2604, 70, 92, "Input",ExpressionUUID->"023bbe84-81a6-4d48-990d-80d0d6ea3c70"],
Cell[115550, 3106, 2441, 66, 71, "Input",ExpressionUUID->"eddf2c3b-e194-4536-8d9c-0ea2af777f41"],
Cell[117994, 3174, 2291, 60, 92, "Input",ExpressionUUID->"fde2bd83-fe79-42a5-9129-bf47c5705e40"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120322, 3239, 232, 4, 45, "Subsubsection",ExpressionUUID->"2917c371-45df-4e12-b2a4-502ac99290a4"],
Cell[120557, 3245, 1972, 49, 92, "Input",ExpressionUUID->"23d2c3ae-a7cb-4f7c-9534-096080c852af"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[122590, 3301, 403, 6, 68, "Section",ExpressionUUID->"41ce01d1-9562-4172-a16c-e01505d3b931"],
Cell[122996, 3309, 1193, 29, 29, "Input",ExpressionUUID->"8feca4e0-499b-4c3a-9303-12242b8fc9c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124226, 3343, 499, 9, 68, "Section",ExpressionUUID->"e9cb865d-3067-4582-904e-15851ef7508d"],
Cell[CellGroupData[{
Cell[124750, 3356, 716, 10, 45, "Subsubsection",ExpressionUUID->"d42e8308-dcf3-4aa0-a41d-474c3c846158"],
Cell[125469, 3368, 1522, 33, 51, "Input",ExpressionUUID->"0a40c4b3-eb51-47ba-8a5c-5cf8142896e1"],
Cell[126994, 3403, 6464, 174, 207, "Input",ExpressionUUID->"bfbaf095-fe50-433a-af00-5aeba2ee755d"]
}, Closed]],
Cell[CellGroupData[{
Cell[133495, 3582, 171, 3, 37, "Subsubsection",ExpressionUUID->"0ac350b1-bd56-4188-93db-17402260308d"],
Cell[133669, 3587, 2097, 41, 71, "Input",ExpressionUUID->"45dbadd9-afd7-4a26-8bb3-d9815dab8332"],
Cell[135769, 3630, 2306, 52, 71, "Input",ExpressionUUID->"0b1bee6e-60f6-4d0c-8fbf-1d7c50c0c129"],
Cell[138078, 3684, 1389, 26, 51, "Input",ExpressionUUID->"6a2ae325-f283-483c-82d6-fdd873aa7fba"]
}, Closed]],
Cell[CellGroupData[{
Cell[139504, 3715, 1070, 15, 37, "Subsubsection",ExpressionUUID->"1701db54-8be1-4d4d-9441-b1007f88a819"],
Cell[140577, 3732, 2059, 43, 51, "Input",ExpressionUUID->"98c19318-4bf1-4e87-a82f-e4cf9b112508"],
Cell[142639, 3777, 1206, 20, 40, "Text",ExpressionUUID->"4e313347-6ee5-45c7-bf14-775fcb0e0562"],
Cell[143848, 3799, 6008, 178, 532, "Text",ExpressionUUID->"fdb3029d-0dee-48b9-bb25-f2a1f175144d"],
Cell[149859, 3979, 2303, 45, 72, "Input",ExpressionUUID->"db8326c6-5ee9-4554-925f-f1d5f0d86e36"],
Cell[152165, 4026, 2650, 52, 51, "Input",ExpressionUUID->"269eac7b-f8da-43f6-8696-3f8d3a9f2315"],
Cell[154818, 4080, 2539, 46, 53, "Input",ExpressionUUID->"2b24059c-5db1-432b-a4c2-50686931c981"],
Cell[157360, 4128, 3531, 79, 71, "Input",ExpressionUUID->"14a69d48-9cfa-4361-9e85-54580e638bbf"],
Cell[160894, 4209, 3065, 64, 94, "Input",ExpressionUUID->"00dcafe8-7265-49e3-96d0-06a90fb3910a"],
Cell[163962, 4275, 3975, 96, 135, "Input",ExpressionUUID->"a009dc3b-15ab-409e-a625-257506fe8f82"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167974, 4376, 1072, 15, 45, "Subsubsection",ExpressionUUID->"8cbf8bbb-7055-40a0-bce0-053760a0b054"],
Cell[169049, 4393, 6789, 202, 591, "Text",ExpressionUUID->"d10d4764-57c9-45ad-bdff-9eb120d6e8da"],
Cell[175841, 4597, 2896, 66, 87, "Input",ExpressionUUID->"23e3a5c8-66c7-4bd0-9c3b-3d3a74d8637d"],
Cell[178740, 4665, 1668, 28, 71, "Input",ExpressionUUID->"eaf070fa-2a73-4335-9e35-8acf39f18659"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180445, 4698, 1480, 20, 54, "Subsection",ExpressionUUID->"8915af98-6caf-4162-982c-0f5bea90dcb0"],
Cell[181928, 4720, 3278, 63, 92, "Input",ExpressionUUID->"c8955a8a-c9ac-4adc-a6e9-9de99bf086ea"],
Cell[185209, 4785, 2658, 47, 51, "Input",ExpressionUUID->"b4c4b5ed-273f-47fa-ae9e-f7180c9edb23"],
Cell[187870, 4834, 3119, 62, 71, "Input",ExpressionUUID->"b8c3c632-c2cb-4e7f-8efc-298094c1b0ea"],
Cell[CellGroupData[{
Cell[191014, 4900, 1669, 23, 45, "Subsubsection",ExpressionUUID->"3ee22ce2-7343-4208-99c4-ebdb719cd82a"],
Cell[192686, 4925, 14538, 409, 857, "Text",ExpressionUUID->"e3043436-695c-4995-b16d-b6265b976d2b"],
Cell[207227, 5336, 2756, 48, 51, "Text",ExpressionUUID->"1df25e66-90e8-4817-b616-7203d2951504"],
Cell[209986, 5386, 4197, 94, 217, "Input",ExpressionUUID->"41add999-f54f-4a28-b2ee-e123f705ddb0"],
Cell[214186, 5482, 2355, 58, 71, "Input",ExpressionUUID->"4b9a4641-02fd-47de-96af-0b16a49a2b18"],
Cell[216544, 5542, 2004, 45, 51, "Input",ExpressionUUID->"6fbe3bf5-092c-45ec-b58d-4dec629e0185"],
Cell[218551, 5589, 2294, 52, 51, "Input",ExpressionUUID->"6d0b9b47-f219-4d08-a0d0-d6790a9f8d5a"],
Cell[220848, 5643, 1691, 34, 72, "Input",ExpressionUUID->"21a39eb6-8dba-43da-a4fa-baff0e6ac53e"],
Cell[222542, 5679, 1820, 37, 29, "Input",ExpressionUUID->"4f5be1fe-c7c9-4764-8e82-d442d4d9776f"],
Cell[224365, 5718, 1357, 35, 44, "Input",ExpressionUUID->"0ccbce09-d9f3-4d28-a0f1-839d7c5cd8ec"],
Cell[225725, 5755, 1870, 48, 140, "Input",ExpressionUUID->"a49f11a8-f65e-41ee-af5e-f202a2dd27ee"],
Cell[227598, 5805, 2093, 47, 72, "Input",ExpressionUUID->"f5953fb0-7fca-4cfa-b983-174e468b9b36"],
Cell[229694, 5854, 1179, 29, 71, "Input",ExpressionUUID->"40a9cf78-a89c-40e4-a06b-8e59208b8f24"],
Cell[230876, 5885, 4467, 133, 218, "Input",ExpressionUUID->"71d0419f-b599-4b7e-adc8-d2dbba47cf49"],
Cell[235346, 6020, 3484, 99, 249, "Input",ExpressionUUID->"f77b63b2-3463-4878-b708-78bab1db221f"],
Cell[238833, 6121, 2237, 64, 51, "Input",ExpressionUUID->"f4453347-14bf-410a-9a7b-de519cceb747"],
Cell[241073, 6187, 2282, 58, 92, "Input",ExpressionUUID->"e12ac56d-78d9-4168-8fd0-1dea5793aee2"],
Cell[243358, 6247, 5718, 153, 267, "Input",ExpressionUUID->"1190d1b5-f9dd-4cd7-9b13-42130a4e6f01"],
Cell[249079, 6402, 3759, 102, 174, "Input",ExpressionUUID->"7d2715af-90f3-4169-9b1f-28f57a043b5d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[252899, 6511, 388, 6, 68, "Section",ExpressionUUID->"b59728ed-eb1b-45c6-940b-49c6c9e8a2ec"],
Cell[253290, 6519, 9655, 277, 451, "Input",ExpressionUUID->"5f1eaf0a-5852-49cf-b0f2-9c819cf97e85"],
Cell[262948, 6798, 1152, 26, 51, "Input",ExpressionUUID->"919c0660-b2ed-46c8-8a17-74ccac84cd62"]
}, Open  ]]
}, Open  ]]
}
]
*)

